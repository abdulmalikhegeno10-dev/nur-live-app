<!DOCTYPE html><html lang=en><style>.zt09cW_skipIcon{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='94.7' height='94.9'%3E%3Cg fill='%23FFF' stroke='%23000' stroke-width='3.417' stroke-miterlimit='10'%3E%3Cpath d='m37 75.5 22.4-22.4H1.9V41.7h57.5L37 19.3l8.1-8.1 36.2 36.2-36.2 36.2z'/%3E%3Cpath d='M92.733 11.138v72.4h-11.5v-72.4z'/%3E%3C/g%3E%3C/svg%3E");background-position:50%;background-repeat:no-repeat;background-size:100%;width:18px;height:18px;display:inline-block}.zt09cW_closeIcon{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='525.4px' height='525.5px'%3E%3Cpolygon fill='%23ffffff' stroke='%23000000' stroke-width='26' stroke-miterlimit='10' points='452.6,8.9 262.9,198.6 73.1,8.9 9,73 198.8,262.7 9,452 73.1,516.1 262.9,326.8 452.6,516.1 516.7,452 326.9,262.7 516.7,73'%3E%3C/polygon%3E%3C/svg%3E");background-position:50%;background-repeat:no-repeat;background-size:100%;width:18px;height:18px;display:inline-block}.zt09cW_skipIconWithoutBorder{background-color:#fff;width:18px;height:18px;display:inline-block;-webkit-mask-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='94.7' height='94.9'%3E%3Cg fill='%23FFF' stroke-miterlimit='10'%3E%3Cpath d='m37 75.5 22.4-22.4H1.9V41.7h57.5L37 19.3l8.1-8.1 36.2 36.2-36.2 36.2z'/%3E%3Cpath d='M92.733 11.138v72.4h-11.5v-72.4z'/%3E%3C/g%3E%3C/svg%3E");mask-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='94.7' height='94.9'%3E%3Cg fill='%23FFF' stroke-miterlimit='10'%3E%3Cpath d='m37 75.5 22.4-22.4H1.9V41.7h57.5L37 19.3l8.1-8.1 36.2 36.2-36.2 36.2z'/%3E%3Cpath d='M92.733 11.138v72.4h-11.5v-72.4z'/%3E%3C/g%3E%3C/svg%3E");-webkit-mask-position:50%;mask-position:50%;-webkit-mask-size:contain;mask-size:contain;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat}.wnLcbW_fallback{text-align:right;background:rgba(0,0,0,.8);width:100vw;height:100vh;padding:20px;position:absolute;top:0;left:0}.C4yOdG_primaryButton,.C4yOdG_gdpr .C4yOdG_buttons button.C4yOdG_primaryButton{color:#fff;background-color:#555fff;padding:0}.C4yOdG_primaryButton button,.C4yOdG_gdpr .C4yOdG_buttons button.C4yOdG_primaryButton button{text-transform:uppercase;color:#fff}@media screen and (orientation:landscape){.C4yOdG_primaryButton,.C4yOdG_gdpr .C4yOdG_buttons button.C4yOdG_primaryButton{flex:1}}.C4yOdG_secondaryButton,.C4yOdG_gdpr .C4yOdG_buttons button.C4yOdG_secondaryButton{color:#555fff;background-color:#fff;padding:0}.C4yOdG_secondaryButton button,.C4yOdG_gdpr .C4yOdG_buttons button.C4yOdG_secondaryButton button{color:#555fff}@media screen and (orientation:landscape){.C4yOdG_secondaryButton,.C4yOdG_gdpr .C4yOdG_buttons button.C4yOdG_secondaryButton{flex:1}}.C4yOdG_gdpr{text-align:center;z-index:2147483647;background-color:#fff;flex-direction:column;justify-content:space-between;width:100%;height:100%;display:flex;position:absolute;top:0;left:0;overflow:hidden}.C4yOdG_gdpr .C4yOdG_icon{color:#fff;background:#007aff url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22100%22%20height%3D%22100%22%3E%3Cpath%20fill%3D%22%23fff%22%20d%3D%22M46.2%201.238v12.1c-17.7%201-31.9%2015.2-32.9%2032.9H1.2v4h12.1c1%2017.7%2015.2%2031.9%2032.9%2032.9v12.1h4v-12.1c17.7-1%2031.9-15.2%2032.9-32.9h12.1v-4h-12c-1-17.7-15.2-31.9-32.9-32.9v-12.1Zm0%2016.1v14.1c-7.8.9-14%207.1-14.9%2014.9h-14c1-15.6%2013.4-28%2028.9-29m4%200c15.5%201%2027.9%2013.4%2028.9%2028.9h-14c-.9-7.8-7.1-14-14.9-14.9Zm-9.3%2023.6c10.8-8.1%2022.8%203.9%2014.7%2014.7-10.8%208.1-22.8-3.9-14.7-14.7m-23.6%209.3h14.1c.9%207.8%207.1%2014%2014.9%2014.9v14.1c-15.6-1-28-13.4-29-29m47.8%200h14.1c-1%2015.5-13.4%2028-28.9%2028.9v-14.1c7.7-.8%2013.9-7%2014.8-14.8%22%2F%3E%3C%2Fsvg%3E) 50%/85% no-repeat;border-radius:50%;width:17vw;max-width:6em;height:17vw;max-height:6em;padding:.5em;display:inline-block}.C4yOdG_gdpr .C4yOdG_content{flex-direction:column;flex:1;justify-content:center;display:flex}.C4yOdG_gdpr .C4yOdG_header{padding:0;line-height:1}.C4yOdG_gdpr .C4yOdG_title{word-wrap:break-word;margin:.5em 12.5%;font-family:Roboto,-apple-system,Segoe UI,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:5.5vw;font-weight:600;line-height:1.5}.C4yOdG_gdpr .C4yOdG_bodyText{text-align:center;word-wrap:break-word;padding:0 12.5%;font-family:Roboto,-apple-system,Segoe UI,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:4.5vw;font-weight:400;line-height:1.5;overflow:hidden}.C4yOdG_gdpr .C4yOdG_buttons{width:100%;height:15vw;font-family:Roboto,-apple-system,Segoe UI,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif;line-height:15vw}.C4yOdG_gdpr .C4yOdG_buttons button{float:right;width:50%;height:100%;display:block}.C4yOdG_gdpr .C4yOdG_buttons button.C4yOdG_primaryButton{font-size:7.5vw}.C4yOdG_gdpr .C4yOdG_buttons button.C4yOdG_secondaryButton{color:#007aff;border-top:1px solid #e8e8e8;font-size:4.5vw}@media screen and (orientation:landscape){.C4yOdG_gdpr{flex-direction:row}.C4yOdG_gdpr .C4yOdG_content{width:75%}.C4yOdG_gdpr .C4yOdG_content .C4yOdG_title{font-size:5vh}.C4yOdG_gdpr .C4yOdG_content .C4yOdG_bodyText{font-size:4vh}.C4yOdG_gdpr .C4yOdG_buttons{flex-direction:column;justify-content:center;width:25%;min-width:116px;height:100%;padding-right:4.5vh;display:flex;right:0}.C4yOdG_gdpr .C4yOdG_buttons button{float:none;width:100%;height:auto;line-height:12vh}.C4yOdG_gdpr .C4yOdG_buttons button.C4yOdG_primaryButton{border-radius:10vh;margin-bottom:2vh;font-size:3.5vh}.C4yOdG_gdpr .C4yOdG_buttons button.C4yOdG_secondaryButton{border-top:none;font-size:2.5vh}}.C4yOdG_hidden{display:none}._0zGmtq_watermark{z-index:200;background-color:#000;width:100vw;min-height:1px;font-size:1px;display:flex;position:absolute}._0zGmtq_watermark ._0zGmtq_leading._0zGmtq_bit{width:4vw}._0zGmtq_watermark ._0zGmtq_bit{flex-grow:0;width:1vw;height:1px}._0zGmtq_watermark ._0zGmtq_zero{height:1px}._0zGmtq_watermark ._0zGmtq_one{background-color:#050505;height:1px}.m2_mMq_privacyButton{cursor:pointer;z-index:2147483497;background:0 0;width:16px;padding:0;line-height:0;position:absolute;bottom:4px;left:4px}@media (min-width:48em){.m2_mMq_privacyButton{bottom:.8rem;left:.8rem}}.m2_mMq_privacyButton svg{width:100%;height:100%}@media only screen and (max-height:300px){.m2_mMq_privacyButton{width:13px;height:13px;left:2px}}@media only screen and (max-height:200px){.m2_mMq_privacyButton{width:12px;height:12px}}._0LRN8a_container{text-align:center;flex-direction:column;justify-content:center;width:100%;height:145px;display:flex;position:relative;overflow:hidden}._0LRN8a_completeContainer{justify-content:center;align-items:center}._0LRN8a_popup{background-color:#fff;flex-direction:column;justify-content:center;height:100%;padding:0;display:flex;position:absolute;bottom:0;left:0;right:0}@media (prefers-color-scheme:dark){._0LRN8a_popup{color:#fff;background:#121212}}._0LRN8a_complete{background-image:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2272%22%20height%3D%2272%22%20fill%3D%22none%22%20viewBox%3D%220%200%2072%2072%22%3E%3Crect%20width%3D%2271%22%20height%3D%2271%22%20x%3D%22.5%22%20y%3D%22.5%22%20fill%3D%22%2300aeff%22%20rx%3D%2235.5%22%2F%3E%3Cpath%20stroke%3D%22%23fff%22%20stroke-linecap%3D%22round%22%20stroke-width%3D%226%22%20d%3D%22M20.743%2036.375%2031.5%2047.132M31.5%2047.132%2053.882%2024.75%22%2F%3E%3C%2Fsvg%3E);background-position:50%;background-repeat:no-repeat;background-size:100%;width:71px;height:71px;margin-top:5px;display:inline-block}@media (max-width:335px){._0LRN8a_complete{width:60px;height:60px;margin-top:3px}}._0LRN8a_title{color:#000;margin-top:15px;margin-bottom:18px;padding:0 30px;font-weight:700}@media (prefers-color-scheme:dark){._0LRN8a_title{color:#fff}}._0LRN8a_title._0LRN8a_question{font-size:17px}@media (max-width:335px){._0LRN8a_title._0LRN8a_question{margin-top:3px;font-size:15px}}._0LRN8a_title._0LRN8a_thanks{font-size:22px}@media (max-width:335px){._0LRN8a_title._0LRN8a_thanks{margin-top:8px;margin-bottom:8px;font-size:18px}}._0LRN8a_options{justify-content:center;gap:15px;max-width:303px;margin-bottom:0;margin-left:auto;margin-right:auto;padding:0 16px;display:flex}@media (max-width:335px){._0LRN8a_options{gap:10px;max-width:245px;padding:0 12px 12px}}._0LRN8a_option{cursor:pointer;background-color:#fff;border:1px solid #e0e0e0;border-radius:10px;flex-direction:column;flex:none;justify-content:center;align-items:center;width:91px;height:88px;padding-top:10px;transition:background-color .2s ease-in-out;display:flex;box-shadow:0 1px 3px rgba(0,0,0,.1)}@media (prefers-color-scheme:dark){._0LRN8a_option{color:#fff;background:#121212}}@media (max-width:335px){._0LRN8a_option{border-radius:10px;width:75px;height:75px}}._0LRN8a_option:hover{background-color:#f8f8f8}._0LRN8a_emoji{margin-bottom:4px;font-size:40px}@media (max-width:335px){._0LRN8a_emoji{margin-bottom:2px;font-size:32px}}._0LRN8a_optionText{color:#000;padding-bottom:5px;font-size:14px;font-weight:500}@media (prefers-color-scheme:dark){._0LRN8a_optionText{color:#fff}}@media (max-width:335px){._0LRN8a_optionText{padding-bottom:3px;font-size:12px}}.rM5gmW_adInfoRow{margin-bottom:3px;line-height:1.4;display:flex}.rM5gmW_adInfoLabel{color:#000;min-width:80px;font-weight:400}@media (prefers-color-scheme:dark){.rM5gmW_adInfoLabel{color:#fff}}@media (max-width:335px){.rM5gmW_adInfoLabel{min-width:70px}}.rM5gmW_adInfoValue{color:#9f9f9f;letter-spacing:0;text-align:left;white-space:nowrap;text-overflow:ellipsis;flex:auto;overflow:hidden}@media (prefers-color-scheme:dark){.rM5gmW_adInfoValue{color:silver}}@media (max-width:335px){.rM5gmW_adInfoValue{font-size:10px}}.rM5gmW_adInfoValue.rM5gmW_expanded{white-space:normal;word-break:break-word}.FbTWOG_privacyCloseIcon{filter:invert();width:11px;height:11px}@media (max-width:335px){.FbTWOG_privacyCloseIcon{width:9px;height:9px}}@media (prefers-color-scheme:dark){.FbTWOG_privacyCloseIcon{filter:none}}.FbTWOG_popupContainer.FbTWOG_popupContainerDisplay{z-index:2147483647;position:fixed;top:0;bottom:0;left:0;right:0}.FbTWOG_privacyPopup{z-index:2147483647;background:#fff;border-radius:9px 9px 0 0;padding-top:12px;font-family:Roboto,-apple-system,Segoe UI,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif;transition:transform .2s ease-in-out;position:fixed;bottom:0;left:0;right:0}@media (prefers-color-scheme:dark){.FbTWOG_privacyPopup{color:#fff;background:#121212}}@media (max-width:335px){.FbTWOG_privacyPopup{border-radius:7px 7px 0 0;padding-top:10px}}.FbTWOG_popupHeader{justify-content:space-between;height:24px;margin-bottom:-30px;display:flex;position:relative}.FbTWOG_popupHeader button{z-index:1;cursor:pointer;background:0 0;border:none;position:absolute;top:-3px;right:3.44%}.FbTWOG_readMore{color:#0376d9;padding:16px 0;font-size:16px;font-weight:400}@media (prefers-color-scheme:dark){.FbTWOG_readMore{color:#4a9eff}}@media (max-width:335px){.FbTWOG_readMore{padding:12px 0;font-size:12px}}.FbTWOG_privacyPolicy{text-align:center}.FbTWOG_popupFooter{color:#000;background-color:#f1f1f1;width:100%;margin-top:5px;padding:15px;font-size:12px}@media (prefers-color-scheme:dark){.FbTWOG_popupFooter{color:#fff;background-color:#1e1e1e}}@media (max-width:335px){.FbTWOG_popupFooter{margin-top:3px;padding:12px 10px;font-size:10px}}.FbTWOG_popupFooter .FbTWOG_adInfoTitle{margin-bottom:3px;font-weight:700;line-height:1.4}.FbTWOG_popupBody{padding-top:0;font-size:14px}@media (max-width:335px){.FbTWOG_popupBody{padding-top:0;font-size:13px}}.FbTWOG_show{transform:translateY(0);box-shadow:0 -10px 20px -5px rgba(115,115,115,.75)}@media (prefers-color-scheme:dark){.FbTWOG_show{box-shadow:0 -10px 20px -5px rgba(0,0,0,.75)}}.FbTWOG_hide{transform:translateY(100%)}.FbTWOG_displayNone{display:none}.FbTWOG_mask{-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);background:rgba(255,255,255,.2);transition:all .5s;position:fixed;top:0;bottom:0;left:0;right:0}@media (prefers-color-scheme:dark){.FbTWOG_mask{background:rgba(0,0,0,.5)}}.NQnIja_countdown{text-align:center;color:#fff;background:rgba(51,51,51,.5);border-radius:50%;min-width:35px;min-height:35px;margin:-10px;font-family:Roboto,-apple-system,Segoe UI,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:16px;font-weight:400;line-height:35px;display:block}.NQnIja_countdown:before,.NQnIja_countdown:after{content:"";line-height:0;display:inline-flex}.NQnIja_countdownInvisible{width:18px;height:18px}.mqB7Ka_googlePlayTextContainer{background:rgba(51,51,51,.5);border-radius:4px;padding:0 4px}.mqB7Ka_googlePlayText{vertical-align:top;color:#fff;padding-right:4px;font-size:11px;font-weight:700;line-height:18px;display:inline-block}.LJWyoG_nextButton{color:#fff;text-align:center;z-index:2147483448;justify-content:center;align-items:center;margin:20px 20px 0 0;padding:0;font-family:Roboto,-apple-system,Segoe UI,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:12px;line-height:0;display:flex;position:absolute;top:0;right:0}._7pzQ5q_overlayCta{content:"";z-index:2147483347;touch-action:manipulation;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;width:100%;position:absolute;top:0;bottom:0;left:0;right:0}._7pzQ5q_hidden{display:none}.poFP6W_overlay{z-index:2147483448;-webkit-backdrop-filter:blur(6px);backdrop-filter:blur(6px);background:linear-gradient(rgba(0,15,35,.59) 0%,rgba(0,15,35,.8) 45%,rgba(0,15,35,.8) 100%);width:100%;height:100%;position:fixed;top:0;left:0}.poFP6W_opaque{background:#000}.poFP6W_lastChanceEndCard{flex-direction:column;justify-content:center;align-items:center;width:100%;height:100%;display:flex;position:absolute;top:0;left:0}.poFP6W_backgroundNone{background:0 0}.poFP6W_name{color:#fff;text-align:center;z-index:2147483447;margin:11px 40px 22px;font-family:Roboto,-apple-system,Segoe UI,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:20px;font-weight:700}.poFP6W_icon{z-index:2147483447;border-radius:10px;width:80px;height:80px;display:block}.poFP6W_button{color:#fff;letter-spacing:.9px;z-index:2147483447;background-color:#007aff;border:none;border-radius:50px;padding:7px 18px;font-family:Roboto,-apple-system,Segoe UI,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif;font-weight:700;position:relative}.poFP6W_button:focus{outline:none}.poFP6W_button:before,.poFP6W_button:after{content:"";z-index:-1000;background-repeat:no-repeat;width:140%;height:100%;transition:all .5s ease-out;display:block;position:absolute;left:-20%}.poFP6W_button:before{background-image:radial-gradient(circle,#007aff 20%,transparent 20%),radial-gradient(circle,transparent 20%,#007aff 20%,transparent 30%),radial-gradient(circle,#007aff 20%,transparent 20%),radial-gradient(circle,#007aff 20%,transparent 20%),radial-gradient(circle,transparent 10%,#007aff 15%,transparent 20%),radial-gradient(circle,#007aff 20%,transparent 20%),radial-gradient(circle,#007aff 20%,transparent 20%),radial-gradient(circle,#007aff 20%,transparent 20%),radial-gradient(circle,#007aff 20%,transparent 20%);background-size:10% 10%,20% 20%,15% 15%,20% 20%,18% 18%,10% 10%,15% 15%,10% 10%,18% 18%;display:none;top:-75%}.poFP6W_button:after{background-image:radial-gradient(circle,#007aff 20%,transparent 20%),radial-gradient(circle,#007aff 20%,transparent 20%),radial-gradient(circle,transparent 10%,#007aff 15%,transparent 20%),radial-gradient(circle,#007aff 20%,transparent 20%),radial-gradient(circle,#007aff 20%,transparent 20%),radial-gradient(circle,#007aff 20%,transparent 20%),radial-gradient(circle,#007aff 20%,transparent 20%);background-size:15% 15%,20% 20%,18% 18%,20% 20%,15% 15%,10% 10%,20% 20%;display:none;bottom:-75%}.poFP6W_button.poFP6W_animate:before{animation:2s infinite forwards poFP6W_topBubbles;display:block}.poFP6W_button.poFP6W_animate:after{animation:2.3s infinite forwards poFP6W_bottomBubbles;display:block}@keyframes poFP6W_topBubbles{0%{background-position:5% 90%,10% 90%,10% 90%,15% 90%,25% 90%,25% 90%,40% 90%,55% 90%,70% 90%}50%{background-position:0 80%,0 20%,10% 40%,20% 0,30% 30%,22%,50%,65% 20%,90% 30%}to{background-position:0 70%,0 10%,10% 30%,20% -10%,30% 20%,22% 40%,50% 40%,65% 10%,90% 20%;background-size:0 0,0 0,0 0,0 0,0 0,0 0}}@keyframes poFP6W_bottomBubbles{0%{background-position:10% -10%,30% 10%,55% -10%,70% -10%,85% -10%,70% -10%,70% 0}50%{background-position:0 80%,20% 80%,45% 60%,60% 100%,75% 70%,95% 60%,105% 0}to{background-position:0 90%,20% 90%,45% 70%,60% 110%,75% 80%,95% 70%,110% 10%;background-size:0 0,0 0,0 0,0 0,0 0,0 0}}.J2DrKG_staticImageEndcard{justify-content:center;align-items:center;width:100vw;height:100vh;display:flex}.J2DrKG_staticImageEndcard img{max-height:100%;margin:0 auto}.S2LOeW_icon{font-family:Roboto,-apple-system,Segoe UI,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif}.S2LOeW_muted{z-index:2147483447;padding:10px 30px 30px 10px;position:absolute;top:0;left:0}.S2LOeW_muted span{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='500px' height='500px' %3E%3Ccircle opacity='0.8' cx='249.9' cy='249.9' r='247'/%3E%3Cpath fill='%23fff' d='M418.9 195.8c-3.2-3.2-8.2-3.2-11.4 0l-45.6 45.6-45.6-45.6c-3.2-3.2-8.2-3.2-11.4 0-3.2 3.2-3.2 8.2 0 11.4l45.6 45.6-45.6 45.6c-3.2 3.2-3.2 8.2 0 11.4 1.8 1.8 4.1 2.3 5.9 2.3s4.1-.9 5.9-2.3l45.6-45.6 45.6 45.6c1.8 1.8 4.1 2.3 5.9 2.3s4.1-.9 5.9-2.3c3.2-3.2 3.2-8.2 0-11.4l-45.6-45.6 45.6-45.6c2.9-2.3 2.9-8.2-.8-11.4zM268.2 89.2c-2.3-1.7-6.8-.9-9.1.9l-106.7 79.5H95.2c-5 0-8.2 2.9-8.2 7.6v144c0 4.6 3.2 7.6 8.2 7.6h57.2l106.7 80c1.8.9 3.2 1.7 5 1.7.9 0 2.3 0 3.2-.9 2.3-1.7 5-3.8 5-6.8V95.5c.9-1.7-.9-4.6-4.1-6.3zM148.2 314h-44.8V186.1h44.8V314zm108.5 72.9l-92.1-69v-136l91.7-69v274h.4z'/%3E%3Cpath display='none' d='M268.5 89c-2.3-1.7-6.8-.9-9.2.9l-107 79.9H94.9c-5 0-8.2 3-8.2 7.7V322c0 4.6 3.2 7.7 8.2 7.7h57.4L259.4 410c1.8.9 3.2 1.7 5 1.7.9 0 2.3 0 3.2-.9 2.3-1.7 5-3.8 5-6.8V95.3c1-1.7-.8-4.6-4.1-6.3zM148.2 314.6h-44.9V186.2h44.9v128.4zm108.9 73.1l-92.4-69.3V182l92-69.2v274.9h.4zm149-127.2h-90.5c-4.2 0-7.7-3.5-7.7-7.9s3.4-7.9 7.7-7.9h90.5c4.2 0 7.7 3.5 7.7 7.9s-3.4 7.9-7.7 7.9zm.9-94.6l-88.6 37.6c-3.9 1.6-8.4-.3-10-4.3-1.6-4 .3-8.6 4.1-10.2l88.6-37.6c3.9-1.6 8.4.3 10 4.3 1.6 3.9-.2 8.6-4.1 10.2zm4.7 182.9c-1.6 4-6.1 5.9-10 4.3l-88.6-37.6c-3.9-1.6-5.8-6.2-4.1-10.2 1.6-4 6.1-5.9 10-4.3l88.6 37.6c3.9 1.6 5.8 6.2 4.1 10.2z'/%3E%3C/svg%3E");background-size:100%;width:22px;height:22px;display:block}.S2LOeW_unmuted{z-index:2147483447;padding:10px 30px 30px 10px;position:absolute;top:0;left:0}.S2LOeW_unmuted span{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='500px' height='500px' %3E%3Ccircle opacity='0.8' cx='249.9' cy='249.9' r='247'/%3E%3Cpath display='none' fill='%23fff' d='M418.9 195.8c-3.2-3.2-8.2-3.2-11.4 0l-45.6 45.6-45.6-45.6c-3.2-3.2-8.2-3.2-11.4 0-3.2 3.2-3.2 8.2 0 11.4l45.6 45.6-45.6 45.6c-3.2 3.2-3.2 8.2 0 11.4 1.8 1.8 4.1 2.3 5.9 2.3s4.1-.9 5.9-2.3l45.6-45.6 45.6 45.6c1.8 1.8 4.1 2.3 5.9 2.3s4.1-.9 5.9-2.3c3.2-3.2 3.2-8.2 0-11.4l-45.6-45.6 45.6-45.6c2.9-2.3 2.9-8.2-.8-11.4zM268.2 89.2c-2.3-1.7-6.8-.9-9.1.9l-106.7 79.5H95.2c-5 0-8.2 2.9-8.2 7.6v144c0 4.6 3.2 7.6 8.2 7.6h57.2l106.7 80c1.8.9 3.2 1.7 5 1.7.9 0 2.3 0 3.2-.9 2.3-1.7 5-3.8 5-6.8V95.5c.9-1.7-.9-4.6-4.1-6.3zM148.2 314h-44.8V186.1h44.8V314zm108.5 72.9l-92.1-69v-136l91.7-69v274h.4z'/%3E%3Cpath fill='%23fff' d='M268.5 89c-2.3-1.7-6.8-.9-9.2.9l-107 79.9H94.9c-5 0-8.2 3-8.2 7.7V322c0 4.6 3.2 7.7 8.2 7.7h57.4L259.4 410c1.8.9 3.2 1.7 5 1.7.9 0 2.3 0 3.2-.9 2.3-1.7 5-3.8 5-6.8V95.3c1-1.7-.8-4.6-4.1-6.3zM148.2 314.6h-44.9V186.2h44.9v128.4zm108.9 73.1l-92.4-69.3V182l92-69.2v274.9h.4zm149-127.2h-90.5c-4.2 0-7.7-3.5-7.7-7.9s3.4-7.9 7.7-7.9h90.5c4.2 0 7.7 3.5 7.7 7.9s-3.4 7.9-7.7 7.9zm.9-94.6l-88.6 37.6c-3.9 1.6-8.4-.3-10-4.3-1.6-4 .3-8.6 4.1-10.2l88.6-37.6c3.9-1.6 8.4.3 10 4.3 1.6 3.9-.2 8.6-4.1 10.2zm4.7 182.9c-1.6 4-6.1 5.9-10 4.3l-88.6-37.6c-3.9-1.6-5.8-6.2-4.1-10.2 1.6-4 6.1-5.9 10-4.3l88.6 37.6c3.9 1.6 5.8 6.2 4.1 10.2z'/%3E%3C/svg%3E");background-size:100%;width:22px;height:22px;display:block}.OaF7uW_videoProgress{z-index:2147483447;background:rgba(0,0,0,.2);width:100%;height:.1875rem;position:absolute;bottom:0;left:0;right:0;overflow:hidden}.OaF7uW_videoProgress span{width:0%;height:100%;animation-name:OaF7uW_progress-animation;animation-timing-function:cubic-bezier(0,.79,.5,1);animation-iteration-count:infinite;animation-delay:1ms;animation-fill-mode:forwards;position:absolute;top:0;left:0}.OaF7uW_videoProgress span.OaF7uW_paused{animation-play-state:paused}@keyframes OaF7uW_progress-animation{0%{width:20%}to{width:100%}}.ok_seq_videoPlayerWrap{justify-content:center;align-items:center;width:100%;height:100%;display:flex;position:absolute}.ok_seq_videoPlayer,.ok_seq_videoPlayer video{width:100%;height:100%}.RypQCq_videoBlurWrap{justify-content:center;align-items:center;width:100%;height:100%;display:flex;position:absolute;overflow:hidden}.RypQCq_videoBlurWrap>canvas{filter:blur(6px)brightness(.25);width:100%;height:100%}.dDtiqq_tapToPlayMask{z-index:2147483547;background-color:rgba(0,0,0,.6);position:fixed;top:0;bottom:0;left:0;right:0}.dDtiqq_tapToPlayContainer{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.dDtiqq_tapToPlayIcon{filter:invert();background-image:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2224%22%20height%3D%2224%22%3E%3Cpath%20d%3D%22M9%2011.24V7.5a2.5%202.5%200%200%201%205%200v3.74c1.21-.81%202-2.18%202-3.74C16%205.01%2013.99%203%2011.5%203S7%205.01%207%207.5c0%201.56.79%202.93%202%203.74m9.84%204.63-4.54-2.26c-.17-.07-.35-.11-.54-.11H13v-6c0-.83-.67-1.5-1.5-1.5S10%206.67%2010%207.5v10.74l-3.43-.72c-.08-.01-.15-.03-.24-.03-.31%200-.59.13-.79.33l-.79.8%204.94%204.94c.27.27.65.44%201.06.44h6.79c.75%200%201.33-.55%201.44-1.28l.75-5.27c.01-.07.02-.14.02-.2%200-.62-.38-1.16-.91-1.38%22%2F%3E%3C%2Fsvg%3E);background-position:50%;background-repeat:no-repeat;background-size:100%;width:50px;max-width:120px;max-height:120px;margin:0 auto}@media screen and (min-width:320px){.dDtiqq_tapToPlayIcon{width:calc(7.95455vw + 24.5455px)}}@media screen and (min-width:1200px){.dDtiqq_tapToPlayIcon{width:120px}}.dDtiqq_tapToPlayIcon{height:50px}@media screen and (min-width:320px){.dDtiqq_tapToPlayIcon{height:calc(7.95455vw + 24.5455px)}}@media screen and (min-width:1200px){.dDtiqq_tapToPlayIcon{height:120px}}.dDtiqq_tapToPlayText{color:#fff;text-align:center;margin:.3em 0;font-size:15px;font-weight:400}@media screen and (min-width:320px){.dDtiqq_tapToPlayText{font-size:calc(1.13636vw + 11.3636px)}}@media screen and (min-width:1200px){.dDtiqq_tapToPlayText{font-size:25px}}.closeIcon{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='525.4px' height='525.5px'%3E%3Cpolygon fill='%23ffffff' stroke='%23000000' stroke-width='26' stroke-miterlimit='10' points='452.6,8.9 262.9,198.6 73.1,8.9 9,73 198.8,262.7 9,452 73.1,516.1 262.9,326.8 452.6,516.1 516.7,452 326.9,262.7 516.7,73'%3E%3C/polygon%3E%3C/svg%3E");background-position:50%;background-repeat:no-repeat;background-size:100%;width:18px;height:18px;display:inline-block}.Zz6y0G_download{z-index:2147483447;float:right;cursor:pointer;width:50px;height:50px;padding:20px 10px 10px 20px;line-height:1em;position:fixed;bottom:4px;right:0}.Zz6y0G_download .Zz6y0G_downloadIcon{cursor:pointer;background-image:url("data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20width='48px'%20height='48px'%20%3E%3Cpath%20fill='white'%20d='M11%2040q-1.2%200-2.1-.9Q8%2038.2%208%2037v-7.15h3V37h26v-7.15h3V37q0%201.2-.9%202.1-.9.9-2.1.9Zm13-7.65-9.65-9.65%202.15-2.15%206%206V8h3v18.55l6-6%202.15%202.15Z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-size:23px;width:19px;height:19px;display:inline-block;bottom:10px}@media only screen and (max-height:249px){.Zz6y0G_download{display:none}}.UUyEIq_persistentSimpleCta{z-index:2147483446;background:rgba(0,0,0,.5);border-radius:8px 0 0 8px;padding:8px;transition:transform .8s ease-in-out;display:flex;position:absolute;bottom:8px;right:0;transform:translate(100vw)}@media screen and (min-width:768px) and (min-height:450px){.UUyEIq_persistentSimpleCta{padding:12px}}@media screen and (min-width:1024px) and (min-height:301px){.UUyEIq_persistentSimpleCta{background:linear-gradient(transparent 0%,rgba(0,0,0,.8) 80%);justify-content:center;align-items:center;width:100%;padding:25px;bottom:0}}@media screen and (max-width:302px),screen and (max-height:300px){.UUyEIq_persistentSimpleCta{border-radius:4px 0 0 4px;padding:4px}}.UUyEIq_slideIn{transform:translate(0)}@media screen and (min-width:1024px) and (min-height:301px){.UUyEIq_slideIn{left:50%;transform:translate(-50%)}}.UUyEIq_appIcon{cursor:pointer;border-radius:8px;width:52px;height:52px;left:0}@media screen and (min-width:768px) and (min-height:450px){.UUyEIq_appIcon{width:70px;height:70px}}@media screen and (min-width:1024px) and (min-height:301px){.UUyEIq_appIcon{width:100px;height:100px}}@media screen and (max-width:302px),screen and (max-height:300px){.UUyEIq_appIcon{border-radius:4px;width:26px;height:26px}}.UUyEIq_persistentSimpleCtaBtn{cursor:pointer;text-align:center;color:#fff;white-space:nowrap;background-color:#179e2d;border:none;border-radius:8px;min-width:99px;height:52px;padding:0 10px;font-family:Roboto,-apple-system,Segoe UI,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:21px;font-weight:400}@media screen and (min-width:768px) and (min-height:450px){.UUyEIq_persistentSimpleCtaBtn{height:70px;font-size:30px}}@media screen and (min-width:1024px) and (min-height:301px){.UUyEIq_persistentSimpleCtaBtn{min-width:200px;height:70px;font-size:30px}}@media screen and (max-width:302px),screen and (max-height:300px){.UUyEIq_persistentSimpleCtaBtn{border-radius:4px;min-width:80px;height:26px;font-size:14px}}.UUyEIq_appIcon~.UUyEIq_persistentSimpleCtaBtn{margin-left:8px}@media screen and (min-width:768px) and (min-height:450px){.UUyEIq_appIcon~.UUyEIq_persistentSimpleCtaBtn{margin-left:12px}}@media screen and (min-width:1024px) and (min-height:301px){.UUyEIq_appIcon~.UUyEIq_persistentSimpleCtaBtn{margin-left:0}}@media screen and (max-width:302px),screen and (max-height:300px){.UUyEIq_appIcon~.UUyEIq_persistentSimpleCtaBtn{margin-left:4px}}.UUyEIq_appDetail{color:#fff;min-width:40%;padding:10px 50px;font-family:Roboto,-apple-system,Segoe UI,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif;font-weight:400;display:none}.UUyEIq_appDetail h1{white-space:nowrap;text-overflow:ellipsis;cursor:pointer;width:100%;margin:0;font-size:34px;line-height:40px;overflow:hidden}.UUyEIq_appDetail h2{white-space:nowrap;text-overflow:ellipsis;cursor:pointer;width:100%;margin:0;font-size:20px;line-height:30px;overflow:hidden}@media screen and (min-width:1024px) and (min-height:301px){.UUyEIq_appDetail{flex-direction:column;align-items:flex-start;display:flex}}.DwKKSa_persistentRichCta{z-index:2147483348;background:#333;align-items:center;width:100%;height:120px;padding:10px;display:flex;position:absolute;top:0;left:0}.DwKKSa_persistentRichCta .DwKKSa_appIcon{cursor:pointer;border-radius:10px;width:90px;height:90px;display:block}.DwKKSa_persistentRichCta .DwKKSa_appInfo{flex-direction:column;flex:1;justify-content:space-around;height:100px;padding:0 15px;display:flex;overflow:hidden}.DwKKSa_persistentRichCta .DwKKSa_appInfo h1{color:#fff;white-space:nowrap;text-overflow:ellipsis;cursor:pointer;width:90%;margin:0;font-family:Roboto,-apple-system,Segoe UI,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:17px;font-weight:600;overflow:hidden}.DwKKSa_persistentRichCta .DwKKSa_appInfo p{color:#fff;white-space:nowrap;text-overflow:ellipsis;margin:0;font-family:Roboto,-apple-system,Segoe UI,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:14px;font-weight:600;overflow:hidden}.DwKKSa_persistentRichCta .DwKKSa_persistentRichCtaBtn{cursor:pointer;text-align:center;color:#fff;white-space:nowrap;background:#179e2d;border:none;border-radius:24px;width:100%;height:36px;padding:8px 0;font-family:Roboto,-apple-system,Segoe UI,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:16px;font-weight:600;box-shadow:0 4px 4px rgba(0,0,0,.25)}.dalDea_persistentRichCtaScreenshots{z-index:2147483348;white-space:nowrap;background:#333;width:100%;min-height:190px;padding:17px 0;position:absolute;bottom:0;left:0;overflow-x:scroll;overflow-y:hidden;box-shadow:inset 0 3px 7px 2px rgba(0,0,0,.4)}.dalDea_persistentRichCtaScreenshots .dalDea_slide{height:100%;margin-left:.75em;display:inline-block}.dalDea_persistentRichCtaScreenshots img{cursor:pointer;object-fit:cover;border-radius:.75em;height:100%}.W6zMza_dialogBox{visibility:hidden;text-align:center;color:#565656;z-index:2147483647;background-color:rgba(0,0,0,.8);width:100%;height:100%;position:absolute;top:0;left:0}.W6zMza_dialog{text-align:center;width:288px;margin-top:0;padding:0;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%)}@media only screen and (max-height:20em){.W6zMza_dialog{width:200px}}.W6zMza_dialogContent{border-top-width:7px;border-top-color:#555fff;border-radius:15px;width:100%;position:relative;overflow:hidden}.W6zMza_dialogTitle{color:#fff;background-color:#555fff;padding:8px;font-family:Roboto,-apple-system,Segoe UI,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:16px;font-weight:600}@media only screen and (max-height:20em){.W6zMza_dialogTitle{font-size:1em}}.W6zMza_dialogBody{background-color:#fff;padding:0;overflow:hidden}.W6zMza_dialogText{text-align:center;margin:0 auto;padding:18px 15px;font-family:Roboto,-apple-system,Segoe UI,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:14px;font-weight:400;line-height:1.35em}@media only screen and (max-height:20em){.W6zMza_dialogText{padding:10px;font-size:.8em;line-height:1.25}}.W6zMza_dialogActions{background-color:#fff;width:100%;padding:0}.W6zMza_dialogActions button{text-align:center;background:0 0;border:none;width:100%;padding:8px;font-family:Roboto,-apple-system,Segoe UI,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:14px;font-weight:400;text-decoration:none}@media only screen and (max-height:20em){.W6zMza_dialogActions button{font-size:.75rem}}@media screen and (orientation:landscape){.W6zMza_dialogActions{display:flex}}.tikWIq_primaryButton{color:#fff;background-color:#555fff;padding:0}.tikWIq_primaryButton button{text-transform:uppercase;color:#fff}@media screen and (orientation:landscape){.tikWIq_primaryButton{flex:1}}.tikWIq_secondaryButton{color:#555fff;background-color:#fff;padding:0}.tikWIq_secondaryButton button{color:#555fff}@media screen and (orientation:landscape){.tikWIq_secondaryButton{flex:1}}.tikWIq_primaryButton button{justify-content:center;align-items:center;display:flex}.tikWIq_continueIcon{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2236%22%20height%3D%2246%22%20style%3D%22shape-rendering%3AgeometricPrecision%3Btext-rendering%3AgeometricPrecision%3Bimage-rendering%3AoptimizeQuality%3Bfill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%22%3E%3Cpath%20fill%3D%22%23fefffe%22%20d%3D%22M35.5%2014.5v7q-5.098%2016.59-23%2015.5%204.538%203.446%202%208.5h-5Q5%2040-.5%2035.5v-5a133%20133%200%200%200%2010-9.5q7.75-2.25%205.5%205.5L12.5%2029q12.955%202.295%2016-10.5Q26.88%207.195%2015.5%207q-3.152-2.6-1-6%2016.18-2.067%2021%2013.5%22%20style%3D%22opacity%3A.849%22%2F%3E%3C%2Fsvg%3E) 50%/contain no-repeat;width:12px;height:12px;margin-left:6px;display:inline-block}.oAV7cW_endcardIframe{border:0;width:100%;height:100%;position:absolute;top:0;left:0}.oAV7cW_endcard{text-align:center;width:100vw;height:100vh;position:relative}._37VDnG_composite{width:100vw;height:100vh}._37VDnG_component{width:100%;height:100%;position:relative}._37VDnG_compositeImage{background-position:50%;background-repeat:no-repeat;background-size:contain;justify-content:center;align-items:center;width:100%;height:100%;display:flex}._37VDnG_compositeImage img{display:none}._37VDnG_compositeHtml{width:100%;height:100%}@keyframes i0Mp0G_shrinkToTopLeft{0%{transform:translate(0)scale(1)}to{transform-origin:0 0;transform:translate(10px,10px)scale(.3)}}.i0Mp0G_pictureInPictureContainer{z-index:2147483548;box-sizing:border-box;width:100%;height:100%;margin:0;padding:0;display:block;position:fixed;top:0;left:0}.i0Mp0G_pictureInPictureContainer.i0Mp0G_animationEnded{transform-origin:0 0;transition:transform 1s ease-in-out;transform:translate(10px,10px)scale(.3)}.i0Mp0G_pictureInPictureContainer.i0Mp0G_animatingVideo{animation:.5s ease-in-out forwards i0Mp0G_shrinkToTopLeft}.i0Mp0G_pictureInPictureContainer.i0Mp0G_slideUp{transform:translateY(-100%)scale(.3)}.i0Mp0G_pictureInPictureContainer.i0Mp0G_slideLeft{transform:translate(-100%)scale(.3)}.S3Yt8a_segment{background:rgba(255,255,255,.3);border-radius:2px;flex:1;height:4px;display:flex;position:relative;overflow:hidden}.S3Yt8a_segment:first-child{margin-left:8px}.S3Yt8a_segment:last-child{margin-right:8px}.S3Yt8a_segment span{width:100%;height:100%;display:block;position:absolute;top:0;bottom:0;left:0;right:0}.S3Yt8a_completed{opacity:1;background:#fff;transform:translate(0%)}.S3Yt8a_active{animation-name:S3Yt8a_slide-horizontal;animation-timing-function:linear;animation-fill-mode:forwards}.S3Yt8a_paused{animation-play-state:paused}@keyframes S3Yt8a_slide-horizontal{0%{opacity:1;background:#fff;transform:translate(-100%)}to{opacity:1;background:#fff;transform:translate(0%)}}._6ix-Eq_storyProgress{width:100%;height:100%;padding-top:10px;display:flex;position:absolute}._6ix-Eq_segmentContainer{z-index:2147483347;gap:4px;width:100%;display:flex}._6ix-Eq_prev,._6ix-Eq_next{pointer-events:auto;z-index:2147483348;width:25%;height:85%;position:absolute;bottom:0}._6ix-Eq_prev{left:0}._6ix-Eq_next{right:0}._6ix-Eq_gradient{z-index:1;background:linear-gradient(rgba(0,0,0,.2) 0,transparent 160px);position:absolute;top:0;bottom:0;left:0;right:0}.SUBbvW_modular{width:100vw;height:100vh}#gRz7DW_ad{width:100%;height:100%}</style><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,user-scalable=no,viewport-fit=auto"><meta name=description content="View Master Template"><title>View Master Template</title><style>:where(:not(:is(html,iframe,canvas,img,svg,video,audio,svg *,symbol *))){all:unset;display:revert}:where(:not(:is(html,iframe,canvas,img,svg,video,audio,svg *,symbol *))){all:unset;display:revert}:where(:not(:is(html,iframe,canvas,img,svg,video,audio,svg *,symbol *))){all:unset;display:revert}button{background:0 0;border:none}*,:before,:after{box-sizing:border-box}a,button{cursor:revert}ol,ul,menu{list-style:none}img{max-width:100%;max-height:100%}table{border-collapse:collapse}input,textarea{-webkit-user-select:auto;-moz-user-select:auto;user-select:auto}textarea{white-space:revert}meter{-webkit-appearance:revert;-moz-appearance:revert;appearance:revert}pre{all:revert}::placeholder{color:unset}::marker{content:""}:where([hidden]){display:none}:where([contenteditable]:not([contenteditable=false])){overflow-wrap:break-word;-webkit-user-select:auto;-moz-user-select:auto;user-select:auto}:where([draggable=true]){-webkit-user-drag:element}body{background-color:#000;max-width:100vw;margin:0;padding:0;overflow:hidden}@media screen and (max-height:251px){body{background-color:transparent}}button{padding:0}#dynamic{height:100vh;position:relative;overflow:hidden}.fadeOut{opacity:0;pointer-events:none;transition:opacity .5s}.fadeIn{opacity:1;pointer-events:auto;transition:opacity .5s}a,button,div,span{-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}</style><script>window.appVersion="7.40.1";</script><script type=module>window.Hls={isSupported:()=>!1,DefaultConfig:{loader:class{},abrController:class{}}};</script><script src=mraid.js></script><body>
    
    <div id=dynamic></div>
    
      <script type=module>let e;var t,n,i,r,a,s=class extends Error{},o=class{constructor(){this.id=Symbol()}};class l{static getInstance(e){return this.instance||(this.instance=new l(e)),this.instance}bind(e,t){return this.bindings.set(e,t),this}bindService(e,t){return this.bindings.set(e.identifier.id,t),this}get(e){let t=e instanceof o?e.id:e;if(!this.bindings.has(t))throw new s(`Could not find anything for key ${String(t)}`);return this.bindings.get(t)}has(e){let t=e instanceof o?e.id:e;return this.bindings.has(t)}getById(e){if(!this.bindings.has(e))throw new s(`Could not find anything for key ${String(e)}`);return this.bindings.get(e)}hasById(e){return this.bindings.has(e)}reset(){this.bindings.clear()}constructor(e=Date.now()){this.startTimestamp=e,this.bindings=new Map}}var c=l,d=class{static get(){return c.getInstance().getById(this.identifier.id)}static getIfExists(){let e=c.getInstance();return e.hasById(this.identifier.id)?e.getById(this.identifier.id):void 0}};class u extends d{get(e){return this.replacementTokens[e]}has(...e){return e.every(e=>e in this.replacementTokens)}some(...e){return e.some(e=>e in this.replacementTokens)}getSeriesValues(e){return this.getSeriesTokens(e).map(e=>{var t;return null!=(t=this.replacementTokens[e])?t:""})}getSeriesTokens(e){let t=[],n=[];return Object.keys(this.replacementTokens).filter(t=>t.startsWith(e)).forEach(i=>{let r=i.replace(e,"");/^\d+$/.test(r)?n.push(parseInt(r,10)):t.push(i)}),0===n.length||(n.sort((e,t)=>e-t),n.forEach(n=>t.push(`${e}${n}`))),t}constructor(e){super(),this.replacementTokens=null!=e?e:{}}}u.identifier=new o;var h=u;class v extends d{getLogger(e="default"){return null==this.loggers[e]&&(this.loggers[e]=((e,t="default")=>{let n=e=>e.filter(e=>void 0!==e).flat();return{info:(i,...r)=>{let a=n([t,i,...r]);e.save({activity:{type:"log",event:"info",data:{prefix:t,message:i,optionalParams:r}}}),console.info(...a)},warn:(i,...r)=>{let a=n([t,i,...r]);e.save({activity:{type:"log",event:"warn",data:{prefix:t,message:i,optionalParams:r}}}),console.warn(...a)},error:(i,...r)=>{let a=n([t,i,...r]);e.save({activity:{type:"log",event:"error",data:{prefix:t,message:i,optionalParams:r}}}),console.error(...a)}}})(this,e)),this.loggers[e]}emit(e){e.fireOnlyOnce&&this.hasExistingEvent(e)||(this.save({activity:e}),this.invokeEventHandlers(e))}invokeEventHandlers(e){[...this.eventHandlers[e.type]||[],...this.eventHandlers["*"]||[]].forEach(t=>t(this,e))}save(e){this.activity.push({activity:e.activity,timestamp:Date.now()})}findAll(e){if(e&&"where"in e&&"object"==typeof e.where&&null!==e.where){let t=e.where;return this.activity.filter(e=>this.matchesQuery(e.activity,t))}return this.activity}matchesQuery(e,t){for(let[n,i]of Object.entries(t)){let t=e[n];if("object"!=typeof i||null===i||Array.isArray(i)){if(t!==i)return!1}else if(!this.matchesQuery(t,i))return!1}return!0}findAllActivityEventPairs(e,t,n){let i=this.findAll({where:{type:e}}),r=[],a=null;return i.forEach(e=>{let i=e.activity;i.event===t?a=e:i.event===n&&a&&(r.push([a,e]),a=null)}),r}clear(){this.activity=[]}reset(){this.clear(),this.eventHandlers={},this.loggers={}}addEventHandler(e,t){this.eventHandlers[e]=this.eventHandlers[e]||[],this.eventHandlers[e].push(t)}removeEventHandler(e,t){null!=this.eventHandlers[e]&&(this.eventHandlers[e]=this.eventHandlers[e].filter(e=>e!==t))}getEventHandlers(e){return this.eventHandlers[e]||[]}constructor(...e){super(...e),this.loggers={},this.eventHandlers={},this.activity=[],this.hasExistingEvent=e=>this.activity.some(t=>t.activity.type===e.type&&t.activity.event===e.event)}}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){p(e,t,n[t])})}return e}v.identifier=new o;let m=(e,t)=>{var n;if("string"==typeof e){let n=null==t?void 0:t[e];return n?m(n,t):{type:e}}return"function"==typeof e?{type:null!=(n=e.name)?n:"anonymous",exec:e}:e},f=e=>void 0===e?[]:[].concat(e),S=(e,t)=>f(e).map(e=>m(e,t));var y=e=>"string"==typeof e?{type:e}:e;let C=(e,t)=>{if(e===t)return!0;if(null==e||null==t)return e===t;if(typeof e!=typeof t)return!1;if("object"!=typeof e)return e===t;if(Array.isArray(e)||Array.isArray(t))return!!Array.isArray(e)&&!!Array.isArray(t)&&e.length===t.length&&e.every((e,n)=>C(e,t[n]));let n=Object.keys(e),i=Object.keys(t);return n.length===i.length&&n.every(n=>Object.hasOwn(t,n)&&C(e[n],t[n]))};var E=e=>function(t){return"string"==typeof e&&"string"==typeof t?e===t:"object"==typeof e&&"object"==typeof t?Object.entries(t).every(([t,n])=>e[t]===n):C(e,t)},_=(e,t,n)=>({value:e,context:t,meta:n,actions:[],changed:!1,matches:E(e)}),b=(e,t,n,i,r,a)=>{if(!e)return!0;if("string"==typeof e){let s=null==r?void 0:r[e];if(!s)throw Error(`Guard '${e}' not found${a?` on machine ${a}`:" in implementations"}`);return s(t,n,i)}return e(t,n,i)};let w={type:"xstate.init"},T="xstate.assign";var A=(e,t,n)=>{let i=t,r=!1;return[e.filter(e=>{if(e.type!==T)return!0;r=!0;let t=g({},i),a=e.assignment;if("function"==typeof a)t=g({},i,a(i,n,e.meta));else for(let r of Object.keys(a)){let s=a[r];"function"==typeof s?t[r]=s(i,n,e.meta):t[r]=s}return i=t,!1}),i,r]};function I(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n.push.apply(n,i)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var k=(e,t,n)=>f(e).map(e=>I(g({},m(e,t)),{meta:n})),O=class{clearTimers(e){if(e){let t=`${e}.`;for(let[e,n]of this.activeTimers.entries())e.startsWith(t)&&(n.destroy(),this.activeTimers.delete(e))}else{for(let e of this.activeTimers.values())e.destroy();this.activeTimers.clear()}}startTimersForState(e,t,n,i,r,a,s){for(let o of Object.entries(e)){let[e,l]=o;for(let o of f(l))this.createAfterTimer({delay:e,transition:o,stateConfig:t,currentStateValue:n,currentContext:i,onTimerFire:r,delays:a,regionKey:s})}}createAfterTimer(e){let{delay:t,transition:n,stateConfig:i,currentStateValue:r,currentContext:a,onTimerFire:s,delays:o,regionKey:l}=e,c=((e,t,n,i)=>{let r=Number(e);if(Number.isFinite(r))return r;let a=null==i?void 0:i[e];return a?a(t,{type:`xstate.after.${e}`},n):null})(t,a,i.meta,o);if(null===c)return;let d=this.timerIdCounter++,u=l?`${l}.${r}_${t}_${d}`:`${r}_${t}_${d}`,h=this.timerService.getNewTimer(c,()=>{s(t,n,i,l),this.activeTimers.delete(u)});h.start(),this.activeTimers.set(u,h)}startTimers(e,t,n,i,r){if("object"==typeof e.value){if(!this.parallelManager)return;let a="object"==typeof(null==t?void 0:t.value)?t.value:{};for(let[s,o]of Object.entries(e.value))"string"==typeof o&&this.parallelManager.startTimersForParallelRegion({regionKey:s,regionValue:o,prevValue:a,previousState:t,machineStates:n,context:e.context,startTimersForStateFn:(e,t,n,a,s)=>{this.startTimersForState(e,t,n,a,i,r,s)},clearTimersFn:e=>this.clearTimers(e)});return}this.startTimersForRegularState(e,n,i,r)}startTimersForRegularState(e,t,n,i){this.clearTimers();let r=t[e.value];(null==r?void 0:r.after)&&this.startTimersForState(r.after,r,e.value,e.context,n,i)}constructor(e,t){this.timerService=e,this.parallelManager=t,this.activeTimers=new Map,this.timerIdCounter=0}},D=(e,t,n,i,r,a)=>{if(e){if("string"==typeof e)return void t({type:e});if("target"in e)return void t({type:e.target});if("actions"in e){var s;for(let t of f(e.actions).map(e=>m(e,a)))null==(s=t.exec)||s.call(t,n(),{type:i},r)}}},V=class{stopChildren(){for(let e of this.children.values())e.stop();this.children.clear()}stopSpecificChild(e){let t=this.children.get(e);t&&(t.stop(),this.children.delete(e))}startInvokedChildren(e,t,n,i,r){let a=t.states[e.value];if(null==a?void 0:a.invoke)for(let t of f(a.invoke))t&&this.startSingleInvokedChild(t,e,a,n,i,r)}startSingleInvokedChild(e,t,n,i,r,a){let{id:s,src:o,data:l,onDone:c,onError:d}=e;if(!this.children.has(s))try{var u,h,v;let e,d,p=(u=t.context,h=this.serviceMap,v=i.services,e={type:"xstate.init"},(d=(null==h?void 0:h[o])||(null==v?void 0:v[o]))?d("function"==typeof l?l(u,e):null!=l?l:{},e):null);if(!p)return;let g=this.interpretFn(p,this.serviceMap);this.setupOnDoneCallback(g,p,c,n,i,r,a),g.start(),this.children.set(s,g)}catch(e){this.handleInvokeError(s,e,d,n,i,r,a)}}setupOnDoneCallback(e,t,n,i,r,a,s){var o;if(!n)return;let l=(o=t.config).states?Object.entries(o.states).filter(([,e])=>(null==e?void 0:e.type)==="final").map(([e])=>e):[];0!==l.length&&e.subscribe(e=>{l.includes(e.value)&&D(n,e=>a(e),s,"xstate.done.invoke",i.meta,r.actions)})}handleInvokeError(e,t,n,i,r,a,s){D(n,e=>a(e),s,"xstate.error.invoke",i.meta,r.actions)}getChildren(){return this.children}constructor(e,t){this.interpretFn=e,this.serviceMap=t,this.children=new Map}};function L(e){var t;return"object"==typeof(t=e.value)&&null!==t}let N=(e,t,n,i)=>{var r;for(let a of e)null==(r=a.exec)||r.call(a,t,n,i)};var x=class{evaluateAlwaysGuard(e,t,n,i){if(!e)return!0;let r={type:"xstate.always"};if("string"==typeof e){let a=null==i?void 0:i[e];if(!a)throw Error(`Guard '${e}' not found in implementations`);return a(t,r,n)}return e(t,r,n)}collectAlwaysTransitionActions(e,t,n,i,r){let a=i[e],s=S(n.exit,r),o=S(t,r),l=S(a.entry,r);return{exitActions:s,transitionActions:o,entryActions:l,targetStateConfig:a,allActions:[...s,...o,...l]}}executeAlwaysTransitionActions(e,t,n,i,r,a){let s={type:"xstate.always"};N(e,i,s,r),N(t,i,s,r),N(n,i,s,a)}handleTargetlessAlwaysTransition(e,t,n,i,r){let a={type:"xstate.always"},[s,o,l]=A(f(e).map(e=>I(g({},m(e,i)),{meta:n.meta})),t.context,a);if(l){var c;let e={value:t.value,context:o,meta:n.meta,actions:s,changed:!0,matches:E(t.value)};for(let t of e.actions)null==(c=t.exec)||c.call(t,e.context,a,t.meta);for(let t of r)t(e);return{updatedState:e,changed:!0}}return{updatedState:t,changed:!1}}handleTargetedAlwaysTransition(e,t,n,i,r,a,s){let{exitActions:o,transitionActions:l,entryActions:c,targetStateConfig:d,allActions:u}=this.collectAlwaysTransitionActions(e,t,i,r,a),[h,v]=A(u,n.context,{type:"xstate.always"}),p={value:e,context:v,meta:null==d?void 0:d.meta,actions:h,changed:!0,matches:E(e)};for(let e of(this.executeAlwaysTransitionActions(o,l,c,v,i.meta,d.meta),s))e(p);return{updatedState:p,changed:!0}}checkAlwaysTransitions(e,t,n,i,r){let a=t[e.value];if(!(null==a?void 0:a.always))return{updatedState:e,hasTransition:!1};for(let s of f(a.always)){let{target:o,cond:l,actions:c=[]}=s;if(!this.evaluateAlwaysGuard(l,e.context,a.meta,i))continue;if(o)return{updatedState:this.handleTargetedAlwaysTransition(o,c,e,a,t,n,r).updatedState,hasTransition:!0};let d=this.handleTargetlessAlwaysTransition(c,e,a,n,r);return{updatedState:d.updatedState,hasTransition:d.changed}}return{updatedState:e,hasTransition:!1}}checkAlwaysTransitionsForParallelState(e,t,n,i,r){let a=!1,s=e.value,o=g({},s),l=[];for(let[r,c]of Object.entries(s)){let s=t[r];if(!(null==s?void 0:s.states))continue;let d=s.states[c];if(null==d?void 0:d.always)for(let t of f(d.always)){let{target:c,cond:u,actions:h=[]}=t;if(this.evaluateAlwaysGuard(u,e.context,d.meta,i)&&c){o[r]=c,a=!0;let e=s.states[c],t=S(d.exit,n),i=S(h,n),u=S(null==e?void 0:e.entry,n);l.push(...t,...i,...u);break}}}if(!a)return e;let c={type:"xstate.always"},[d,u]=A(l,e.context,c),h={value:o,context:u,meta:e.meta,actions:d,changed:!0,matches:E(o)};for(let t of(N(l,u,c,e.meta),r))t(h);return h}checkAlwaysTransitionsRecursively(e,t,n,i,r){if(!L(e))return this.checkRegularStateTransitionsRecursively(e,t,n,i,r);let a=e,s=0;for(;s<10;){let e=this.checkAlwaysTransitionsForParallelState(a,t,n,i,r);if(e===a||!L(e))return e===a?a:e;a=e,s++}return a}checkRegularStateTransitionsRecursively(e,t,n,i,r){let a=e,s=0,o=this.checkAlwaysTransitions(a,t,n,i,r);for(a=o.updatedState;o.hasTransition&&s<10;)a=(o=this.checkAlwaysTransitions(a,t,n,i,r)).updatedState,s++;return a}constructor(e){this.machineId=e}},P=(e,t)=>{if((null==t?void 0:t.type)==="parallel"){let e={};for(let n of Object.keys(t.states||{})){let i=t.states[n];e[n]=i.initial||n}return e}return e},R=class{isParallelState(e){return(null==e?void 0:e.type)==="parallel"}isParallelStateValue(e){return"object"==typeof e&&null!==e}assertRegularStateValue(e,t){if("string"!=typeof e)throw TypeError(`${t} received invalid parallel state value. Ad state machines must be regular (non-parallel) with string state values. Parallel states are only allowed in child/template state machines. Current state value: ${JSON.stringify(e)}`);return e}createParallelStateResult(e,t,n,i,r,a){return{value:e,context:t,meta:n.meta,actions:i,changed:r||a,matches:E(e)}}processParallelRegionTransition(e,t,n,i,r,a){var s,o;let l=null==(s=t.states)?void 0:s[n];if(!(null==l?void 0:l.on))return{actions:[],transitioned:!1};for(let e of f(l.on[i.type])){if(!e)continue;let{target:n,cond:s,actions:c}="string"==typeof e?{target:e}:e;if(!s||b(s,r,i,l.meta,a)){if(n){let e=f(l.exit||[]),i=f(c),r=null==(o=t.states)?void 0:o[n];return{newRegionValue:n,actions:[...e,...i,...f((null==r?void 0:r.entry)||[])],transitioned:!0}}return{actions:f(c),transitioned:!1}}}return{actions:[],transitioned:!1}}createParallelTransition(e,t){return(n,i)=>{var r;let a=y(i),s="string"==typeof n?{}:n.value,o="string"==typeof n?null!=(r=e.context)?r:{}:n.context,l="object"==typeof s?g({},s):{},c=!1,d=g({},o),u=[];for(let[n,i]of Object.entries(e.states||{})){let e=l[n],r=this.processParallelRegionTransition(n,i,e,a,d,t.guards);r.transitioned&&r.newRegionValue&&(l[n]=r.newRegionValue,c=!0),r.actions.length>0&&u.push(...r.actions)}if(u.length>0){let[n,i,r]=A(u.map(e=>m(e,t.actions)),d,a);return this.createParallelStateResult(l,i,e,n,c,r)}return this.createParallelStateResult(l,d,e,[],c,!1)}}createParallelInitialState(e,t,n,i){let r={},a=[];for(let[t,n]of Object.entries(e.states||{}))if(n.initial){var s,o;r[t]=P(n.initial,null==(s=n.states)?void 0:s[n.initial]);let e=null==(o=n.states)?void 0:o[n.initial];e&&a.push(...f(e.entry))}let[l,c]=A(a.map(e=>m(e,t.actions)),n,i);return{value:r,context:c,meta:e.meta,actions:l,changed:!1,matches:E(r)}}startTimersForParallelRegion(e){var t;let{regionKey:n,regionValue:i,prevValue:r,previousState:a,machineStates:s,context:o,startTimersForStateFn:l,clearTimersFn:c}=e;if(!(!a||r[n]!==i))return!1;c(n);let d=s[n];if(!d)return!1;let u=null==(t=d.states)?void 0:t[i];return!!(null==u?void 0:u.after)&&(l(u.after,u,i,o,n),!0)}constructor(e){this.machineId=e}},M=class{toActionObject(e){var t,n;if("string"==typeof e){let n=null==(t=this.actionMap)?void 0:t[e];return n?this.toActionObject(n):{type:e}}return"function"==typeof e?{type:null!=(n=e.name)?n:"anonymous",exec:e}:e}convertActions(e){return f(e).map(e=>this.toActionObject(e))}convertActionsWithMeta(e,t){return f(e).map(e=>I(g({},this.toActionObject(e)),{meta:t}))}handleActions(e,t,n){let i=t,r=!1;return[e.filter(e=>{if(e.type!==T)return!0;r=!0;let t=g({},i),a=e.assignment;if("function"==typeof a)t=g({},i,a(i,n,e.meta));else for(let r of Object.keys(a)){let s=a[r];"function"==typeof s?t[r]=s(i,n,e.meta):t[r]=s}return i=t,!1}),i,r]}executeActions(e,t,n,i){var r;for(let a of e)null==(r=a.exec)||r.call(a,t,n,i)}executeStateActions(e,t){var n;for(let i of e.actions)null==(n=i.exec)||n.call(i,e.context,t,i.meta)}executeActionSideEffects(e,t,n,i,r,a,s){var o,l,c;for(let t of e)null==(o=t.exec)||o.call(t,i,r,a);for(let e of t)null==(l=e.exec)||l.call(e,i,r,a);for(let e of n)null==(c=e.exec)||c.call(e,i,r,s)}gatherTransitionActions(e,t,n){return{exitActions:f(e.exit||[]).map(e=>this.toActionObject(e)),transitionActions:f(n).map(e=>this.toActionObject(e)),entryActions:f((null==t?void 0:t.entry)||[]).map(e=>this.toActionObject(e))}}constructor(e){this.actionMap=e}},B=class{setHandleTimerTransition(e){this.handleTimerTransitionCallback=e}handleTargetlessTimerTransition(e,t,n,i){let r=f(t).map(e=>m(e,this.actionsMap)),[a,s,o]=this.actionExecutor.handleActions(r,e.context,i);if(o||a.length>0){var l;let t=I(g({},e),{context:s,actions:a,changed:o});for(let e of a)null==(l=e.exec)||l.call(e,t.context,i,n.meta);return{updatedState:t,shouldNotifyListeners:o}}return{updatedState:e,shouldNotifyListeners:!1}}notifyListeners(e){for(let t of this.listeners)t(e)}createUnchangedState(e,t,n){return{value:e,context:t,meta:n,actions:[],changed:!1,matches:E(e)}}handleTimerTransition(e,t,n,i,r){let{target:a,actions:s=[],cond:o}="string"==typeof t?{target:t}:t,l={type:`xstate.after.${e}`};if(!b(o,i.context,l,n.meta,this.guards))return i;if(!a){let e=this.handleTargetlessTimerTransition(i,s,n,l);return e.shouldNotifyListeners&&this.notifyListeners(e.updatedState),e.updatedState}return r?this.executeParallelRegionTransition(r,a,s,n,l,i):this.executeTargetedTransition(a,s,n,l,i)}executeParallelRegionTransition(e,t,n,i,r,a){var s,o;let l=a.value;if("object"!=typeof l)return a;let c=this.machineConfig.states[e];if(!c)return a;let d=null==(s=c.states)?void 0:s[t];if(!d)return a;let{exitActions:u,transitionActions:h,entryActions:v}=this.actionExecutor.gatherTransitionActions(i,d,n),p=[...u,...h,...v],[m,f]=this.actionExecutor.handleActions(p,a.context,r),S=I(g({},l),{[e]:t}),y={value:S,context:f,meta:this.machineConfig.meta,actions:m,changed:!0,matches:E(S)};this.actionExecutor.executeActionSideEffects(u,h,v,y.context,r,i.meta,d.meta),this.notifyListeners(y),this.timerManager.clearTimers(e);let C=null==(o=c.states)?void 0:o[t];return(null==C?void 0:C.after)&&this.handleTimerTransitionCallback&&this.timerManager.startTimersForState(C.after,C,t,y.context,this.handleTimerTransitionCallback,this.delays,e),y}executeTargetedTransition(e,t,n,i,r){let a=this.machineConfig.states[e],{exitActions:s,transitionActions:o,entryActions:l}=this.actionExecutor.gatherTransitionActions(n,a,t),c=[...s,...o,...l],[d,u]=this.actionExecutor.handleActions(c,r.context,i),h={value:e,context:u,meta:null==a?void 0:a.meta,actions:d,changed:!0,matches:E(e)};return this.actionExecutor.executeActionSideEffects(s,o,l,h.context,i,n.meta,a.meta),this.notifyListeners(h),h=this.alwaysManager.checkAlwaysTransitionsRecursively(h,this.machineConfig.states,this.actionsMap,this.guards,this.listeners),this.handleTimerTransitionCallback&&this.timerManager.startTimers(h,void 0,this.machineConfig.states,this.handleTimerTransitionCallback,this.delays),h}constructor(e,t,n,i,r,a,s,o){this.machineConfig=e,this.guards=t,this.actionsMap=n,this.delays=i,this.listeners=r,this.actionExecutor=a,this.alwaysManager=s,this.timerManager=o}},F=class{getId(){return this.id}start(){return!this.timerService.isPaused()&&!this.isDestroyed&&void 0===this.id&&(this.startTime=Date.now(),this.id=window.setTimeout(()=>{this.callable&&this.callable(),this.id=void 0,this.remainingTime=this.delay,this.promiseResolve&&this.promiseResolve(),this.destroy()},this.remainingTime),!0)}pause(){if(void 0!==this.id&&void 0!==this.startTime){clearTimeout(this.id);let e=Date.now()-this.startTime;this.elapsed+=e,this.remainingTime-=e}this.startTime=void 0,this.id=void 0}destroy(){if(void 0!==this.id&&(clearTimeout(this.id),this.id=void 0),void 0!==this.startTime){let e=Date.now();this.elapsed+=e-this.startTime,this.startTime=void 0}this.isDestroyed=!0,this.promiseReject&&this.promiseReject(!1)}asPromise(){return new Promise((e,t)=>{this.promiseResolve=e,this.promiseReject=t,this.isDestroyed?t(Error("The timer has been destroyed and cannot be started.")):this.start()})}elapsedTime(){return void 0!==this.startTime?this.elapsed+(Date.now()-this.startTime):this.elapsed}restartTimer(){return this.pause(),this.elapsed=0,this.remainingTime=this.delay,this.start()}constructor(e,t,n){this.delay=e,this.timerService=t,this.callable=n,this.remainingTime=e,this.elapsed=0,this.isDestroyed=!1}};class U extends d{destroyAll(){this.timers.forEach(e=>{e.destroy()}),this.timers=[]}getNewTimer(e,t){let n=null==t?new F(e,this):new F(e,this,t);return this.timers.push(n),n}pauseAll(){this.paused=!0,this.timers.forEach(e=>{e.pause()})}standby(){0===this.stash.length&&this.timers.forEach(e=>{void 0!==e.getId()&&(e.pause(),this.stash.push(e))})}wake(){if(0===this.stash.length)return;let e=this.stash.pop();null==e||e.start(),this.wake()}startAll(){this.paused=!1,this.timers.forEach(e=>{e.start()})}isPaused(){return this.paused}constructor(e=!1){super(),this.paused=e,this.timers=[],this.stash=[]}}U.identifier=new o;var H=U;let W=(e,t,n)=>{var i,r,a,s;let o=e.initialState,l="NotStarted",c=new Set,d=new O(t,new R(e.config.id)),u=new V((e,n)=>W(e,t,n),n),h=new x(e.config.id),v=new M(null==(i=e.implementations)?void 0:i.actions),p=new B(e.config,null==(r=e.implementations)?void 0:r.guards,null==(a=e.implementations)?void 0:a.actions,null==(s=e.implementations)?void 0:s.delays,c,v,h,d),g=(e,t,n,i)=>{o=p.handleTimerTransition(e,t,n,o,i)};p.setHandleTimerTransition(g);let m={send:t=>{var n,i,r,a;if("Running"!==l)return;let s=o;if(o=e.transition(o,t),v.executeStateActions(o,y(t)),o.changed&&s.value!==o.value){let t=e.config.states[o.value],n=new Set(((null==t?void 0:t.invoke)?f(t.invoke):[]).map(e=>null==e?void 0:e.id).filter(Boolean));for(let[e]of u.getChildren())n.has(e)||u.stopSpecificChild(e);u.startInvokedChildren(o,e.config,null!=(a=e.implementations)?a:{},e=>m.send(e),()=>m.state.context)}p.notifyListeners(o),o=h.checkAlwaysTransitionsRecursively(o,e.config.states,null==(n=e.implementations)?void 0:n.actions,null==(i=e.implementations)?void 0:i.guards,c),d.startTimers(o,s,e.config.states,g,null==(r=e.implementations)?void 0:r.delays)},children:u.getChildren(),subscribe:e=>(c.add(e),e(o),{unsubscribe:()=>c.delete(e)}),start:t=>{var n,i,r,a,s;if(t){let n="object"==typeof t&&"context"in t?t:{context:null!=(a=e.config.context)?a:{},value:t},i=e.config.states[n.value];o={value:n.value,actions:[],context:n.context,meta:null==i?void 0:i.meta,matches:E(n.value)}}else o=e.initialState;return l="Running",v.executeStateActions(o,w),o=h.checkAlwaysTransitionsRecursively(o,e.config.states,null==(n=e.implementations)?void 0:n.actions,null==(i=e.implementations)?void 0:i.guards,c),u.startInvokedChildren(o,e.config,null!=(s=e.implementations)?s:{},e=>m.send(e),()=>m.state.context),d.startTimers(o,void 0,e.config.states,g,null==(r=e.implementations)?void 0:r.delays),m},stop:()=>(l="Stopped",d.clearTimers(),u.stopChildren(),c.clear(),m),get state(){return o},get status(){return l},get meta(){return e.config.meta}};return m};class G extends d{createMachine(e,t){if(!(null==e?void 0:e.id))throw Error("State machine identifier is missing.");this.machineMap.has(e.id)||this.machineMap.set(e.id,{config:e,options:t,machine:((e,t={})=>{var n;let i=new R(e.id),r=i.isParallelState(e),a=null!=(n=e.context)?n:{};if(r)return{config:e,implementations:t,initialState:i.createParallelInitialState(e,t,a,w),transition:i.createParallelTransition(e,t)};if(!e.initial)throw Error("Initial state required for non-parallel machine");let s=e.states[e.initial],[o,l]=A(k(e.states[e.initial].entry,t.actions,null==s?void 0:s.meta),a,w);return{config:e,implementations:t,initialState:{value:e.initial,context:l,meta:s.meta,actions:o,changed:!1,matches:E(e.initial)},transition:(n,i)=>{var r;let a=y(i),s="string"==typeof n?n:n.value,o="string"==typeof n?null!=(r=e.context)?r:{}:n.context,l=e.states[s];if(!(null==l?void 0:l.on))return _(s,o,null==l?void 0:l.meta);for(let n of f(l.on[a.type])){if(!n)continue;let{target:i,cond:r,actions:c}="string"==typeof n?{target:n}:n;if(!b(r,o,a,l.meta,t.guards,e.id))continue;if(!i){let[e,n,i]=A(k(c,t.actions,l.meta),o,a);return{value:s,context:n,meta:null==l?void 0:l.meta,actions:e,changed:i,matches:E(s)}}let d=e.states[i],[u,h]=A([...k(l.exit,t.actions,null==l?void 0:l.meta),...k(c,t.actions,null==l?void 0:l.meta),...k(null==d?void 0:d.entry,t.actions,null==d?void 0:d.meta)],o,a);return{value:i,context:h,meta:null==d?void 0:d.meta,actions:u,changed:!0,matches:E(i)}}return _(s,o,null==l?void 0:l.meta)}}})(e,t)});let n=this.machineMap.get(e.id);return null==n?void 0:n.machine}interpret(e){var t,n;if(!(null==e||null==(t=e.config)?void 0:t.id))throw Error("State machine is malformed.");return this.interpreterMap.has(e.config.id)||this.interpreterMap.set(e.config.id,W(e,this.timerService,null==(n=e.implementations)?void 0:n.services)),this.interpreterMap.get(e.config.id)}clear(e){e?(this.machineMap.delete(e),this.interpreterMap.delete(e)):(this.machineMap.clear(),this.interpreterMap.clear())}constructor(e=H.get()){super(),this.timerService=e,this.machineMap=new Map,this.interpreterMap=new Map}}G.identifier=new o;let K=e=>({type:T,assignment:e});var j=G,Y=class{isGreaterThan(e){return this.major!==e.major?this.major>e.major:this.minor!==e.minor?this.minor>e.minor:this.patch>e.patch}isLessThan(e){return e.isGreaterThan(this)}isEqualTo(e){return e.major===this.major&&e.minor===this.minor&&e.patch===this.patch}isGreaterThanOrEqualTo(e){return this.isEqualTo(e)||this.isGreaterThan(e)}isLessThanOrEqualTo(e){return this.isEqualTo(e)||this.isLessThan(e)}toString(){return[this.major,this.minor,this.patch].join(".")}constructor(e){if(this.semanticVersion=e,this.major=0,this.minor=0,this.patch=0,!e)return;let[t,n,i]=e.replace(/-.*/,"").replace(/[^\d.]+/g,"").split(".").map(e=>parseInt(e,10));t&&!Number.isNaN(t)&&(this.major=t),n&&!Number.isNaN(n)&&(this.minor=n),i&&!Number.isNaN(i)&&(this.patch=i)}};let q=(e,t,n)=>{e.emit({type:"app-store-mraid",event:t,data:n})};var z=(e,t)=>{let n=`context_${t}`;return c.getInstance().has(n)?{getValue:()=>c.getInstance().get(n),setValue:e=>{c.getInstance().bind(n,e)}}:(c.getInstance().bind(n,e),{getValue:()=>c.getInstance().get(n),setValue:e=>{c.getInstance().bind(n,e)}})};let $={advertiser:{appStoreId:void 0,creative:{format:"",formatVersion:"",id:"",type:"",is:{freeForm:!1,adPodding:!1}},domain:"",rtb:{id:"",name:"others"},headerBidding:!1,mediation:"",disableEndcardCache:!1},device:{ado:!1,countryCode:"",model:"",os:{name:"unknown",version:"0.0.0",is:{iOS:!1,android:!1,amazon:!1,unknown:!0}},skpv:{hasMaskIssue:!1,hasSwipeIssue:!1},type:""},gdpr:{accept:"",body:"",deny:"",requiresConsent:!1,title:""},incentivized:{body:"",close:"",continue:"",title:""},placement:{type:"unknown",id:"",referenceId:"",is:{banner:!1,fullscreen:!0,inLine:!1,mrec:!1,rewarded:!1}},platform:{accTests:void 0,nautilusVersion:"0.0.0",observability:!1,observedExperiments:"",sessionId:"",privacyUrl:""},publisher:{id:"",supports:{appStoreOnFirstTransition:!1,appStoreOnSecondTransition:!1}},sdk:{timeLoaded:void 0,loadTimeout:-1,version:"0.0.0",is:{v70x:!1,v740:!1,v71xOrAbove:!1,v741OrAbove:!1,v744OrAbove:!1,v760OrAbove:!1,v763OrAbove:!1,below721:!1,below7:!1,below71x:!1},supports:{hlsCustomPlayer:!1,omSdk:!1,openPrivacy:!1,orientationProperties:!1,pingUrl:!1,rewardGranted:!1,silent:!1,sko:!1,skpv:!1,aak:!1,apv:!1,videoLength:!1,hapticFeedback:!1,skAdImpression:!1}}};var X,Q,Z,J,ee,et,en,ei,er,ea,es,eo=z($,"AdContext"),el=e=>{var t,n,i,r,a;let s=eo.getValue();eo.setValue(I(g({},s),{gdpr:{requiresConsent:null!=(t=e.consentRequired)&&t,title:null!=(n=e.consentTitleText)?n:"Ad-Interaction Data Collection",body:null!=(i=e.consentBodyText)?i:"With permission, Liftoff collects your ad-interaction data to serve relevant ads to you. Note: you'll see ads independent of your selection, but they may not be as relevant. Do you consent to data tracking for more relevant ads?",accept:null!=(r=e.consentAcceptButtonText)?r:"I consent",deny:null!=(a=e.consentDenyButtonText)?a:"I do not consent"}}))},ec=(e,t)=>{void 0!==e.isViewable&&t.emit({type:"mraid-event",event:"viewableChange",data:{isViewable:e.isViewable}})},ed=()=>c.getInstance().get(v.identifier),eu=()=>ed(),eh=()=>ed(),ev={},ep=[],eg=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,em=Array.isArray;function ef(e,t){for(var n in t)e[n]=t[n];return e}function eS(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function ey(e,t,n){var i,r,a,s={};for(a in t)"key"==a?i=t[a]:"ref"==a?r=t[a]:s[a]=t[a];if(arguments.length>2&&(s.children=arguments.length>3?X.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(a in e.defaultProps)void 0===s[a]&&(s[a]=e.defaultProps[a]);return eC(e,s,i,r,null)}function eC(e,t,n,i,r){var a={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==r?++Z:r,__i:-1,__u:0};return null==r&&null!=Q.vnode&&Q.vnode(a),a}function eE(e){return e.children}function e_(e,t){this.props=e,this.context=t}function eb(e,t){if(null==t)return e.__?eb(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?eb(e):null}function ew(e){(!e.__d&&(e.__d=!0)&&J.push(e)&&!eT.__r++||ee!=Q.debounceRendering)&&((ee=Q.debounceRendering)||et)(eT)}function eT(){for(var e,t,n,i,r,a,s=1;J.length;)J.length>s&&J.sort(en),e=J.shift(),s=J.length,e.__d&&(t=void 0,n=void 0,i=(n=e.__v).__e,r=[],a=[],e.__P&&((t=ef({},n)).__v=n.__v+1,Q.vnode&&Q.vnode(t),eD(e.__P,t,n,e.__n,e.__P.namespaceURI,32&n.__u?[i]:null,r,null==i?eb(n):i,!!(32&n.__u),a),t.__v=n.__v,t.__.__k[t.__i]=t,eL(r,t,a),n.__e=n.__=null,t.__e!=i&&function e(t){var n,i;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,n=0;n<t.__k.length;n++)if(null!=(i=t.__k[n])&&null!=i.__e){t.__e=t.__c.base=i.__e;break}return e(t)}}(t)));eT.__r=0}function eA(e,t,n,i,r,a,s,o,l,c,d){var u,h,v,p,g,m,f,S=i&&i.__k||ep,y=t.length;for(l=function(e,t,n,i,r){var a,s,o,l,c,d=n.length,u=d,h=0;for(e.__k=Array(r),a=0;a<r;a++)null!=(s=t[a])&&"boolean"!=typeof s&&"function"!=typeof s?(l=a+h,(s=e.__k[a]="string"==typeof s||"number"==typeof s||"bigint"==typeof s||s.constructor==String?eC(null,s,null,null,null):em(s)?eC(eE,{children:s},null,null,null):null==s.constructor&&s.__b>0?eC(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):s).__=e,s.__b=e.__b+1,o=null,-1!=(c=s.__i=function(e,t,n,i){var r,a,s,o=e.key,l=e.type,c=t[n],d=null!=c&&0==(2&c.__u);if(null===c&&null==e.key||d&&o==c.key&&l==c.type)return n;if(i>+!!d){for(r=n-1,a=n+1;r>=0||a<t.length;)if(null!=(c=t[s=r>=0?r--:a++])&&0==(2&c.__u)&&o==c.key&&l==c.type)return s}return -1}(s,n,l,u))&&(u--,(o=n[c])&&(o.__u|=2)),null==o||null==o.__v?(-1==c&&(r>d?h--:r<d&&h++),"function"!=typeof s.type&&(s.__u|=4)):c!=l&&(c==l-1?h--:c==l+1?h++:(c>l?h--:h++,s.__u|=4))):e.__k[a]=null;if(u)for(a=0;a<d;a++)null!=(o=n[a])&&0==(2&o.__u)&&(o.__e==i&&(i=eb(o)),function e(t,n,i){var r,a;if(Q.unmount&&Q.unmount(t),(r=t.ref)&&(r.current&&r.current!=t.__e||eN(r,null,n)),null!=(r=t.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){Q.__e(e,n)}r.base=r.__P=null}if(r=t.__k)for(a=0;a<r.length;a++)r[a]&&e(r[a],n,i||"function"!=typeof t.type);i||eS(t.__e),t.__c=t.__=t.__e=void 0}(o,o));return i}(n,t,S,l,y),u=0;u<y;u++)null!=(v=n.__k[u])&&(h=-1==v.__i?ev:S[v.__i]||ev,v.__i=u,m=eD(e,v,h,r,a,s,o,l,c,d),p=v.__e,v.ref&&h.ref!=v.ref&&(h.ref&&eN(h.ref,null,v),d.push(v.ref,v.__c||p,v)),null==g&&null!=p&&(g=p),(f=!!(4&v.__u))||h.__k===v.__k?l=function e(t,n,i,r){var a,s;if("function"==typeof t.type){for(a=t.__k,s=0;a&&s<a.length;s++)a[s]&&(a[s].__=t,n=e(a[s],n,i,r));return n}t.__e!=n&&(r&&(n&&t.type&&!n.parentNode&&(n=eb(t)),i.insertBefore(t.__e,n||null)),n=t.__e);do n=n&&n.nextSibling;while(null!=n&&8==n.nodeType)return n}(v,l,e,f):"function"==typeof v.type&&void 0!==m?l=m:p&&(l=p.nextSibling),v.__u&=-7);return n.__e=g,l}function eI(e,t,n){"-"==t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||eg.test(t)?n:n+"px"}function ek(e,t,n,i,r){var a,s;e:if("style"==t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof i&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||eI(e.style,t,"");if(n)for(t in n)i&&n[t]==i[t]||eI(e.style,t,n[t])}else if("o"==t[0]&&"n"==t[1])a=t!=(t=t.replace(ei,"$1")),t=(s=t.toLowerCase())in e||"onFocusOut"==t||"onFocusIn"==t?s.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=n,n?i?n.u=i.u:(n.u=er,e.addEventListener(t,a?es:ea,a)):e.removeEventListener(t,a?es:ea,a);else{if("http://www.w3.org/2000/svg"==r)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&"popover"!=t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&"-"!=t[4]?e.removeAttribute(t):e.setAttribute(t,"popover"==t&&1==n?"":n))}}function eO(e){return function(t){if(this.l){var n=this.l[t.type+e];if(null==t.t)t.t=er++;else if(t.t<n.u)return;return n(Q.event?Q.event(t):t)}}}function eD(e,t,n,i,r,a,s,o,l,c){var d,u,h,v,p,g,m,f,S,y,C,E,_,b,w,T,A,I=t.type;if(null!=t.constructor)return null;128&n.__u&&(l=!!(32&n.__u),a=[o=t.__e=n.__e]),(d=Q.__b)&&d(t);e:if("function"==typeof I)try{if(f=t.props,S="prototype"in I&&I.prototype.render,y=(d=I.contextType)&&i[d.__c],C=d?y?y.props.value:d.__:i,n.__c?m=(u=t.__c=n.__c).__=u.__E:(S?t.__c=u=new I(f,C):(t.__c=u=new e_(f,C),u.constructor=I,u.render=ex),y&&y.sub(u),u.props=f,u.state||(u.state={}),u.context=C,u.__n=i,h=u.__d=!0,u.__h=[],u._sb=[]),S&&null==u.__s&&(u.__s=u.state),S&&null!=I.getDerivedStateFromProps&&(u.__s==u.state&&(u.__s=ef({},u.__s)),ef(u.__s,I.getDerivedStateFromProps(f,u.__s))),v=u.props,p=u.state,u.__v=t,h)S&&null==I.getDerivedStateFromProps&&null!=u.componentWillMount&&u.componentWillMount(),S&&null!=u.componentDidMount&&u.__h.push(u.componentDidMount);else{if(S&&null==I.getDerivedStateFromProps&&f!==v&&null!=u.componentWillReceiveProps&&u.componentWillReceiveProps(f,C),!u.__e&&null!=u.shouldComponentUpdate&&!1===u.shouldComponentUpdate(f,u.__s,C)||t.__v==n.__v){for(t.__v!=n.__v&&(u.props=f,u.state=u.__s,u.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(e){e&&(e.__=t)}),E=0;E<u._sb.length;E++)u.__h.push(u._sb[E]);u._sb=[],u.__h.length&&s.push(u);break e}null!=u.componentWillUpdate&&u.componentWillUpdate(f,u.__s,C),S&&null!=u.componentDidUpdate&&u.__h.push(function(){u.componentDidUpdate(v,p,g)})}if(u.context=C,u.props=f,u.__P=e,u.__e=!1,_=Q.__r,b=0,S){for(u.state=u.__s,u.__d=!1,_&&_(t),d=u.render(u.props,u.state,u.context),w=0;w<u._sb.length;w++)u.__h.push(u._sb[w]);u._sb=[]}else do u.__d=!1,_&&_(t),d=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++b<25)u.state=u.__s,null!=u.getChildContext&&(i=ef(ef({},i),u.getChildContext())),S&&!h&&null!=u.getSnapshotBeforeUpdate&&(g=u.getSnapshotBeforeUpdate(v,p)),T=d,null!=d&&d.type===eE&&null==d.key&&(T=function e(t){return"object"!=typeof t||null==t||t.__b&&t.__b>0?t:em(t)?t.map(e):ef({},t)}(d.props.children)),o=eA(e,em(T)?T:[T],t,n,i,r,a,s,o,l,c),u.base=t.__e,t.__u&=-161,u.__h.length&&s.push(u),m&&(u.__E=u.__=null)}catch(e){if(t.__v=null,l||null!=a)if(e.then){for(t.__u|=l?160:128;o&&8==o.nodeType&&o.nextSibling;)o=o.nextSibling;a[a.indexOf(o)]=null,t.__e=o}else{for(A=a.length;A--;)eS(a[A]);eV(t)}else t.__e=n.__e,t.__k=n.__k,e.then||eV(t);Q.__e(e,t,n)}else null==a&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):o=t.__e=function(e,t,n,i,r,a,s,o,l){var c,d,u,h,v,p,g,m=n.props,f=t.props,S=t.type;if("svg"==S?r="http://www.w3.org/2000/svg":"math"==S?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),null!=a){for(c=0;c<a.length;c++)if((v=a[c])&&"setAttribute"in v==!!S&&(S?v.localName==S:3==v.nodeType)){e=v,a[c]=null;break}}if(null==e){if(null==S)return document.createTextNode(f);e=document.createElementNS(r,S,f.is&&f),o&&(Q.__m&&Q.__m(t,a),o=!1),a=null}if(null==S)m===f||o&&e.data==f||(e.data=f);else{if(a=a&&X.call(e.childNodes),m=n.props||ev,!o&&null!=a)for(m={},c=0;c<e.attributes.length;c++)m[(v=e.attributes[c]).name]=v.value;for(c in m)if(v=m[c],"children"==c);else if("dangerouslySetInnerHTML"==c)u=v;else if(!(c in f)){if("value"==c&&"defaultValue"in f||"checked"==c&&"defaultChecked"in f)continue;ek(e,c,null,v,r)}for(c in f)v=f[c],"children"==c?h=v:"dangerouslySetInnerHTML"==c?d=v:"value"==c?p=v:"checked"==c?g=v:o&&"function"!=typeof v||m[c]===v||ek(e,c,v,m[c],r);if(d)o||u&&(d.__html==u.__html||d.__html==e.innerHTML)||(e.innerHTML=d.__html),t.__k=[];else if(u&&(e.innerHTML=""),eA("template"==t.type?e.content:e,em(h)?h:[h],t,n,i,"foreignObject"==S?"http://www.w3.org/1999/xhtml":r,a,s,a?a[0]:n.__k&&eb(n,0),o,l),null!=a)for(c=a.length;c--;)eS(a[c]);o||(c="value","progress"==S&&null==p?e.removeAttribute("value"):null==p||p===e[c]&&("progress"!=S||p)&&("option"!=S||p==m[c])||ek(e,c,p,m[c],r),c="checked",null!=g&&g!=e[c]&&ek(e,c,g,m[c],r))}return e}(n.__e,t,n,i,r,a,s,l,c);return(d=Q.diffed)&&d(t),128&t.__u?void 0:o}function eV(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(eV)}function eL(e,t,n){for(var i=0;i<n.length;i++)eN(n[i],n[++i],n[++i]);Q.__c&&Q.__c(t,e),e.some(function(t){try{e=t.__h,t.__h=[],e.some(function(e){e.call(t)})}catch(e){Q.__e(e,t.__v)}})}function eN(e,t,n){try{if("function"==typeof e){var i="function"==typeof e.__u;i&&e.__u(),i&&null==t||(e.__u=e(t))}else e.current=t}catch(e){Q.__e(e,n)}}function ex(e,t,n){return this.constructor(e,n)}X=ep.slice,Q={__e:function(e,t,n,i){for(var r,a,s;t=t.__;)if((r=t.__c)&&!r.__)try{if((a=r.constructor)&&null!=a.getDerivedStateFromError&&(r.setState(a.getDerivedStateFromError(e)),s=r.__d),null!=r.componentDidCatch&&(r.componentDidCatch(e,i||{}),s=r.__d),s)return r.__E=r}catch(t){e=t}throw e}},Z=0,e_.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=ef({},this.state),"function"==typeof e&&(e=e(ef({},n),this.props)),e&&ef(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),ew(this))},e_.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),ew(this))},e_.prototype.render=eE,J=[],et="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,en=function(e,t){return e.__v.__b-t.__v.__b},eT.__r=0,ei=/(PointerCapture)$|Capture$/i,er=0,ea=eO(!1),es=eO(!0);var eP,eR,eM,eB,eF=0,eU=[],eH=Q,eW=eH.__b,eG=eH.__r,eK=eH.diffed,ej=eH.__c,eY=eH.unmount,eq=eH.__;function ez(e,t){eH.__h&&eH.__h(eR,e,eF||t),eF=0;var n=eR.__H||(eR.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function e$(e){return eF=1,function(e,t,n){var i=ez(eP++,2);if(i.t=e,!i.__c&&(i.__=[e4(void 0,t),function(e){var t=i.__N?i.__N[0]:i.__[0],n=i.t(t,e);t!==n&&(i.__N=[n,i.__[1]],i.__c.setState({}))}],i.__c=eR,!eR.__f)){var r=function(e,t,n){if(!i.__c.__H)return!0;var r=i.__c.__H.__.filter(function(e){return!!e.__c});if(r.every(function(e){return!e.__N}))return!a||a.call(this,e,t,n);var s=i.__c.props!==e;return r.forEach(function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(s=!0)}}),a&&a.call(this,e,t,n)||s};eR.__f=!0;var a=eR.shouldComponentUpdate,s=eR.componentWillUpdate;eR.componentWillUpdate=function(e,t,n){if(this.__e){var i=a;a=void 0,r(e,t,n),a=i}s&&s.call(this,e,t,n)},eR.shouldComponentUpdate=r}return i.__N||i.__}(e4,e)}function eX(e,t){var n=ez(eP++,3);!eH.__s&&e6(n.__H,t)&&(n.__=e,n.u=t,eR.__H.__h.push(n))}function eQ(e){return eF=5,eZ(function(){return{current:e}},[])}function eZ(e,t){var n=ez(eP++,7);return e6(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function eJ(e,t){return eF=8,eZ(function(){return e},t)}function e0(){for(var e;e=eU.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(e2),e.__H.__h.forEach(e3),e.__H.__h=[]}catch(t){e.__H.__h=[],eH.__e(t,e.__v)}}eH.__b=function(e){eR=null,eW&&eW(e)},eH.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),eq&&eq(e,t)},eH.__r=function(e){eG&&eG(e),eP=0;var t=(eR=e.__c).__H;t&&(eM===eR?(t.__h=[],eR.__h=[],t.__.forEach(function(e){e.__N&&(e.__=e.__N),e.u=e.__N=void 0})):(t.__h.forEach(e2),t.__h.forEach(e3),t.__h=[],eP=0)),eM=eR},eH.diffed=function(e){eK&&eK(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==eU.push(t)&&eB===eH.requestAnimationFrame||((eB=eH.requestAnimationFrame)||function(e){var t,n=function(){clearTimeout(i),e1&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,35);e1&&(t=requestAnimationFrame(n))})(e0)),t.__H.__.forEach(function(e){e.u&&(e.__H=e.u),e.u=void 0})),eM=eR=null},eH.__c=function(e,t){t.some(function(e){try{e.__h.forEach(e2),e.__h=e.__h.filter(function(e){return!e.__||e3(e)})}catch(n){t.some(function(e){e.__h&&(e.__h=[])}),t=[],eH.__e(n,e.__v)}}),ej&&ej(e,t)},eH.unmount=function(e){eY&&eY(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(e){try{e2(e)}catch(e){t=e}}),n.__H=void 0,t&&eH.__e(t,n.__v))};var e1="function"==typeof requestAnimationFrame;function e2(e){var t=eR,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),eR=t}function e3(e){var t=eR;e.__c=e.__(),eR=t}function e6(e,t){return!e||e.length!==t.length||t.some(function(t,n){return t!==e[n]})}function e4(e,t){return"function"==typeof t?t(e):t}var e7=Symbol.for("preact-signals");function e5(){if(tn>1)tn--;else{for(var e,t=!1;void 0!==tt;){var n=tt;for(tt=void 0,ti++;void 0!==n;){var i=n.o;if(n.o=void 0,n.f&=-3,!(8&n.f)&&tl(n))try{n.c()}catch(n){t||(e=n,t=!0)}n=i}}if(ti=0,tn--,t)throw e}}function e8(e){if(tn>0)return e();tn++;try{return e()}finally{e5()}}var e9=void 0;function te(e){var t=e9;e9=void 0;try{return e()}finally{e9=t}}var tt=void 0,tn=0,ti=0,tr=0;function ta(e){if(void 0!==e9){var t=e.n;if(void 0===t||t.t!==e9)return t={i:0,S:e,p:e9.s,n:void 0,t:e9,e:void 0,x:void 0,r:t},void 0!==e9.s&&(e9.s.n=t),e9.s=t,e.n=t,32&e9.f&&e.S(t),t;if(-1===t.i)return t.i=0,void 0!==t.n&&(t.n.p=t.p,void 0!==t.p&&(t.p.n=t.n),t.p=e9.s,t.n=void 0,e9.s.n=t,e9.s=t),t}}function ts(e,t){this.v=e,this.i=0,this.n=void 0,this.t=void 0,this.W=null==t?void 0:t.watched,this.Z=null==t?void 0:t.unwatched,this.name=null==t?void 0:t.name}function to(e,t){return new ts(e,t)}function tl(e){for(var t=e.s;void 0!==t;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function tc(e){for(var t=e.s;void 0!==t;t=t.n){var n=t.S.n;if(void 0!==n&&(t.r=n),t.S.n=t,t.i=-1,void 0===t.n){e.s=t;break}}}function td(e){for(var t=e.s,n=void 0;void 0!==t;){var i=t.p;-1===t.i?(t.S.U(t),void 0!==i&&(i.n=t.n),void 0!==t.n&&(t.n.p=i)):n=t,t.S.n=t.r,void 0!==t.r&&(t.r=void 0),t=i}e.s=n}function tu(e,t){ts.call(this,void 0),this.x=e,this.s=void 0,this.g=tr-1,this.f=4,this.W=null==t?void 0:t.watched,this.Z=null==t?void 0:t.unwatched,this.name=null==t?void 0:t.name}function th(e){var t=e.u;if(e.u=void 0,"function"==typeof t){tn++;var n=e9;e9=void 0;try{t()}catch(t){throw e.f&=-2,e.f|=8,tv(e),t}finally{e9=n,e5()}}}function tv(e){for(var t=e.s;void 0!==t;t=t.n)t.S.U(t);e.x=void 0,e.s=void 0,th(e)}function tp(e){if(e9!==this)throw Error("Out-of-order effect");td(this),e9=e,this.f&=-2,8&this.f&&tv(this),e5()}function tg(e,t){this.x=e,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32,this.name=null==t?void 0:t.name}function tm(e,t){var n=new tg(e,t);try{n.c()}catch(e){throw n.d(),e}var i=n.d.bind(n);return i[Symbol.dispose]=i,i}ts.prototype.brand=e7,ts.prototype.h=function(){return!0},ts.prototype.S=function(e){var t=this,n=this.t;n!==e&&void 0===e.e&&(e.x=n,this.t=e,void 0!==n?n.e=e:te(function(){var e;null==(e=t.W)||e.call(t)}))},ts.prototype.U=function(e){var t=this;if(void 0!==this.t){var n=e.e,i=e.x;void 0!==n&&(n.x=i,e.e=void 0),void 0!==i&&(i.e=n,e.x=void 0),e===this.t&&(this.t=i,void 0===i&&te(function(){var e;null==(e=t.Z)||e.call(t)}))}},ts.prototype.subscribe=function(e){var t=this;return tm(function(){var n=t.value,i=e9;e9=void 0;try{e(n)}finally{e9=i}},{name:"sub"})},ts.prototype.valueOf=function(){return this.value},ts.prototype.toString=function(){return this.value+""},ts.prototype.toJSON=function(){return this.value},ts.prototype.peek=function(){var e=e9;e9=void 0;try{return this.value}finally{e9=e}},Object.defineProperty(ts.prototype,"value",{get:function(){var e=ta(this);return void 0!==e&&(e.i=this.i),this.v},set:function(e){if(e!==this.v){if(ti>100)throw Error("Cycle detected");this.v=e,this.i++,tr++,tn++;try{for(var t=this.t;void 0!==t;t=t.x)t.t.N()}finally{e5()}}}}),tu.prototype=new ts,tu.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if(32==(36&this.f)||(this.f&=-5,this.g===tr))return!0;if(this.g=tr,this.f|=1,this.i>0&&!tl(this))return this.f&=-2,!0;var e=e9;try{tc(this),e9=this;var t=this.x();(16&this.f||this.v!==t||0===this.i)&&(this.v=t,this.f&=-17,this.i++)}catch(e){this.v=e,this.f|=16,this.i++}return e9=e,td(this),this.f&=-2,!0},tu.prototype.S=function(e){if(void 0===this.t){this.f|=36;for(var t=this.s;void 0!==t;t=t.n)t.S.S(t)}ts.prototype.S.call(this,e)},tu.prototype.U=function(e){if(void 0!==this.t&&(ts.prototype.U.call(this,e),void 0===this.t)){this.f&=-33;for(var t=this.s;void 0!==t;t=t.n)t.S.U(t)}},tu.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var e=this.t;void 0!==e;e=e.x)e.t.N()}},Object.defineProperty(tu.prototype,"value",{get:function(){if(1&this.f)throw Error("Cycle detected");var e=ta(this);if(this.h(),void 0!==e&&(e.i=this.i),16&this.f)throw this.v;return this.v}}),tg.prototype.c=function(){var e=this.S();try{if(8&this.f||void 0===this.x)return;var t=this.x();"function"==typeof t&&(this.u=t)}finally{e()}},tg.prototype.S=function(){if(1&this.f)throw Error("Cycle detected");this.f|=1,this.f&=-9,th(this),tc(this),tn++;var e=e9;return e9=this,tp.bind(this,e)},tg.prototype.N=function(){2&this.f||(this.f|=2,this.o=tt,tt=this)},tg.prototype.d=function(){this.f|=8,1&this.f||tv(this)},tg.prototype.dispose=function(){this.d()};var tf,tS,ty="u">typeof window&&!!window.__PREACT_SIGNALS_DEVTOOLS__,tC=[],tE=[];function t_(e,t){Q[e]=t.bind(null,Q[e]||function(){})}function tb(e){tS&&tS(),tS=e&&e.S()}function tw(e){var t=this,n=e.data,i=tT(n);i.value=n;var r=eZ(function(){for(var e=t.__v;e=e.__;)if(e.__c){e.__c.__$f|=4;break}var n=new tu(function(){var e=i.value.value;return 0===e?0:!0===e?"":e||""},void 0),r=new tu(function(){var e;return!Array.isArray(n.value)&&(null==(e=n.value)||null!=e.constructor)},void 0),a=tm(function(){if(this.N=tV,r.value){var e=n.value;t.__v&&t.__v.__e&&3===t.__v.__e.nodeType&&(t.__v.__e.data=e)}}),s=t.__$u.d;return t.__$u.d=function(){a(),s.call(this)},[r,n]},[]),a=r[0],s=r[1];return a.value?s.peek():s.value}function tT(e,t){return e$(function(){return to(e,t)})[0]}tm(function(){tf=this.N})(),tw.displayName="ReactiveTextNode",Object.defineProperties(ts.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:tw},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}}),t_("__b",function(e,t){if(ty&&"function"==typeof t.type&&window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent(),"string"==typeof t.type){var n,i=t.props;for(var r in i)if("children"!==r){var a=i[r];a instanceof ts&&(n||(t.__np=n={}),n[r]=a,i[r]=a.peek())}}e(t)}),t_("__r",function(e,t){if(ty&&"function"==typeof t.type&&window.__PREACT_SIGNALS_DEVTOOLS__.enterComponent(t),t.type!==eE){tb();var n,i,r=t.__c;r&&(r.__$f&=-2,void 0===(i=r.__$u)&&(tm(function(){n=this}),n.c=function(){r.__$f|=1,r.setState({})},r.__$u=i=n)),tb(i)}e(t)}),t_("__e",function(e,t,n,i){ty&&window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent(),tb(),e(t,n,i)}),t_("diffed",function(e,t){if(ty&&"function"==typeof t.type&&window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent(),tb(),"string"==typeof t.type&&(n=t.__e)){var n,i=t.__np,r=t.props;if(i){var a=n.U;if(a)for(var s in a){var o=a[s];void 0===o||s in i||(o.d(),a[s]=void 0)}else a={},n.U=a;for(var l in i){var c=a[l],d=i[l];void 0===c?(c=function(e,t,n,i){var r=t in e&&void 0===e.ownerSVGElement,a=to(n);return{o:function(e,t){a.value=e,i=t},d:tm(function(){this.N=tV;var n=a.value.value;i[t]!==n&&(i[t]=n,r?e[t]=n:null!=n&&(!1!==n||"-"===t[4])?e.setAttribute(t,n):e.removeAttribute(t))})}}(n,l,d,r),a[l]=c):c.o(d,r)}}}e(t)}),t_("unmount",function(e,t){if("string"==typeof t.type){var n=t.__e;if(n){var i=n.U;if(i)for(var r in n.U=void 0,i){var a=i[r];a&&a.d()}}}else{var s=t.__c;if(s){var o=s.__$u;o&&(s.__$u=void 0,o.d())}}e(t)}),t_("__h",function(e,t,n,i){(i<3||9===i)&&(t.__$f|=2),e(t,n,i)}),e_.prototype.shouldComponentUpdate=function(e,t){var n=this.__$u,i=n&&void 0!==n.s;for(var r in t)return!0;if(this.__f||"boolean"==typeof this.u&&!0===this.u){var a=2&this.__$f;if(!(i||a||4&this.__$f)||1&this.__$f)return!0}else if(!(i||4&this.__$f)||3&this.__$f)return!0;for(var s in e)if("__source"!==s&&e[s]!==this.props[s])return!0;for(var o in this.props)if(!(o in e))return!0;return!1};var tA="u"<typeof requestAnimationFrame?setTimeout:function(e){var t=function(){clearTimeout(n),cancelAnimationFrame(i),e()},n=setTimeout(t,35),i=requestAnimationFrame(t)},tI=function(e){queueMicrotask(function(){queueMicrotask(e)})};function tk(){e8(function(){for(var e;e=tC.shift();)tf.call(e)})}function tO(){1===tC.push(this)&&(Q.requestAnimationFrame||tA)(tk)}function tD(){e8(function(){for(var e;e=tE.shift();)tf.call(e)})}function tV(){1===tE.push(this)&&(Q.requestAnimationFrame||tI)(tD)}function tL(e,t){var n=eQ(e);n.current=e,eX(function(){return tm(function(){return this.N=tO,n.current()},t)},[])}class tN extends d{setMutedSignal(e){this.mutedSignal.value=e}setInitialMutedValue(e){this.initialMutedValue=e}getMutedSignal(){return this.mutedSignal}isMuted(){return this.mutedSignal.value}isSilent(){return this.silent}setSilent(e,t){this.silent=e,t&&this.initialMutedValue||this.setMutedSignal(e)}constructor(){super(),this.mutedSignal=to(!1),this.silent=void 0,this.initialMutedValue=void 0}}tN.identifier=new o;var tx=tN;class tP extends d{isViewable(){return this._isWebViewable&&this._isInternalViewable}isWebViewable(){return this._isWebViewable}setWebViewable(e){this._isWebViewable=e}setInternalViewable(e){this._isInternalViewable=e}constructor(...e){super(...e),this._isWebViewable=!1,this._isInternalViewable=!0}}tP.identifier=new o;var tR=tP,tM=(e,t,n=tR.get(),i=eh(),r=tx.get(),a=eo.getValue())=>{switch(t.event){case"viewableChange":{let{isViewable:e}=t.data;n.setWebViewable(e),i.emit({type:"viewability",event:e?"maximized":"minimized"});break}case"silentChange":{let{isSilent:e}=t.data;if(e===r.isSilent())return;r.setSilent(e,a.device.os.is.iOS)}}},tB=class{getLogger(e){return this.wrappedService.getLogger(e)}emit(e){this.wrappedService.emit(e)}addEventHandler(e,t){this.wrappedService.addEventHandler(e,t)}removeEventHandler(e,t){this.wrappedService.removeEventHandler(e,t)}getEventHandlers(e){return this.wrappedService.getEventHandlers(e)}hasExistingEvent(e){return this.wrappedService.hasExistingEvent(e)}save(e){this.wrappedService.save(e)}clear(){this.wrappedService.clear()}reset(){this.wrappedService.reset()}findAll(e){return this.wrappedService.findAll(e)}findAllActivityEventPairs(e,t,n){return this.wrappedService.findAllActivityEventPairs(e,t,n)}constructor(e){this.wrappedService=e}},tF=class extends tB{emit(e,t){let n=this.getReportableEvent(e,t);this.wrappedService.emit(n)}getEventCount(e,t=["name"]){let n=this.getReportableEvent(e);return this.wrappedService.findAll({where:{type:"observability"}}).filter(e=>{let{activity:i}=e;return!!i.data&&t.every(e=>this.isEventMatch(i.data,n.data,e))}).length}getReportableEvent(e,t){return"observability"===e.type&&null!=e.event?e:{type:"observability",event:"event",data:"string"==typeof e?{name:e,metric:t}:e}}isEventMatch(e,t,n){return Array.isArray(e)?e.some(e=>Array.isArray(t)?t.some(t=>e[n]===t[n]):e[n]===t[n]):Array.isArray(t)?t.some(t=>(null==e?void 0:e[n])===t[n]):(null==e?void 0:e[n])===t[n]}},tU=e=>new tF(null!=e?e:ed()),tH=z({appStoreId:void 0,inlineInstallUrl:void 0},"AppStoreContext");class tW extends d{open(e){this.executeSDKCommand("open",{url:e})}close(){this.executeSDKCommand("close")}setOrientationProperties(e){this.executeSDKCommand("setOrientationProperties",g({},e))}prepareStoreOverlayView(e,t){this.executeSDKCommand("prepareStoreOverlayView",g({appStoreId:e},t))}presentStoreOverlayView(e,t){this.executeSDKCommand("presentStoreOverlayView",g({appStoreId:e},t))}dismissStoreOverlayView(e){let t={};e&&(t.appStoreId=e),this.executeSDKCommand("dismissStoreOverlayView",t)}presentStoreView(e){this.executeSDKCommand("presentStoreView",{appStoreId:e})}prepareStoreView(e){this.executeSDKCommand("prepareStoreView",{appStoreId:e})}openAppStore(e,t){let n={mode:e},{appStoreId:i,inlineInstallUrl:r}=this.appStoreContext.getValue();i&&(n.appStoreId=i),r&&(n.url=r),t&&(n=g({},n,t)),this.executeSDKCommand("openAppStore",n)}triggerImpressions(e){this.executeSDKCommand("triggerImpressions",{appStoreIds:e})}notifySDK(e){var t,n;(null==(n=window.webkit)||null==(t=n.messageHandlers)?void 0:t.vungleMraidHandler)?window.webkit.messageHandlers.vungleMraidHandler.postMessage(e):window.location.href=e}executeSDKCommand(e,t={}){if(!this.sdkReadyForCommand)return;let n=`mraid://${e}`,i=Object.entries(t);for(let e=0;e<i.length;e++){let[t,r]=i[e];n+=(0===e?"?":"&")+encodeURIComponent(t)+`=${encodeURIComponent(r)}`}this.sdkCommandInProgress?this.sdkCommandQueue.push(n):(this.sdkCommandInProgress=!0,this.notifySDK(n))}notifyError(e,t="",n=!1){this.executeSDKCommand("error",{code:e,errorMessage:t,fatal:n})}notifyTPAT(e){this.executeSDKCommand("tpat",{event:e})}notifyReadyToPlay(){this.executeSDKCommand("readyToPlay"),this.observabilityEventReportingService.emit("ready-to-play")}notifyFailToLoad(){this.executeSDKCommand("failToLoad")}consentAction(e){this.executeSDKCommand("consentAction",{event:e})}notifyEventValuePairEvent(e,t){this.executeSDKCommand("actionWithValue",{event:e,value:(t||"null").toString()})}openPrivacy(e){this.adContext.getValue().sdk.supports.openPrivacy?this.executeSDKCommand("openPrivacy",{url:e}):this.open(e)}notifySuccessfulViewAd(){this.executeSDKCommand("successfulView")}getAvailableDiskSpace(){this.executeSDKCommand("getAvailableDiskSpace")}closeSilentModeMonitor(){this.executeSDKCommand("closeSilentModeMonitor")}pingUrl(e,t,n=!1,i,r){let a={requestType:e,url:t,retry:n};i&&(a.requestData=i),r&&(a.headers=r),this.executeSDKCommand("pingUrl",a)}hapticFeedback(e,t){if(!this.adContext.getValue().sdk.supports.hapticFeedback)return;let n={type:e};t&&(n.style=t),this.executeSDKCommand("hapticFeedback",n)}setSdkReadyForCommand(e){this.sdkReadyForCommand=e}setSdkCommandInProgress(e){this.sdkCommandInProgress=e}getSdkCommandQueue(){return this.sdkCommandQueue}notifyReadyEventForSdk6(){if(this.sdk6Tokens&&this.sdk6Properties){let e=window.vungle.mraidBridge;e.notifyReadyEvent(this.sdk6Tokens),e.notifyPropertiesChange(this.sdk6Properties)}}detectBlackScreen(){this.executeSDKCommand("detectBlackScreen",{samplingFactor:20})}initSdk6(){var e,t,n,i,r,a,s,o,l,c;this.sdk6Tokens=null==(n=window.vungle)||null==(t=n.mraidBridgeExt)||null==(e=t.getReplacementTokens)?void 0:e.call(t);let d=null==(i=this.sdk6Tokens)?void 0:i.SDK_VERSION;if(d&&new Y(d).isLessThan(new Y("7.0.0"))){let e=window.vungle.mraidExt,t=window.vungle.mraid,n=e.getConsentRequired?e:t;this.sdk6Properties={consentRequired:null==(r=n.getConsentRequired)?void 0:r.call(n),consentTitleText:null==(a=n.getConsentTitleText)?void 0:a.call(n),consentBodyText:null==(s=n.getConsentBodyText)?void 0:s.call(n),consentAcceptButtonText:null==(o=n.getConsentAcceptButtonText)?void 0:o.call(n),consentDenyButtonText:null==(l=n.getConsentDenyButtonText)?void 0:l.call(n),isViewable:null==(c=t.isViewable)?void 0:c.call(t)},el(this.sdk6Properties)}}exposeMraidBridges(){var e,t;let n,i,r,a,s,o;window.vungle={mraidBridge:(e=this.tokenService,t=this.mraidEventReportingService,{notifyPropertiesChange:(n=this,(e,i)=>{var r,a,s,o;ec(e,t),((e,t,n,i=eo.getValue())=>{if(void 0===t.isSilent)return;let r="iOS"===t.os||i.device.os.is.iOS;r&&e||n.emit({type:"mraid-event",event:"silentChange",fireOnlyOnce:r,data:{isSilent:t.isSilent}})})(i,e,t);let l=new Y(null!=(r=e.sdkVersion)?r:"");if(!0===i||"ios"===e.os&&l.isEqualTo(new Y("7.6.0"))){let t,i;if(e.os&&e.sdkVersion&&(a=e.os,s=e.sdkVersion,t=a.toLowerCase(),i=new Y(s),"ios"===t&&i.isGreaterThanOrEqualTo(new Y("7.0.0"))&&i.isLessThan(new Y("7.3.0")))&&n.setSdkCommandInProgress(!0),void 0!==e.timeLoaded||void 0!==e.timeloaded){let t=eo.getValue();eo.setValue(I(g({},t),{sdk:I(g({},t.sdk),{timeLoaded:null!=(o=e.timeLoaded)?o:e.timeloaded})}))}el(e),n.notifySDK("mraid://propertiesChangeCompleted")}}),notifyReadyEvent:(i=this,n=>{i.setSdkReadyForCommand(!0),n?e.replacementTokens=n:i.notifySuccessfulViewAd(),t.emit({type:"mraid-event",event:"ready"})}),notifyCommandComplete:(r=this,()=>{let e=r.getSdkCommandQueue();if(e.length){let t=e.shift();r.notifySDK(t)}else r.setSdkCommandInProgress(!1)})}),mraidBridgeExt:(a=this.appStoreMraidReportingService,s=this.mraidEventReportingService,o=this.observabilityEventReportingService,{notifyPresentStoreKitViewFinished:e=>{q(a,"finished",{mode:e})},notifyPresentStoreKitViewSuccess:e=>{q(a,"visible",{mode:e})},notifyPresentStoreKitViewFailed:e=>{q(a,"failed",{mode:e})},notifyPresentAppStoreFailed:e=>{q(a,"failed",{mode:e})},notifyPrepareStoreViewSuccess:()=>{q(a,"skpv6-success")},notifyPresentStoreViewFinished:()=>{q(a,"skpv6-finished")},notifyPrepareStoreOverlayViewSuccess:()=>{q(a,"sko6-success")},notifyPresentStoreOverlayViewFinished:()=>{q(a,"sko6-finished")},notifyPresentStoreOverlayViewFailed:()=>{q(a,"sko6-failed")},notifyPresentStoreOverlayViewVisible:()=>{q(a,"sko6-visible")},notifyBlackScreenResult:e=>{-1===e?o.emit("black-screen-detection-error","black-screen-detection-error"):o.emit({type:"observability",event:"event",data:{name:"black-screen-detected",metric:"black-screen-detected",percentage:e}})},requestMRAIDClose:()=>{s.emit({type:"mraid-event",event:"custom-close"})}})}}addMraidEventHandler(){this.mraidEventReportingService.addEventHandler("mraid-event",tM)}constructor(e=h.get(),t=eu(),n=ed(),i=tU(),r=eo,a=tH){super(),this.tokenService=e,this.mraidEventReportingService=t,this.appStoreMraidReportingService=n,this.observabilityEventReportingService=i,this.adContext=r,this.appStoreContext=a,this.sdkReadyForCommand=!1,this.sdkCommandInProgress=!1,this.sdkCommandQueue=[],this.initSdk6(),this.exposeMraidBridges(),this.addMraidEventHandler()}}tW.identifier=new o;var tG=tW,tK=class{clearInterval(){this.id&&(window.clearInterval(this.id),this.id=void 0)}pause(){this.clearInterval()}start(){this.intervalService.isPaused()||void 0!==this.id||this.isDestroyed()||(this.id=window.setInterval(()=>{this.callable()},this.interval))}destroy(){this.clearInterval(),this.destroyed=!0}getId(){return this.id}isDestroyed(){return this.destroyed}constructor(e,t,n){this.interval=e,this.callable=t,this.intervalService=n,this.destroyed=!1}};class tj extends d{getNewInterval(e,t){let n=new tK(e,t,this);return this.intervals.push(n),n}pauseAll(){this.paused=!0,this.intervals.forEach(e=>{e.pause()})}startAll(){this.paused=!1,this.intervals.forEach(e=>{e.start()})}destroyAll(){this.intervals.forEach(e=>{e.destroy()}),this.intervals=[]}isPaused(){return this.paused}constructor(e=!1){super(),this.paused=e,this.intervals=[]}}tj.identifier=new o;var tY=tj;let tq="Unable to load img resource",tz="video load fail after retry",t$="notify fatal error after video load fail",tX="video load fail with no retry",tQ="video does not play after 10s",tZ="video failed to play",tJ=[tz,t$,tX,tQ,tZ,tq,"modular video failed"];var t0=()=>ed(),t1=(e,t=t0())=>{let n=t.findAllActivityEventPairs("viewability","minimized","maximized"),i=0;n.forEach(e=>{i+=e[1].timestamp-e[0].timestamp});let r=t.findAllActivityEventPairs("store-kit-product-view","appStoreOpen","appStoreClose"),a=0;return r.forEach(e=>{a+=e[1].timestamp-e[0].timestamp}),Date.now()-e-i+a},t2=z({scene:void 0},"SceneContext");let t3=e=>{let t=c.getInstance();return t.hasById(e.id)?t.getById(e.id):void 0};var t6=e=>c.getInstance().getById(e.id),t4=new o;class t7 extends d{init(e){this.observability=e(this.tokenService,this.networkRequestService(),this.adContext.getValue(),this.reportingService,this.viewableService,this.sceneContext,this.injectedGetAdDuration),this.isObserved=this.observability.isObserved()}pushEvent(e){var t,n;if(this.isObserved){if(Array.isArray(e)){let n=e.filter(e=>e.name&&this.singleEventsToAccept.includes(e.name));n.length>0&&(null==(t=this.observability)||t.pushManyEvents(n));return}if(e.name&&this.singleEventsToAccept.includes(e.name)){let t=e.name;null==(n=this.observability)||n.pushEvent(t,e)}}}pushError(e,t){var n;this.isObserved&&(null==(n=this.observability)||n.pushError(e,I(g({},t),{error_source:this.getErrorSource(e,t)})))}getErrorSource(e,t){var n;let i=null!=(n=null==e?void 0:e.message)?n:e,r="template";return(null==t?void 0:t.error_source)&&(r=t.error_source),(tJ.includes(i)||/(Failed to load|Unable to load).*/i.test(i))&&(r="resource"),r}constructor(e=h.get(),t=()=>t6(t4),n=eo,i=t0(),r=tR.get(),a=t2,s=t1,o=["ad-close","ad-data-diff","ad-feedback","ad-load","ad-load-complete","ad-start","ad-viewable","awaiting-viewable","app-store-duration","black-screen-detected","black-screen-detection-error","click-metrics","cta","engagement-is-used","frame-rate-measurement","frustration-clicks","fsc","force-viewable","grant-reward","haptic-feedback","hls-level-switched","hls-not-supported","hls-video-stalled","impression","inactivity-observed","modular-video-complete","modular-video-user-interaction","privacy-cta","scene-end","scene-start","template-error","unknown-mraid-command","video-skip-to-endcard","video-start","web-vitals-first-contentful-paint","web-vitals-interaction-to-next-paint","web-vitals-largest-contentful-paint","web-vitals-time-to-first-byte"]){super(),this.tokenService=e,this.networkRequestService=t,this.adContext=n,this.reportingService=i,this.viewableService=r,this.sceneContext=a,this.injectedGetAdDuration=s,this.singleEventsToAccept=o,this.isObserved=!1}}t7.identifier=new o;var t5=t7,t8=()=>ed();class t9 extends d{getMessageFromErrorEvent(e){var t;return e.message&&""!==e.message?e.message:(null==(t=e.error)?void 0:t.message)&&""!==e.error.message?e.error.message:"Unexpected script error"}isIgnoredError(e){let t=e.toLowerCase();return["syntaxerror: unexpected token ':'"].some(e=>t.includes(e))}sendImageError(e,t=!1){let n=this.getImageErrorEvent(e.target);t&&(n.data.is_fatal=!0),this.send(n)}shouldImageErrorBeFatal(e){var t;return"image_0"===e&&!(null==(t=this.sceneContext.getValue().scene)?void 0:t.prev)}handlePlayableError(e){var t,n,i,r,a;let s=(null==(t=e.data)?void 0:t.title)==="playable-error",o=null!=(a=null==(i=e.data)||null==(n=i.content)?void 0:n.message)?a:"";s&&!this.isIgnoredError(o)&&this.send({type:"error-logging",event:"playable",data:{error:e.data.content,error_source:"playable",scene_id:null==(r=this.sceneContext.getValue().scene)?void 0:r.getId()}})}handleUnhandledrejectionError(e){var t,n;this.send({type:"error-logging",event:"unhandledRejection",data:{error:{message:null!=(n=null==(t=e.reason)?void 0:t.toString())?n:"Unhandled rejection error"},error_source:"template"}}),this.observabilityEventReportingService.emit("template-error","template-error")}handleCommonError(e){let{localName:t}=e.target;if("video"===t)return;if("img"===t){let{id:t}=e.target,n=this.shouldImageErrorBeFatal(t);this.sendImageError(e,n);return}let n={type:"error-logging",event:"exception",data:{error:{message:this.getMessageFromErrorEvent(e)},error_source:"template",resource_url:null==e?void 0:e.filename}};this.send(n),this.observabilityEventReportingService.emit("template-error","template-error")}getErrorCode(e){var t;let n=null==(t=e.data)?void 0:t.resource_type;return"image"===n?1e4:"video"===n?10001:30006}getImageErrorEvent(e){let{currentSrc:t}=e;return{type:"error-logging",event:"resource",data:{error:{message:tq},error_source:"resource",resource_type:"image",resource_url:t}}}init(){window.addEventListener("error",this.handleCommonError.bind(this),!0),window.addEventListener("unhandledrejection",this.handleUnhandledrejectionError.bind(this)),window.addEventListener("message",this.handlePlayableError.bind(this))}send(e){this.errorLoggingReportingService.emit(e)}notifyFatalError(e){var t,n;let i=this.getErrorCode(e),r=null!=(n=null==(t=e.data.error)?void 0:t.message)?n:"Unknown error";e.data.resource_url&&(r=`${r}, resource URL: ${e.data.resource_url}`),this.mraidService.notifyError(i,r,!0)}constructor(e=tG.get(),t=t8(),n=tU(),i=t2){super(),this.mraidService=e,this.errorLoggingReportingService=t,this.observabilityEventReportingService=n,this.sceneContext=i}}t9.identifier=new o;var ne=t9,nt={};function nn(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then}(nt=nn).default=nn;class ni extends Error{}var nr=(e,t=1e4,n=new ni("Timed out waiting!"))=>new Promise((i,r)=>{let a=t=>{var s;let o=e();((s=nt)&&s.__esModule?s.default:s)(o)?o.then(e=>{e?i(e):t<0?r(n):setTimeout(()=>a(t-100),100)}):o?i(o):t<0?r(n):setTimeout(()=>a(t-100),100)};setTimeout(()=>a(t-100),100)}),na=class extends tB{emit(e){let t=this.getReportableEvent(e);t&&this.wrappedService.emit(t)}getEventCount(e){let t=this.getReportableEvent(e);return t?this.wrappedService.findAll({where:{type:"scene-event",event:t.event,data:{scene_type:t.data.scene_type}}}).filter(e=>""===t.data.scene_id||e.activity.data.scene_id===t.data.scene_id).length:0}hasExistingEvent(e){let t=this.getReportableEvent(e);return!!t&&this.wrappedService.hasExistingEvent({type:"scene-event",event:t.event,data:{scene_id:t.data.scene_id,scene_type:t.data.scene_type}})}getReportableEvent(e){if("scene-event"===e.type&&null!=e.event)return e;let t=this.sceneContext.getValue().scene;if(t)return{type:"scene-event",event:e,data:{scene_id:t.getId(),scene_type:t.getSceneType()}}}constructor(e,t=t2){super(e),this.sceneContext=t}},ns=(e,t=t2)=>new na(null!=e?e:ed(),t);class no extends d{addEventStreams(e){var t;let n=e.getId();if((null==(t=this.sceneEventStreams[n])?void 0:t.hasCompleted)&&!e.isChild())throw Error("Cannot add more event streams after completion");let i=e.getEventStreams(),r={eventStreams:i,results:{},errors:{},completed:{},hasCompleted:!1};if(this.sceneEventStreams[n]=r,0===Object.keys(i).length){r.hasCompleted=!0;return}Object.keys(r.eventStreams).forEach(e=>{r.eventStreams[e].subscribe({next:t=>{r.results[e]=t},error:t=>{r.errors[e]=t},complete:()=>{r.completed[e]=!0}})})}end(e){this.reportingService.emit({type:"scene-event",event:"sceneEnd",data:{scene_id:e.getId(),scene_type:e.getSceneType()}})}start(e){this.addEventStreams(e),this.reportingService.emit({type:"scene-event",event:"sceneStart",data:{scene_id:e.getId(),scene_type:e.getSceneType()}})}subscribeAll(e){let t=e.getId(),n=this.sceneEventStreams[t];return n.hasCompleted?Promise.resolve({}):new Promise(e=>{nr(()=>Object.keys(n.eventStreams).every(e=>!!n.errors[e]||n.completed[e]),no.MAX_WAIT_TIME,Error(`Event streams for scene ${t} have not completed successfully`)).then(()=>{n.hasCompleted=!0,e(n.results)})})}haveAllCompleted(){return 0===Object.keys(this.sceneEventStreams).length||Object.keys(this.sceneEventStreams).every(e=>this.sceneEventStreams[e].hasCompleted)}reset(){this.sceneEventStreams={}}constructor(e=ns()){super(),this.reportingService=e,this.sceneEventStreams={}}}no.identifier=new o,no.MAX_WAIT_TIME=2e3;var nl=no;class nc extends d{async addRecord(){}async get(){return Promise.resolve(void 0)}async getAllRecords(){return Promise.resolve([])}async clearStore(){}async deleteExpiredRecords(){}}nc.identifier=new o;var nd=nc;class nu extends nd{}nu.identifier=new o;class nh{static async hasSufficientSpace(){var e;if(!(null==(e=window.navigator.storage)?void 0:e.estimate))return!0;let{quota:t,usage:n}=await window.navigator.storage.estimate();return!t||!n||t-n>=5e6}static async shouldInitIndexedDB(){return!!window.indexedDB&&nh.hasSufficientSpace()}static handleUpgrade(e,t){let n=e.target.result,{name:i,keyPath:r,index:a}=t;if(!n.objectStoreNames.contains(i)){let e=n.createObjectStore(i,{keyPath:r});a&&e.createIndex(a.name,a.keyPath,a.options)}}static convertToError(e){var t;return Error(null!=(t=null==e?void 0:e.message)?t:"Unknown error from IndexedDB")}static async open(e){if(await nh.shouldInitIndexedDB())return new Promise((t,n)=>{let{dbName:i,objectStore:r,dbVersion:a}=e,s=window.indexedDB.open(i,a);s.onupgradeneeded=e=>nh.handleUpgrade(e,r),s.onsuccess=e=>t(e.target.result),s.onerror=e=>n(nh.convertToError(e.target.error))}).catch(()=>void 0)}reportError(e){let t=e instanceof Error?e.message:String(e);this.errorLoggingReportingService.emit({type:"error-logging",event:"exception",data:{error:{message:t}}})}async withTransaction(e,t,n){if(!this.db.objectStoreNames.contains(this.storeName))return n;try{let n=this.db.transaction(this.storeName,e),i=n.objectStore(this.storeName);return await new Promise((e,r)=>{n.onerror=()=>r(nh.convertToError(n.error)),t(i).then(t=>e(t)).catch(e=>r(nh.convertToError(e)))})}catch(e){return this.reportError(e),n}}handleCursor(e,t,n,i){let r=e.target.result;if(r)if(r.value.createDate<t){let e=r.delete();e.onsuccess=()=>r.continue(),e.onerror=()=>i(nh.convertToError(e.error))}else r.continue();else n()}async deleteExpiredRecords(){let e=Date.now()-864e5*this.expiry;return this.withTransaction("readwrite",t=>new Promise((n,i)=>{let r=t.openCursor();r.onsuccess=t=>this.handleCursor(t,e,n,i),r.onerror=()=>i(nh.convertToError(r.error))}),void 0)}async addRecord(e){return e.createDate||(e.createDate=Date.now()),this.withTransaction("readwrite",async t=>{let n=t.put(e);return new Promise((e,t)=>{n.onsuccess=()=>e(),n.onerror=()=>t(nh.convertToError(n.error))})},void 0)}async get(e){return this.withTransaction("readonly",async t=>{let n=t.get(e);return new Promise((e,t)=>{n.onsuccess=()=>e(n.result),n.onerror=()=>t(nh.convertToError(n.error))})},void 0)}async getAllRecords(){return this.withTransaction("readonly",async e=>new Promise((t,n)=>{let i=e.getAll();i.onsuccess=()=>t(i.result),i.onerror=()=>n(nh.convertToError(i.error))}),[])}async clearStore(){return this.withTransaction("readwrite",async e=>{let t=e.clear();return new Promise((e,n)=>{t.onsuccess=()=>e(),t.onerror=()=>n(nh.convertToError(t.error))})},void 0)}constructor(e,t,n=t8()){this.db=e;let{objectStore:i}=t;this.storeName=i.name,this.keyPath=i.keyPath,this.expiry=i.expiry,this.errorLoggingReportingService=n}}var nv=class{async getIndexedDatabaseService(){return this.indexedDatabaseService}constructor(e,t,n){this.indexedDatabaseService=nh.open(e).then(i=>i?new nh(i,e,t):new n).then(e=>e.deleteExpiredRecords().then(()=>e))}};class np extends d{async addRecord(e){return(await this.indexedDatabaseService).addRecord(e)}async get(e){return(await this.indexedDatabaseService).get(e)}async getAllRecords(){return(await this.indexedDatabaseService).getAllRecords()}async clearStore(){let e=await this.indexedDatabaseService;await e.clearStore()}async deleteExpiredRecords(){return(await this.indexedDatabaseService).deleteExpiredRecords()}constructor(e={dbName:"viewMaster_indexed_db_urlCache",dbVersion:1,objectStore:{name:"urlCache",keyPath:"url",expiry:30}},t=t8()){super(),this.indexedDatabaseService=new nv(e,t,nu).getIndexedDatabaseService()}}np.identifier=new o;var ng=np,nm=e=>decodeURIComponent(Array.prototype.map.call(atob(e),e=>`%${`00${e.charCodeAt(0).toString(16)}`.slice(-2)}`).join(""));class nf extends d{decode(e){try{var t,n;let i,r;return(t=nm(e),n=!(i=/<script[^>]*?src=(["'][^"']*?mraid.js[^>]*?["'])[^>]*?>(<\/script>)?/gi).test(t)?t:t.replace(i,""),!(r=/(?:window\.)?(?:top\.|parent\.)?(?:window\.)?(?:location(?:\.href)?)\s*=\s*([^;\n]+?)(\n|;|\s*<\/script>|$)/g).test(n)?n:n.replace(r,(e,t,n)=>`mraid.open(${t})${n}`)).replace(/(top\.window\.open|top\.mraid\.open|parent\.window\.open|parent\.mraid\.open)\((.*?)\)/g,"mraid.open($2)")}catch(e){return this.errorLoggingService.emit({type:"error-logging",event:"exception",data:{error:{message:"Failed to decode endcard"}}}),""}}constructor(e=t8()){super(),this.errorLoggingService=e}}nf.identifier=new o;var nS=nf;class ny extends d{add(e,t,n){var i;(null==(i=this.currentItem)?void 0:i.url)===e||this.queue.some(t=>t.url===e)||this.queue.push({url:e,sceneID:t,callback:n}),this.processQueue()}async processQueue(){var e,t,n,i,r,a,s,o,l,c;if(this.isPaused||void 0!==this.currentItem||(this.currentItem=this.queue.shift(),!this.currentItem))return;let d=await this.urlCacheService.get(this.currentItem.url);if(void 0!==d&&(null==(e=d.data)?void 0:e.byteLength)!==0){this.currentItem=void 0,this.processQueue();return}try{this.currentItem.filePromise=new Promise(e=>{this.currentItem&&(this.currentItem.resolveFile=e)}),this.currentItem.fetch=fetch(this.currentItem.url);let e=await this.currentItem.fetch;if(!e.ok)throw Error(`HTTP error! status: ${e.status}`);let o=await e.arrayBuffer(),l={url:this.currentItem.url,data:new Uint8Array(o),mimeType:null!=(s=null==(t=e.headers)?void 0:t.get("Content-Type"))?s:void 0,createDate:Date.now()};this.urlCacheService.addRecord(l);let c={data:l.data,mimeType:l.mimeType};null==(i=this.currentItem)||null==(n=i.resolveFile)||n.call(i,c),this.completedItems[this.currentItem.url]=c,null==(a=this.currentItem)||null==(r=a.callback)||r.call(a,c)}catch(e){this.errorLoggingReportingService.emit({type:"error-logging",event:"resource",data:{error:{message:`Error downloading in smart download queue: ${e}`},error_source:"resource",resource_url:null==(o=this.currentItem)?void 0:o.url}}),null==(c=this.currentItem)||null==(l=c.resolveFile)||l.call(c,void 0)}finally{this.currentItem=void 0,this.processQueue()}}pause(){this.isPaused=!0}resume(){this.isPaused&&(this.isPaused=!1,this.processQueue())}isQueuePaused(){return this.isPaused}getCurrentUrl(){var e;return null==(e=this.currentItem)?void 0:e.url}async awaitDownload(e){var t,n;return(null==(t=this.currentItem)?void 0:t.url)===e?null==(n=this.currentItem)?void 0:n.filePromise:void 0}clearScene(e){this.queue=this.queue.filter(t=>t.sceneID!==e)}getCompletedItem(e){return this.completedItems[e]}constructor(e=ng.get(),t=t8()){super(),this.urlCacheService=e,this.errorLoggingReportingService=t,this.queue=[],this.completedItems={},this.isPaused=!0}}ny.identifier=new o;var nC=ny,nE=((t={})[t.OFF=0]="OFF",t[t.SKO=1]="SKO",t[t.PV=2]="PV",t[t.STATIC_URL=3]="STATIC_URL",t[t.AAK=4]="AAK",t);let n_=()=>ed(),nb=()=>ed();var nw=()=>window.outerHeight<window.outerWidth?"landscape":"portrait",nT=(e,t,n)=>{let i=((e,t)=>{switch(e.event){case"maximized":return t.isViewable()?{type:"MAXIMIZE"}:void 0;case"minimized":return{type:"MINIMIZE"};case"internal-minimized":return{type:"PAUSE"};case"internal-maximized":return t.isViewable()?{type:"PLAY"}:void 0}})(e,n);i&&t.send(i)};class nA extends d{setStopStreamingVideo(e){this.stopStreamingVideo=e}setVideoContext(e,t,n){this.videoScene=e,this.videoElement=t,this.videoInterpreter=n}getVideoScene(){return this.videoScene}getVideoElement(){return this.videoElement}getVideoInterpreter(){return this.videoInterpreter}getFullScreenCallToActionEventHandlerProps(){var e;return this.videoScene?{fullScreenClickConfig:I(g({},this.videoScene.getFullScreenClickConfig()),{enabled:!0,target:null!=(e=this.videoScene.getFullScreenClickConfig().target)?e:nE.PV}),trackingEventMapConfig:I(g({},this.videoScene.getTrackingEventMapConfig()),{enabled:!0}),sceneId:this.videoScene.getId()}:{}}clickHandler(){var e;this.fullScreenCallToActionReportingService.emit({type:"fsc",event:"fsc",data:{scene_id:null==(e=this.videoScene)?void 0:e.getId()}})}videoAdViewableChange(e,t){this.videoScene&&this.videoInterpreter&&nT(t,this.videoInterpreter,this.viewableService)}isPortrait(){return"portrait"===nw()}closeVideo(){var e,t;null==(e=this.stopStreamingVideo)||e.call(this),null==(t=this.videoInterpreter)||t.send({type:"CLOSE"}),this.setVideoContext(void 0,null)}constructor(e=nb(),t=tR.get()){super(),this.fullScreenCallToActionReportingService=e,this.viewableService=t,this.videoElement=null}}nA.identifier=new o;var nI=nA;let nk=()=>ed(),nO=()=>ed();var nD=(e=t2,t=nk())=>{var n,i,r,a;let s=null==(n=e.getValue().scene)?void 0:n.getId();return null!=(a=null==(r=t.findAll({where:{type:"video",event:"bandwidthEstimation",data:{scene_id:s}}}).pop())||null==(i=r.activity.data)?void 0:i.bwe)?a:-1};class nV extends nd{}nV.identifier=new o;class nL extends d{findObservabilityActivityEvent(e){return t=>{var n;let i=t.activity;if((null==i?void 0:i.type)==="observability"&&(Array.isArray(i.data)&&i.data.some(t=>t.name===e)||(null==(n=i.data)?void 0:n.name)===e))return i}}getTypedReportingService(){return this.reportingService}getAdStartTime(){let e=this.getTypedReportingService().findAll({where:{type:"observability"}}).find(this.findObservabilityActivityEvent("ad-start"));if(e)return new Date(e.timestamp)}getVideoEnd(){var e;let t=this.getTypedReportingService().findAll({where:{type:"video",event:"close"}}).find(e=>{var t;return null==(t=e.activity.data)?void 0:t.maximum_viewing_time});if(null==t||null==(e=t.activity.data)?void 0:e.maximum_viewing_time)return Math.floor(1e3*t.activity.data.maximum_viewing_time)}getEndcardSceneEndActivity(){return this.getTypedReportingService().findAll({where:{type:"observability",event:"event",data:{name:"scene-end",scene_type:"endcard"}}}).find(e=>!!e.activity.data&&!Array.isArray(e.activity.data))}getEndcardInteractions(){var e,t;let n=this.getEndcardSceneEndActivity();return null==n||null==(t=n.activity)||null==(e=t.data)?void 0:e.click_count}getEndcardDuration(){var e,t;let n=this.getEndcardSceneEndActivity();return null==n||null==(t=n.activity)||null==(e=t.data)?void 0:e.duration}getVideoCloseShown(){let e=this.getTypedReportingService().findAll({where:{type:"observability"}}),t=this.getTypedReportingService().findAll({where:{type:"scene-event",event:"closeButtonShow",data:{scene_type:"video"}}}),n=e.find(this.findObservabilityActivityEvent("video-start")),i=t.find(e=>{var t;return"scene-event"===e.activity.type&&"closeButtonShow"===e.activity.event&&(null==(t=e.activity.data)?void 0:t.scene_type)==="video"})||t[0];if(n&&i)return i.timestamp-n.timestamp}getEndcardCloseShown(){let e=this.getTypedReportingService().findAll({where:{type:"scene-event",event:"sceneStart",data:{scene_type:"endcard"}}}),t=this.getTypedReportingService().findAll({where:{type:"scene-event",event:"closeButtonShow",data:{scene_type:"endcard"}}}),n=e.find(e=>{var t;return"scene-event"===e.activity.type&&"sceneStart"===e.activity.event&&(null==(t=e.activity.data)?void 0:t.scene_type)==="endcard"})||e[0],i=t.find(e=>{var t;return"scene-event"===e.activity.type&&"closeButtonShow"===e.activity.event&&(null==(t=e.activity.data)?void 0:t.scene_type)==="endcard"})||t[0];if(n&&i)return i.timestamp-n.timestamp}getEndcardInteractionAfterCloseButton(){var e,t;let n=this.getEndcardSceneEndActivity();return null==n||null==(t=n.activity)||null==(e=t.data)?void 0:e.has_interaction_after_close_button_visible}getUserActivityData(){var e;let t=this.adContext.getValue();return{eventId:t.platform.sessionId,creativeId:t.advertiser.creative.id,adSource:t.advertiser.rtb.name,placementType:t.placement.type,time:this.getAdStartTime(),videoUrl:null!=(e=this.tokenService.get("ORIGINAL_VIDEO_URL"))?e:this.tokenService.get("MAIN_STREAM"),videoStart:0,videoEnd:this.getVideoEnd(),endcardInteractions:this.getEndcardInteractions(),endcardDuration:this.getEndcardDuration(),videoCloseShown:this.getVideoCloseShown(),endcardCloseShown:this.getEndcardCloseShown(),endcardInteractionAfterCloseButton:this.getEndcardInteractionAfterCloseButton(),rewarded:t.placement.is.rewarded,createDate:Date.now(),averageBandwidth:this.injectedGetVideoStreamAverageBandwidth()}}async addRecord(){let e=await this.indexedDatabaseService,t=this.getUserActivityData();return e.addRecord(t)}async getAllRecords(){return(await this.indexedDatabaseService).getAllRecords()}async deleteExpiredRecords(){return(await this.indexedDatabaseService).deleteExpiredRecords()}constructor(e={dbName:"viewMaster_indexed_db",dbVersion:1,objectStore:{name:"userActivity",keyPath:"eventId",expiry:90}},t=t8(),n=h.get(),i=t0(),r=nD,a=eo){super(),this.indexedDatabaseService=new nv(e,t,nV).getIndexedDatabaseService(),this.tokenService=n,this.reportingService=i,this.adContext=a,this.injectedGetVideoStreamAverageBandwidth=r}}nL.identifier=new o;var nN=nL,nx=class{getTransitions(){return this.transitions}addTransition(e){return this.transitions.push(e),this}getDelayedTransitions(){return this.delayedTransitions}addDelayedTransition(e){return this.delayedTransitions.push(e),this}addOrUpdateTransition(e){let t=this.getTransitions().find(t=>t.name===e.name);if(t){t.scene=e.scene,t.cond=e.cond;let n={};t.actions.forEach(e=>{n[e.name]=!0});let i=e.actions.filter(e=>!n[e.name]);t.actions.push(...i)}else this.addTransition(e);return this}getEntryActions(){return this.entryActions}addEntryAction(e){return this.entryActions.push(e),this}getExitActions(){return this.exitActions}addExitAction(e){return this.exitActions.push(e),this}isAlternative(){return this.alternative}isChild(){return this.child}getEventStreams(){return{}}constructor(){this.transitions=[],this.delayedTransitions=[],this.entryActions=[],this.exitActions=[],this.alternative=!1,this.child=!1}};let nP={name:"PRIVACY_LOGO_SHOW",actions:[{name:"setPrivacyButtonVisible"}]},nR={name:"PRIVACY_LOGO_HIDE",actions:[{name:"setPrivacyButtonHidden"}]},nM={name:"PRIVACY_BOTTOM_DRAWER_CLOSE",actions:[{name:"setPrivacyDrawerClosed"},{name:"triggerInternalViewableChange"},{name:"resumeOverlayView"}]},nB={name:"OPEN_PRIVACY_PAGE",actions:[{name:"openPrivacyUrl"}]},nF={name:"PRODUCT_VIEW_CLOSE",actions:[{name:"endAdOnProductViewClose"}]},nU={name:"CLOSE_BUTTON_CLICK",actions:[{name:"emitCloseButtonClick"}]},nH={name:"CLOSE_BUTTON_WILL_SHOW",actions:[{name:"emitCloseButtonShow"}]},nW={name:"CLOSE_PICTURE_IN_PICTURE",actions:[{name:"closePictureInPicture"}]},nG={name:"STOP_THEATRE_MODE",actions:[{name:"setTheatreModeInactive"}]},nK={name:"START_THEATRE_MODE",actions:[{name:"setTheatreModeActive"}]};var nj=function(e){return!!e&&"function"==typeof e.getLastChanceEndcardConfig},nY=class extends nx{getTransitions(){return super.getTransitions().concat(nR,nP,{name:"PRIVACY_BOTTOM_DRAWER_OPEN",actions:this.isFullscreen?[{name:"setPrivacyDrawerOpen"},{name:"triggerInternalViewableChange"},{name:"interruptOverlayView"}]:[{name:"openPrivacyUrl"}]},nM,nB,nW)}isLastPage(){var e;return(!nj(this)||!this.getLastChanceEndcardConfig().enabled)&&(null==(e=this.next)?void 0:e.getSceneType())==="closed"}constructor({isFullscreen:e}){super(),this.isFullscreen=e,this.addExitAction({name:"closeStoreKitOverlay"})}};let nq={name:"MUTE",actions:[{name:"muteSound"},{name:"emitMuted"}]},nz={name:"UNMUTE",actions:[{name:"unMuteSound"},{name:"emitMuted"}]},n$={name:"VIDEO_ERROR",actions:[{name:"emitVideoError"}]};var nX=((n=nX||{})[n.CLOSE=0]="CLOSE",n[n.SKIP=1]="SKIP",n),nQ=nX;let nZ=e=>null!==e&&"object"==typeof e&&(void 0===e.manifest||"string"==typeof e.manifest)&&(void 0===e.track_0||"string"==typeof e.track_0)&&(void 0===e.chunks||!!Array.isArray(e.chunks)&&!!e.chunks.every(e=>"string"==typeof e||null!==e&&"object"==typeof e&&Object.values(e).every(e=>"string"==typeof e)))&&!0;var nJ=e=>{if(!e)return!1;let t=e.toLowerCase();return!t.startsWith("http://")&&!t.startsWith("https://")};let n0=e=>{if(!e)return"";if(nJ(e)&&!["file://","locache://"].some(t=>e.toLowerCase().startsWith(t))){let t;return t=window.location.pathname.replace("index.html",""),`file://${t}${e}`}return e};var n1=class{getStreamManifest(){var e,t;let n;return void 0!==(n=null==(e=this.scene)||null==(t=e.getStreamManifest)?void 0:t.call(e))&&nZ(n)?this.scene.getStreamManifest():void 0}getAudioManifest(){var e,t;let n;return void 0!==(n=null==(e=this.scene)||null==(t=e.getAudioManifest)?void 0:t.call(e))&&nZ(n)?this.scene.getAudioManifest():void 0}getCachedManifestMetadata(){var e,t,n,i,r,a,s,o,l,c;let d=this.getStreamManifest(),u=this.getAudioManifest();return{video:{tracks:null!=(n=null==d?void 0:d.tracks)?n:{},manifest:null!=(i=null==d?void 0:d.manifest)?i:"",chunks:null!=(r=null==d||null==(e=d.chunks)?void 0:e.map(n0))?r:[],chunk_init:null!=(a=n0(null==d?void 0:d.chunk_init))?a:""},audio:{tracks:null!=(s=null==u?void 0:u.tracks)?s:{},manifest:null!=(o=null==u?void 0:u.manifest)?o:"",chunks:null!=(l=null==u||null==(t=u.chunks)?void 0:t.map(n0))?l:[],chunk_init:null!=(c=n0(null==u?void 0:u.chunk_init))?c:""}}}getChunkFormat(){var e,t;let n=null==(t=this.getStreamManifest())||null==(e=t.chunks)?void 0:e[0];if(!n||!nJ(n))return"";let i=n.split(".");return i.length<2?"":i[i.length-1]}constructor(e=t2.getValue().scene){this.scene=e}},n2=class{subscribe(e){let t,n=()=>{t&&t.unsubscribe(),this.isUnsubscribed||(this.isUnsubscribed=!0)};return t=this.subscribeFn({next:t=>{this.isUnsubscribed||e.next(t)},error:t=>{var i;this.isUnsubscribed||(null==(i=e.error)||i.call(e,t),n())},complete:()=>{var t;this.isUnsubscribed||(null==(t=e.complete)||t.call(e),n())}}),{unsubscribe:n}}pipe(...e){return e.reduce((e,t)=>t(e),this)}constructor(e){this.isUnsubscribed=!1,this.subscribeFn=e}},n3=function(e){return t=>new n2(n=>t.subscribe({next:t=>{e(t)&&n.next(t)},error:e=>{var t;return null==(t=n.error)?void 0:t.call(n,e)},complete:()=>{var e;return null==(e=n.complete)?void 0:e.call(n)}}))},n6=(e,t)=>new n2(n=>{let i=(e,t)=>n.next(t);return e.addEventHandler(t,i),{unsubscribe:()=>{e.removeEventHandler(t,i)}}}),n4=(e,t)=>n6(e,"scene-event").pipe(n3(e=>e.event===t)),n7=(e,t,n)=>n6(e,"error-logging").pipe(n3(e=>e.event===t&&(!n||e.data.resource_type===n))),n5=function(){return e=>new n2(t=>{let n=0,i=e.subscribe({next:()=>{n+=1,t.next(n)},error:e=>{var n;return null==(n=t.error)?void 0:n.call(t,e)},complete:()=>{var e;return null==(e=t.complete)?void 0:e.call(t)}});return{unsubscribe:()=>i.unsubscribe()}})},n8=function(e){return t=>new n2(n=>{let i=null,r=t.subscribe({next:e=>n.next(e),error:e=>{var t;return null==(t=n.error)?void 0:t.call(n,e)},complete:()=>{var e;return null==(e=n.complete)?void 0:e.call(n)}});return i=e.subscribe({next:()=>{var e;null==(e=n.complete)||e.call(n),r.unsubscribe(),null==i||i.unsubscribe()}}),{unsubscribe:()=>{r.unsubscribe(),i.unsubscribe()}}})},n9=(e,t)=>new n2(n=>{let i=null,r=null,a=null;return r=e.subscribe({next:()=>{i=Date.now()}}),a=t.subscribe({next:()=>{if(null!=i){var e;n.next(Date.now()-i),null==r||r.unsubscribe(),null==a||a.unsubscribe(),null==(e=n.complete)||e.call(n)}}}),{unsubscribe:()=>{null==r||r.unsubscribe(),null==a||a.unsubscribe()}}}),ie=function(e){return t=>new n2(n=>{let i=e,r=t.subscribe({next:e=>{var t;i>0&&(n.next(e),i-=1),0===i&&(null==(t=n.complete)||t.call(n))},error:e=>{var t;return null==(t=n.error)?void 0:t.call(n,e)},complete:()=>{var e;return null==(e=n.complete)?void 0:e.call(n)}});return{unsubscribe:()=>r.unsubscribe()}})},it=(e,t,n)=>new n2(i=>{let r=n9(e,t).subscribe({next:e=>{var t;i.next(e),null==(t=i.complete)||t.call(i)}}),a=n.subscribe({next:()=>{var e;i.next(0),null==(e=i.complete)||e.call(i)}});return{unsubscribe:()=>{r.unsubscribe(),a.unsubscribe()}}}),ii=(e,t,n)=>new n2(i=>{let r=0,a=null,s=t.subscribe({next:()=>{var e;i.next(r),null==(e=i.complete)||e.call(i),null==a||a.unsubscribe(),s.unsubscribe()}}),o=e.subscribe({next:()=>{a=n.subscribe({next:()=>{r+=1},error:e=>{var t;return null==(t=i.error)?void 0:t.call(i,e)}})}});return{unsubscribe:()=>{null==a||a.unsubscribe(),o.unsubscribe()}}}),ir=function(e){return t=>new n2(n=>{let i={next:e=>n.next(e),error:e=>{var t;return null==(t=n.error)?void 0:t.call(n,e)},complete:()=>{var e;return null==(e=n.complete)?void 0:e.call(n)}};t.subscribe({next:t=>{e(t).subscribe(i)},error:e=>{var t;return null==(t=n.error)?void 0:t.call(n,e)}})})},ia=function(e){return t=>new n2(n=>{let i=0;return t.subscribe({next:t=>{try{let r=e(t,i);n.next(r),i+=1}catch(e){var r;null==(r=n.error)||r.call(n,e)}},error:e=>{var t;return null==(t=n.error)?void 0:t.call(n,e)},complete:()=>{var e;return null==(e=n.complete)?void 0:e.call(n)}})})},is=function(e){return t=>new n2(n=>{let i=!1,r=t.subscribe({next:e=>{i=!0,n.next(e)},error:e=>{var t;return null==(t=n.error)?void 0:t.call(n,e)},complete:()=>{var t;i||n.next(e),null==(t=n.complete)||t.call(n)}});return{unsubscribe:()=>r.unsubscribe()}})};let io="persistent-rich-cta-button",il="Persistent simple CTA",ic="persistent-simple-cta-button",id="mute-button",iu="#555FFF",ih=3e3,iv="close-or-skip-button",ip="countdown",ig="last-chance-endcard-next-button",im="last-chance-endcard-cta",iS="next-button",iy="privacy-drawer",iC="shield-icon",iE=Symbol("source"),i_="gdpr",ib=[id,iv,iC,iy],iw=(e,t)=>{if(e instanceof Element){var n,i;let r=null!=(n=e.getAttribute("id"))?n:"",a=null!=(i=e.getAttribute("data-id"))?i:"";return!(t.includes(r)||t.includes(a))&&("body"===e.tagName.toLowerCase()||iw(e.parentElement,t))}return!0},iT=(e,t=ns)=>{let n=t();((e,t,n=t2)=>{let i=n.getValue().scene,{clientX:r,clientY:a}="touches"in e?e.touches[0]:e;t.emit({type:"scene-event",event:"click",data:{scene_id:null==i?void 0:i.getId(),scene_type:null==i?void 0:i.getSceneType(),click_coordinates:{x:r,y:a},click_target:e.target}})})(e,n),((e,t=ns())=>{let n;if(void 0===e)return;let i={clientX:"touches"in e?e.touches[0].clientX:e.clientX,clientY:"touches"in e?e.touches[0].clientY:e.clientY};(document.querySelector(`#${iv}`)?(e=>{let t=document.querySelector(`#${iv}`);if(null===t)return!1;let{clientX:n,clientY:i}=e,{top:r,right:a,bottom:s,left:o}=t.getBoundingClientRect();return(n<o&&n>=o-30||n>a&&n<=a+30)&&i>=r-30&&i<=s+30||(i<r&&i>=r-30||i>s&&i<=s+30)&&n>=o-30&&n<=a+30})(i):(n={left:window.innerWidth-75,bottom:75},i.clientX>=n.left&&i.clientY<=n.bottom))&&t.emit("nearCloseButtonClick")})(e,n)};var iA=(e,t)=>n4(e,"click").pipe(n8(t),n3(e=>{var t;return iw(null==(t=e.data)?void 0:t.click_target,ib)}),n5(),is(0)),iI=(...e)=>new n2(t=>{let n=[],i=e=>{var i;t.next(e),null==(i=t.complete)||i.call(t),n.forEach(e=>e())},r=e=>{var n;return null==(n=t.error)?void 0:n.call(t,e)},a=()=>{var e;return null==(e=t.complete)?void 0:e.call(t)};e.forEach(e=>{let{unsubscribe:t}=e.subscribe({next:i,error:r,complete:a});n.push(t)})}),ik=(e=t0(),t=!1)=>{let n=ns(e),i=n9(n4(n,"sceneStart"),n4(n,"sceneEnd")),r=n4(n,"click").pipe(ie(1)),a=it(n4(n,"sceneStart"),r,n4(n,"sceneEnd")),s=ii(n4(n,"closeButtonShow").pipe(ie(1)),n4(n,"sceneEnd"),n4(n,"nearCloseButtonClick")),o=it(n4(n,"closeButtonShow"),n4(n,"closeButtonClick"),n4(n,"sceneEnd")),l=n4(n,"closeButtonShow").pipe(ir(()=>n4(n,"click").pipe(ia(()=>!0))),n8(n4(n,"sceneEnd")),is(!1)),c=((e,t=tR.get(),n=ec,i=eu(),r=tU())=>new n2(a=>{let s=n4(e,"sceneEnd");n4(e,"click").pipe(n8(s)).subscribe({next:()=>{t.isWebViewable()||(n({isViewable:!0},i),r.emit({type:"observability",event:"event",data:{name:"force-viewable",metric:"force-viewable",is_viewable:!1}}))},complete:()=>{var e;null==(e=a.complete)||e.call(a)}})}))(n),d={click_count:iA(n,n4(n,"sceneEnd")),close_button_idle_time:o,duration:i,first_click:a,force_viewable:c,has_interaction_after_close_button_visible:l,near_click_count_after_close_button_appears:s,near_click_count_before_close_button_appears:ii(n4(n,"sceneStart"),iI(n4(n,"closeButtonShow"),n4(n,"sceneEnd")),n4(n,"nearCloseButtonClick"))};t&&(d.last_chance_endcard_duration=it(n4(n,"lastChanceEndcardOpen"),n4(n,"lastChanceEndcardClose"),n4(n,"sceneEnd")),d.has_last_chance_endcard_been_clicked=iI(n4(n,"sceneEnd").pipe(ia(()=>!1)),n4(n,"lastChanceEndcardOpen").pipe(ir(()=>iA(n,n4(n,"lastChanceEndcardClose"))),ia(e=>e>0),is(!1))));return d},iO=(e,t)=>n6(e,"video").pipe(n3(e=>e.event===t)),iD=(e,t)=>{let n=Number(t.incentivizedCloseButtonDelaySeconds);return!t.isIncentiveTiedToCloseButtonDelay||Number.isNaN(n)||n>e?.8*e:.8*n};let iV=["checkpoint.0","checkpoint.25","checkpoint.50","checkpoint.75","checkpoint.100"];var iL=(e,t)=>0===t?0:t-e<=.5?4:Math.floor(e/t*4);let iN=["checkpoint.0","checkpoint.100","checkpoint.25","checkpoint.50","checkpoint.75","clickUrl","postroll.click","postroll.view","video.close","video.length","video.mute","video.unmute","rewardGranted"];var ix=class extends tB{emit(e,t=!1,n){let i=this.createEventToEmit(e);i&&(t&&(i.fireOnlyOnce=!0),n&&(i.data=n),this.wrappedService.emit(i))}createEventToEmit(e){return"string"==typeof e&&iN.includes(e)?{type:"tpat",event:e}:"object"==typeof e?e:void 0}},iP=e=>new ix(null!=e?e:ed());let iR=(e,t,n)=>{let i=iL(e,t),r=ed();4===i&&r.emit({type:"videoViewed",event:"videoReachedDuration",data:{current_time:e,duration:t,seconds:n},fireOnlyOnce:!0})},iM=(e,t,n)=>{let i=ed();i.findAll({where:{type:"videoViewed",event:"progress"}}).some(e=>{var t,i;return(null!=(i=null==(t=e.activity.data)?void 0:t.seconds)?i:0)>=n})||i.emit({type:"videoViewed",event:"progress",data:{current_time:e,duration:t,seconds:n}}),t>0&&e>0&&ed().emit({type:"videoViewed",event:"videoLength",data:{current_time:e,duration:t,seconds:n},fireOnlyOnce:!0}),iR(e,t,n)};var iB=(e,t,n=tG.get(),i=iP())=>{var r,a,s,o;let l=Math.floor(1e3*Math.max(null!=(s=null==(r=t.data)?void 0:r.current_time)?s:0,.1)),c=Math.floor((null!=(o=null==(a=t.data)?void 0:a.duration)?o:0)*1e3);switch(t.event){case"progress":n.notifyEventValuePairEvent("videoViewed",l);break;case"videoReachedDuration":n.notifyEventValuePairEvent("videoViewed",c);break;case"videoLength":n.notifyEventValuePairEvent("videoLength",c),i.emit("video.length",!0)}};let iF=[{currentTime:.1,timeout:0},{currentTime:2,timeout:2e3},{currentTime:3,timeout:1e3},{currentTime:4,timeout:1e3},{currentTime:5,timeout:1e3}],iU=(e,t=H.get(),n=iP())=>{let i=iF[e],r=iF.length-1;t.getNewTimer(i.timeout,()=>{n.emit(["checkpoint.0","checkpoint.25","checkpoint.50","checkpoint.75","checkpoint.100"][Math.floor(i.currentTime/5*4)],!0,{current_time:i.currentTime,duration:5}),iM(i.currentTime,5,Math.round(i.currentTime)),e!==r&&iU(e+1)}).start()};var iH=e=>new n2(t=>{let n=()=>{var e;t.next("forfeitReward"),null==(e=t.complete)||e.call(t)};n6(e,"incentivized-event").pipe(n3(e=>"forfeitReward"===e.event)).subscribe({next:n,error:e=>{var n;return null==(n=t.error)?void 0:n.call(t,e)}}),e.hasExistingEvent({type:"incentivized-event",event:"forfeitReward"})&&n()}),iW=e=>new n2(t=>{if(e.hasExistingEvent({type:"incentivized-event",event:"grantReward"})){var n;t.next("forfeitReward"),null==(n=t.complete)||n.call(t)}}),iG=(e,t,n)=>new n2(i=>{let r=t.getNewTimer(e,()=>{var e;i.next(n),null==(e=i.complete)||e.call(i)});return r.start(),{unsubscribe:()=>{r.destroy()}}}),iK=(e,t)=>({type:"incentivized-event",event:"grantReward",fireOnlyOnce:e,data:{shouldNotifySuccessfulViewAd:t}}),ij=(e,t,n=t0(),i=H.get())=>{let r,a,{shouldNotifySuccessfulViewAd:s,fireOnlyOnce:o}=t,l="video"===e?(r=[iO(n,"error").pipe(ia(()=>"end")),n4(n,"sceneEnd").pipe(ia(()=>"end"))],o&&r.push(iH(n),iW(n)),a=iO(n,"play").pipe(ie(1),ir(e=>iI(iG(1e3*iD(e.data.duration,t),i,"grantReward"),...r))),n4(n,"sceneStart").pipe(ir(()=>iI(a,...r)))):n4(n,"sceneStart").pipe(ir(()=>iI(iG(1e3*iD(5,t),i,"grantReward"),n4(n,"sceneEnd").pipe(ia(()=>"forfeitReward")),iH(n),iW(n))));return new n2(e=>{let t=l.subscribe({next:t=>{var i;if("grantReward"===t){let e=iK(o,s);n.emit(e)}null==(i=e.complete)||i.call(e)},error:t=>{var n;return null==(n=e.error)?void 0:n.call(e,t)}});return{unsubscribe:()=>t.unsubscribe()}})},iY=(e,t)=>n6(e,"theatre-mode-event").pipe(n3(e=>e.event===t));let iq=["EC_IMAGE","EC_IMAGE_2","EC_HTML","ADM_HTML","EC_HTML_2"],iz="scenes-key";var i$=(e=c.getInstance())=>e.get(iz);class iX extends nY{getTransitions(){let e=super.getTransitions();return e.push(nq,nz,n$,nU,nH,nK,nG),e}getId(){return this.id}getSceneType(){return"video"}getSceneIndex(){return this.injectedGetScenes().findIndex(e=>e.getId()===this.getId())}getVideoPlayer(){return"mp4"===this.videoType?"progressive":window.Hls.isSupported()?"custom":"native"}getVideoUrl(){return"mp4"===this.videoType&&void 0!==this.originalVideoUrl?this.originalVideoUrl:this.url}getObservabilityData(){var e,t,n,i,r,a,s,o;let l=new n1(this),c=l.getCachedManifestMetadata();return{scene_id:this.getId(),scene_type:this.getSceneType(),scene_index:this.getSceneIndex(),cached_segments:null!=(a=null==(t=c.video)||null==(e=t.chunks)?void 0:e.filter(nJ).length)?a:0,expected_video_duration:this.expectedVideoDuration,format:l.getChunkFormat(),local:+!this.url.toLowerCase().startsWith("http"),has_first_track:Object.keys(c.video.tracks).length>0,has_manifest:!!(null==(n=c.video)?void 0:n.manifest),player:this.getVideoPlayer(),segments:null!=(s=null==(r=this.getStreamManifest())||null==(i=r.chunks)?void 0:i.length)?s:0,url:null!=(o=this.getVideoUrl())?o:"",video:this.videoType}}getProgressBarConfig(){return this.progressBarConfig}getFullScreenClickConfig(){return this.fullScreenClickConfig}getAppStoreOnDelayConfig(){return this.appStoreOnDelayConfig}getCloseButtonConfig(e){let t=this.closeButtonConfigProvider.getCloseButtonConfig(e);return I(g({},t),{style:this.isLastPage()?nQ.CLOSE:t.style})}getStoreKitOverlayAutoShowConfig(){return this.storeKitOverlayAutoShowConfig}getCallToActionConfig(){return this.callToActionConfig}getLastChanceEndcardConfig(){return this.lastChanceEndcardConfig}getTrackingEventMapConfig(){return this.trackingEventMapConfig}setLastChanceEndcardConfig(e){this.lastChanceEndcardConfig=e}getStreamManifest(){return this.streamManifest}getAudioManifest(){return this.audioManifest}getEventStreams(){return this.eventStreams?this.eventStreams:((e,t=!1,n=t0(),i=H.get())=>{let r,a,s=ns(n),o=n7(n,"resource","video").pipe(n5()).pipe(n8(n4(s,"sceneEnd"))),l=it(n4(s,"loadStart"),n4(s,"loadComplete"),n4(s,"sceneEnd")),c=it(n4(s,"ctaButtonShow"),n4(s,"ctaButtonClick"),n4(s,"sceneEnd")),d=I(g({},ik(n,t)),{average_bandwidth:((e,t,n=t2)=>new n2(i=>{let r=n4(e,"sceneEnd").subscribe({next:()=>{var e;i.next(nD(n,t)),null==(e=i.complete)||e.call(i)}});return{unsubscribe:()=>{r.unsubscribe()}}}))(s,n),cta_duration:c,error_count:o,hls_starting_sequence_number:(r=iO(n,"hlsLevelPlaylistLoaded"),a=n4(s,"sceneEnd"),new n2(e=>{let t=r.subscribe({next:t=>{var n,i;e.next(null==(n=t.data)?void 0:n.starting_sequence_number),null==(i=e.complete)||i.call(e)}}),n=a.subscribe({next:()=>{var t;e.next(void 0),null==(t=e.complete)||t.call(e)}});return{unsubscribe:()=>{t.unsubscribe(),n.unsubscribe()}}})),load_duration:l});return e.enabled&&(d.has_reward_been_granted=ij("video",e,n,i)),d.hide_controls_count=iY(n,"hideControls").pipe(n5()).pipe(n8(n4(s,"sceneEnd"))),d.reveal_controls_count=iY(n,"revealControls").pipe(n5()).pipe(n8(n4(s,"sceneEnd"))),d})(this.incentivizedConfig,this.lastChanceEndcardConfig.enabled)}getIncentivizedConfig(){return this.incentivizedConfig}getOmsdkConfig(){return this.omsdkConfig}getProgressEvents(){return this.progressEvents}getInlineInstallConfig(){return this.inlineInstallConfig}constructor({id:e,url:t,index:n,isAlternative:i,videoType:r,streamManifest:a,audioManifest:s,fullScreenClickConfig:o,storeKitOverlayAutoShowConfig:l,theatreModeEnabled:c,appStoreOnDelayConfig:d,callToActionConfig:u,lastChanceEndcardConfig:h,progressBarConfig:v,closeButtonConfigProvider:p,originalVideoUrl:g,trackingEventMapConfig:m,showDownloadButton:f,loopVideo:S=0,muted:y=!1,isFullscreen:C,shouldSplitVideoEndcardClick:E=!1,eventStreams:_,incentivizedConfig:b,expectedVideoDuration:w,omsdkConfig:T,privacyUrl:A,injectedGetScenes:I=i$,progressEvents:k,shouldFireTpat:O=!0,appStoreId:D,inlineInstallConfig:V}){super({isFullscreen:C}),this.id=e,this.url=t,this.index=n,this.alternative=i,this.videoType=r,this.streamManifest=a,this.audioManifest=s,this.progressBarConfig=v,this.fullScreenClickConfig=o,this.storeKitOverlayAutoShowConfig=l,this.appStoreOnDelayConfig=d,this.callToActionConfig=u,this.showDownloadButton=f,this.lastChanceEndcardConfig=h,this.theatreModeEnabled=c,this.closeButtonConfigProvider=p,this.originalVideoUrl=g,this.loopVideo=S,this.muted=y,this.trackingEventMapConfig=m,this.shouldSplitVideoEndcardClick=E,this.eventStreams=_,this.incentivizedConfig=b,this.expectedVideoDuration=w,this.omsdkConfig=T,this.privacyUrl=A,this.injectedGetScenes=I,this.progressEvents=k,this.shouldFireTpat=O,this.inlineInstallConfig=V,this.appStoreId=D,this.addEntryAction({name:"postrollView"}),this.addTransition({name:"NEXT",actions:[{name:"closeVideo"},{name:"setTheatreModeInactive"},{name:"disableTheatreMode"}]}),this.addExitAction({name:"finishVideoOmsdkSession"})}}iX.isVideoOnly=(e=h.get())=>{let t=!e.some(...iq),n=1===["MAIN_VIDEO","MAIN_STREAM"].filter(t=>e.has(t)).length;return t&&n};var iQ=function(e){return e instanceof iX&&["mp4","hls"].includes(e.videoType)&&"object"==typeof e.progressBarConfig&&"object"==typeof e.fullScreenClickConfig&&"object"==typeof e.storeKitOverlayAutoShowConfig&&"object"==typeof e.appStoreOnDelayConfig&&"object"==typeof e.callToActionConfig&&"object"==typeof e.lastChanceEndcardConfig&&"object"==typeof e.trackingEventMapConfig&&(void 0===e.originalVideoUrl||!0)&&(void 0===e.loopVideo||!0)},iZ=e=>iI(n4(e,"sceneEnd"),n4(e,"lastChanceEndcardOpen")),iJ=(e,t)=>new n2(n=>{let i=n4(e,"closeWillAppear").subscribe({next:()=>{t.triggerEvent("closeButtonWillShow"),t.removeEventListener("closeButtonWillShow")}});return iZ(e).subscribe({next:()=>{var e;null==(e=n.complete)||e.call(n)}}),{unsubscribe:()=>{i.unsubscribe()}}}),i0=(e,t)=>new n2(n=>{let i=n4(e,"sizeChange").subscribe({next:()=>{t.triggerEvent("sizeChange",window.innerWidth,window.innerHeight)}});return iZ(e).subscribe({next:()=>{var e;null==(e=n.complete)||e.call(n)}}),{unsubscribe:()=>{i.unsubscribe()}}}),i1=(e,t)=>n6(e,"viewability").pipe(n3(e=>e.event===t||!t)),i2=(e,t,n,i)=>new n2(r=>{let a=i1(t).subscribe({next:()=>{n.triggerEvent("viewableChange",i.isViewable())}});return iZ(e).subscribe({next:()=>{var e;null==(e=r.complete)||e.call(r)}}),{unsubscribe:()=>{a.unsubscribe()}}}),i3=(e,t)=>new n2(n=>{iZ(e).subscribe({next:()=>{var e;t.flushAllEventCallbacks(),null==(e=n.complete)||e.call(n)}})});let i6=["sizeChange","viewableChange","closeButtonWillShow"];class i4 extends d{getEventCallbacks(e){return this.callbacks[e]=this.callbacks[e]||[],[...this.callbacks[e]]}updateEventCallbacks(e,t){this.callbacks[e]=t}addEventListener(e,t){if(!this.allowedMraidEvents.includes(e))return;let n=this.getEventCallbacks(e);this.updateEventCallbacks(e,[...n,t])}removeEventListener(e,t){if(this.allowedMraidEvents.includes(e))if(t){let n=this.getEventCallbacks(e).filter(e=>e!==t);this.updateEventCallbacks(e,n)}else this.updateEventCallbacks(e,[])}flushAllEventCallbacks(){this.callbacks&&Object.keys(this.callbacks).forEach(e=>{this.updateEventCallbacks(e,[])})}triggerEvent(e,...t){this.getEventCallbacks(e).forEach(e=>{e(...t)})}constructor(e=i6){super(),this.allowedMraidEvents=e,this.callbacks={}}}i4.identifier=new o;var i7=i4,i5=class extends nY{getTransitions(){let e=super.getTransitions();return e.push(nq,nz,n$,nU,nH),e}getId(){return this.id}getHtml(){return this.html}getDecodedHtml(){return this.htmlDecoderService.decode(this.getHtml())}getSceneType(){return this.sceneType}getSceneIndex(){return this.injectedGetScenes().findIndex(e=>e.getId()===this.getId())}getObservabilityData(){return{scene_id:this.getId(),scene_type:this.getSceneType(),scene_index:this.getSceneIndex()}}addChildScenes(e){this.childScenes.push(...e)}getChildScenes(){return this.childScenes}getChildSceneById(e){return this.childScenes.find(t=>t.getId()===e)}getCloseButtonConfig(){let e=this.closeButtonConfigProvider.getCloseButtonConfig();return I(g({},e),{style:this.isLastPage()?nQ.CLOSE:e.style})}getLastChanceEndcardConfig(){return this.lastChanceEndcardConfig}setLastChanceEndcardConfig(e){this.lastChanceEndcardConfig=e}getEventStreams(){return this.eventStreams?this.eventStreams:((e=t0(),t=i7.get(),n=tR.get(),i=eh())=>{let r=ns(e);return{duration:n9(n4(r,"sceneStart"),n4(r,"sceneEnd")),viewable_change:i2(r,i,t,n),size_change:i0(r,t),close_will_appear:iJ(r,t),flush_mraid_events:i3(r,t)}})()}constructor({id:e,html:t,children:n,closeButtonConfigProvider:i,lastChanceEndcardConfig:r,htmlDecoderService:a=nS.get(),eventStreams:s,adData:o=eo.getValue(),injectedGetScenes:l=i$}){super({isFullscreen:o.placement.is.fullscreen}),this.childScenes=[],this.id=e,this.html=t,this.children=n,this.closeButtonConfigProvider=i,this.lastChanceEndcardConfig=r,this.htmlDecoderService=a,this.sceneType="composite",this.eventStreams=s,this.injectedGetScenes=l,this.addEntryAction({name:"initCheckpoints"})}},i8=function(e){return e instanceof i5&&"composite"===e.getSceneType()},i9=()=>{let e=t2.getValue().scene;return iQ(e)?e:i8(e)?e.getChildScenes().filter(iQ):[]},re=(e=j.get(),t=i9)=>{let n=t();return(Array.isArray(n)?n:[n]).reduce((t,n)=>{let i=e.interpreterMap.get(n.getId());return i&&t.push(i),t},[])};let rt=({sceneId:e,eventName:t,precedingEventName:n,reportingService:i},r=!1)=>{let a,s=i.findAll({where:{type:"scene-event",event:t,data:{scene_id:e}}});if(n){let t=i.findAll({where:{type:"scene-event",event:n,data:{scene_id:e}}})[0];if(!t)return[];a=t.timestamp;let o=s.filter(e=>e.timestamp>a);return r?o:o[0]?[o[0]]:[]}return r?s:s[0]?[s[0]]:[]},rn=e=>e.reduce((e,[t,n])=>e+(n.timestamp-t.timestamp),0),ri=({sceneId:e,eventName:t,precedingEventName:n,reportingService:i=ns()})=>{let r=(({sceneId:e,eventName:t,precedingEventName:n,reportingService:i=ns()})=>{var r,a;let s,o=null!=(a=null==(r=(s=rt({sceneId:e,eventName:t,precedingEventName:n,reportingService:i},!1)).length>0?s[0]:null)?void 0:r.timestamp)?a:null;if(null===o)return;let l=rn(i.findAllActivityEventPairs("viewability","minimized","maximized").filter(e=>e[0].timestamp>o)),c=rn(i.findAllActivityEventPairs("store-kit-product-view","appStoreOpen","appStoreClose").filter(e=>e[0].timestamp>o)),d=Date.now()-o;return{sceneEventTimestamp:o,elapsedTimeSinceEvent:d,backgroundDuration:l,appStoreDuration:c}})({sceneId:e,eventName:t,precedingEventName:n,reportingService:i});if(void 0===r)return;let{elapsedTimeSinceEvent:a,appStoreDuration:s,backgroundDuration:o}=r;return a-o+s};var rr=z({isLastChanceEndcardOverlayShowing:!1},"LastChanceEndcardOverlayContext");let ra=e=>e?"lastChanceEndcardOpen":void 0,rs=({coordinates:e,clickTarget:t,targetElement:n})=>(null==n?void 0:n.contains(t))||t.contains(n)?0:((e,t,n)=>{if(!n)return;let i=n.getBoundingClientRect(),r=Math.max(i.left-e,0,e-i.right),a=Math.max(i.top-t,0,t-i.bottom);return parseInt(`${Math.sqrt(r*r+a*a)}`,10)})(e.x,e.y,n),ro=()=>({nextButton:document.querySelector(`#${ig}, #${iS}`),closeButton:document.querySelector(`#${iv}`),ctaButton:document.querySelector(`[title="${il}"], #${im}, [data-id="${io}"]`),privacyButton:document.querySelector(`#${iC}`),muteButton:document.querySelector(`[data-id="${id}"]`),countdown:document.querySelector(`#${ip}`)});class rl extends d{setupEventHandlers(){this.injectedSceneEventReportingService.addEventHandler("scene-event",((e,t,n=t2)=>(i,r)=>{let a=(e=>{let{data:t}=e;return{sceneId:t.scene_id,coordinates:t.click_coordinates,clickTarget:t.click_target,eventName:e.event}})(r);if((e=>{let{eventName:t,sceneId:n,coordinates:i,clickTarget:r}=e;return"click"===t&&!!n&&!!i&&!!r})(a)){let t=n.getValue().scene;t&&e({currentScene:t,coordinates:a.coordinates,clickTarget:a.clickTarget,lastChanceEndcardVisible:rr.getValue().isLastChanceEndcardOverlayShowing})}["sceneStart","lastChanceEndcardOpen"].includes(a.eventName)&&t()})(this.collectClickMetrics.bind(this),this.resetSceneClickIndex.bind(this),this.sceneContext))}resetSceneClickIndex(){this.sceneClickIndex=void 0}updateGlobalMetrics(){var e,t;this.clickIndex=(null!=(e=this.clickIndex)?e:-1)+1,this.sceneClickIndex=(null!=(t=this.sceneClickIndex)?t:-1)+1}async collectClickMetrics({currentScene:e,coordinates:t,clickTarget:n,lastChanceEndcardVisible:i}){var r,a,s,o;let l,c,d,u={sceneId:e.getId(),lastChanceEndcardVisible:i,reportingService:this.injectedSceneEventReportingService};this.updateGlobalMetrics();let h=I(g({clickX:parseInt(String(t.x),10),clickY:parseInt(String(t.y),10),width:window.innerWidth,height:window.innerHeight,clickIndex:this.clickIndex,sceneClickIndex:this.sceneClickIndex},(({coordinates:e,clickTarget:t,lastChanceEndcardVisible:n})=>{let i=ro();return{closeDistance:rs({coordinates:e,clickTarget:t,targetElement:i.nextButton}),ctaDistance:rs({coordinates:e,clickTarget:t,targetElement:i.ctaButton}),privacyDistance:rs({coordinates:e,clickTarget:t,targetElement:i.privacyButton}),muteDistance:n?void 0:rs({coordinates:e,clickTarget:t,targetElement:i.muteButton})}})({coordinates:t,clickTarget:n,lastChanceEndcardVisible:i})),{sceneElapsedDuration:(({sceneId:e,lastChanceEndcardVisible:t,reportingService:n})=>ri({sceneId:e,eventName:t?"lastChanceEndcardOpen":"sceneStart",reportingService:n}))(u),closeCountdown:i?null==(a=e.getLastChanceEndcardConfig)||null==(r=a.call(e).close)?void 0:r.countdown:null==(s=e.getCloseButtonConfig)?void 0:s.call(e,{}).countdown,closeButtonTimeStamp:(e=>{if(!ro().closeButton)return parseInt(`${(({sceneId:e,lastChanceEndcardVisible:t,reportingService:n})=>{let i,r=0===(i=rt({sceneId:e,eventName:"nextButtonCountdownTick",precedingEventName:ra(t),reportingService:n},!0)).length?null:i[i.length-1];if(!r)return 0;let a=Date.now()-r.timestamp,s=1e3*r.activity.data.delay;return a<=1e3?-(s-a):-s})(e)}`,10);let{sceneId:t,lastChanceEndcardVisible:n,reportingService:i}=e;return ri({sceneId:t,eventName:"closeButtonShow",precedingEventName:ra(n),reportingService:i})})(u),minimumView:(({sceneId:e,lastChanceEndcardVisible:t,reportingService:n})=>{var i;let r,a=0===(r=rt({sceneId:e,eventName:"nextButtonCountdownTick",precedingEventName:ra(t),reportingService:n},!0)).length?null:r[0];return parseInt(`${(null!=(i=null==a?void 0:a.activity.data.delay)?i:0)*1e3}`,10)})(u),videoTimeStamp:i?void 0:void 0!==(l=null==(o=(0,this.injectedGetAllVideoInterpretersInCurrentScene)()[0])?void 0:o.state.context.currentTime)?parseInt(`${1e3*l}`,10):void 0,mmp:await (c=this.injectedTpatReportingService,d=this.injectedTimerService,new Promise(e=>{let t=n6(c,"tpat").pipe(n3(e=>["postroll.click","clickUrl"].includes(e.event)),ia(()=>!0));iI(iG(200,d,!1),t).subscribe({next:t=>{e(t)},error:()=>e(!1),complete:()=>e(!1)})}))});this.injectedObservabilityEventReportingService.emit({type:"observability",event:"event",data:g({scene_id:e.getId(),scene_type:i?"lcec":e.getSceneType(),name:"click-metrics"},this.mapClickMetricsForObservability(h))})}mapClickMetricsForObservability(e){return{click_index:e.clickIndex,click_x:e.clickX,click_y:e.clickY,close_button_timestamp:e.closeButtonTimeStamp,is_close_countdown_visible:e.closeCountdown,close_distance:e.closeDistance,cta_distance:e.ctaDistance,height:e.height,minimum_view:e.minimumView,is_mmp_click:e.mmp,mute_distance:e.muteDistance,privacy_distance:e.privacyDistance,scene_click_index:e.sceneClickIndex,scene_elapsed_duration:e.sceneElapsedDuration,video_timestamp:e.videoTimeStamp,width:e.width}}constructor({injectedGetAllVideoInterpretersInCurrentScene:e=re,injectedSceneEventReportingService:t=ns(),injectedObservabilityEventReportingService:n=tU(),sceneContext:i=t2,injectedTpatReportingService:r=iP(),injectedTimerService:a=H.get()}={}){super(),this.injectedGetAllVideoInterpretersInCurrentScene=e,this.injectedSceneEventReportingService=t,this.injectedObservabilityEventReportingService=n,this.sceneContext=i,this.injectedTpatReportingService=r,this.injectedTimerService=a,this.clickIndex=void 0,this.sceneClickIndex=void 0,this.setupEventHandlers()}}rl.identifier=new o;class rc extends d{constructor(...e){super(...e),this.cachedConfig=new Map}}rc.identifier=new o;var rd=rc,ru=(e,t)=>n6(t,"mraid-event").pipe(n3(t=>t.event===e)),rh=(e,t)=>n6(e,"observability").pipe(n3(e=>{let{data:n}=e;return null!=n&&(Array.isArray(n)?n.some(e=>e.name===t):n.name===t)})),rv=(...e)=>new n2(t=>{var n;e.forEach(e=>t.next(e)),null==(n=t.complete)||n.call(t)});let rp=(e,t=t5.get())=>{t.pushEvent({name:"ad-viewable",metric:"ad-viewable",elapsed:Date.now()-e}),((e=H.get(),t=t0(),n=tU(),i=1e4,r=rh)=>{r(n,"ad-start").pipe(ir(()=>n6(t,"*").pipe(function(e,t=H.get()){return n=>new n2(i=>{let r,a=()=>{r&&(r.destroy(),r=void 0)},s=n.subscribe({next:n=>{a(),(r=t.getNewTimer(e,()=>{i.next(n),r=void 0})).start()},error:e=>{var t;a(),null==(t=i.error)||t.call(i,e)},complete:()=>{var e;a(),null==(e=i.complete)||e.call(i)}});return{unsubscribe:()=>{a(),s.unsubscribe()}}})}(i,e),n8(iI(n6(t,"inactivity"),r(n,"ad-close")))))).subscribe({next:()=>{t.emit({type:"inactivity",event:"inactivity",fireOnlyOnce:!0})},error:e=>{t.emit({type:"error-logging",event:"exception",data:{error:e}})},complete:()=>{}})})()};var rg=0;function rm(e,t,n,i,r,a){t||(t={});var s,o,l=t;if("ref"in l)for(o in l={},t)"ref"==o?s=t[o]:l[o]=t[o];var c={type:e,props:l,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--rg,__i:-1,__u:0,__source:r,__self:a};if("function"==typeof e&&(s=e.defaultProps))for(o in s)void 0===l[o]&&(l[o]=s[o]);return Q.vnode&&Q.vnode(c),c}var rf=(e,t=j.get())=>{if(e)return t.interpreterMap.get(e)};let rS={},ry=()=>{window.omidBridge&&Object.entries(rS).forEach(([e,t])=>{var n;"function"==typeof(null==(n=window.omidBridge)?void 0:n[e])&&window.omidBridge[e](...t)})};var rC=class extends d{init(e,t){var n,i;if(this.omidSessionClient=null==(n=window.OmidSessionClient)?void 0:n.default,!this.omidSessionClient)return;let{AdSession:r,Partner:a,Context:s,VerificationScriptResource:o,AdEvents:l,MediaEvents:c}=this.omidSessionClient;this.createVerificationResources(o,t),this.createAdSession(r,a,s,e),(null==(i=this.adSession)?void 0:i.isSupported())&&(this.adEvents=new l(this.adSession),this.mediaEvents=new c(this.adSession))}createVerificationResources(e,t){(null==t?void 0:t.length)&&(this.verificationScriptResources=t.map(t=>new e(t.vendorURL,t.vendorKey,t.params)))}createAdSession(e,t,n,i){let r=eo.getValue().sdk.version;this.partner=new t(this.vungleData.partnerName,r||this.vungleData.partnerVersion),this.context=new n(this.partner,this.verificationScriptResources),i&&this.context.setVideoElement(i),this.adSession=new e(this.context)}eventDrain(){this.funcsOnImpression.forEach(e=>{e()}),this.funcsOnImpression=[]}pushOrCallFunction(e){this.hasSessionStarted?e():this.funcsOnImpression.push(e)}onSessionChange(e){var t;let n={sessionStart:()=>{this.hasSDKRequestedSessionStart=!0,this.onSessionStarted()},sessionFinish:()=>{var e;null==(e=window.omidBridge)||e.finishSession()}};null==(t=n[e.type])||t.call(n)}onCtaClick(){this.pushOrCallFunction(()=>{var e;null==(e=this.mediaEvents)||e.adUserInteraction("click")})}startSession(){var e;let t=rS.startSession;t&&(null==(e=window.omidBridge)||e.startSession(...t))}configureAdSession(e){this.adSession&&(this.adSession.setCreativeType(e),this.adSession.setImpressionType("loaded"),this.adSession.registerSessionObserver(this.onSessionChange.bind(this)))}reportInitError(e){this.reportingService.emit({type:"error-logging",event:"exception",data:{error:{message:`Unable to init omsdk ${e}`}}})}constructor(e){super(),this.reportingService=e,this.vungleData={partnerName:"Vungle",partnerVersion:"1.0"},this.hasSDKRequestedSessionStart=!1,this.hasSessionStarted=!1,this.funcsOnImpression=[]}},rE=(e,t,n,i=t2)=>{var r;let a=i.getValue().scene;if(!t||!iQ(a))return!0;let s=null!=(r=null!=n?n:a.getCloseButtonConfig().delay)?r:0;return 9999===s||s>e};class r_ extends rC{onSessionStarted(){!this.hasSDKRequestedSessionStart||!this.duration||this.hasSessionStarted||this.adEvents&&this.omidSessionClient&&(this.hasSessionStarted=!0,this.adEvents.impressionOccurred(),this.isSkippable=!rE(this.duration,this.adData.placement.is.fullscreen),this.vastProperties=new this.omidSessionClient.VastProperties(this.isSkippable,0,!0,"preroll"),this.adEvents.loaded(this.vastProperties),this.eventDrain())}onVideoCheckpoint(){let{currentTime:e,duration:t,muted:n}=this.videoElement;this.pushOrCallFunction(()=>{if(this.isBuffering){var i;this.isBuffering=!1,null==(i=this.mediaEvents)||i.bufferFinish()}let r=iL(e,t);if(e>0&&this.mediaEvents){let e=this.checkpointsReached.length;for(let i=e;i<=r;i+=1)switch(this.checkpointsReached[i]=!0,i){case 0:this.volume=+!n,this.mediaEvents.start(t,this.volume);break;case 1:this.mediaEvents.firstQuartile();break;case 2:this.mediaEvents.midpoint();break;case 3:this.mediaEvents.thirdQuartile();break;case 4:this.mediaEvents.complete()}}})}onVideoTimeUpdate(){this.onSessionStarted()}onSoundChange(e){this.pushOrCallFunction(()=>{var t;this.volume=+("mute"!==e),null==(t=this.mediaEvents)||t.volumeChange(this.volume)})}onVideoBuffering(){this.isBuffering||(this.pushOrCallFunction(()=>{var e;null==(e=this.mediaEvents)||e.bufferStart()}),this.isBuffering=!0)}onVideoStateChanged(e){this.pushOrCallFunction(()=>{var t,n;if(this.checkpointsReached[0]){if("pause"===e){null==(n=this.mediaEvents)||n.pause();return}null==(t=this.mediaEvents)||t.resume()}})}onVideoDisplayState(e){let{duration:t}=this.videoElement;!this.isVideoReady&&t>0&&(this.isVideoReady=!0,this.pushOrCallFunction(()=>{var t;null==(t=this.mediaEvents)||t.playerStateChange(e)}))}onVideoMetadataAvailable(e){this.duration=e,this.onSessionStarted()}onVideoPageClose(){this.pushOrCallFunction(()=>{var e;this.isSkippable&&(null==(e=this.mediaEvents)||e.skipped())})}constructor(e,t,n=eo.getValue(),i=ed()){super(i),this.videoElement=e,this.omsdkData=t,this.adData=n,this.reportingService=i,this.checkpointsReached=[],this.volume=0,this.vastProperties=null,this.isBuffering=!1,this.isSkippable=!1,this.isVideoReady=!1,this.videoElement=e;try{super.init(this.videoElement,this.omsdkData),this.configureAdSession("video"),this.startSession()}catch(e){this.reportInitError("video")}}}r_.identifier=new o;var rb=r_,rw=e=>({standbyTimers:()=>{(e||H.get()).standby()},wakeTimers:()=>{(e||H.get()).wake()}}),rT=(e=H.get(),t=t0())=>{e.destroyAll(),t.emit({type:"picture-in-picture",event:"close",fireOnlyOnce:!0}),t.emit({type:"close",event:"CLOSE_AD",fireOnlyOnce:!0})},rA=class extends d{open(){this.interpreter.send({type:"SHOW"})}close(){this.interpreter.send({type:"HIDE"})}isOpen(){var e;return null!=(e=this.interpreter.state.matches("SHOWING"))&&e}constructor(e,t={},n=j.get()){super(),this.machineConfig=e,this.machineOptions=t,this.stateMachineService=n;let i=this.stateMachineService.createMachine(this.machineConfig,this.machineOptions);this.interpreter=this.stateMachineService.interpret(i),this.interpreter.start()}};let rI=e=>({id:e,initial:"HIDDEN",states:{SHOWING:{on:{HIDE:{target:"HIDDEN",actions:"onDialogHide"}}},HIDDEN:{on:{SHOW:{target:"SHOWING",actions:"onDialogShow"}}}}}),rk=(e=tR.get(),t=eh())=>({actions:{onDialogShow:()=>{e.setInternalViewable(!1),t.emit({type:"viewability",event:"internal-minimized"})},onDialogHide:()=>{e.setInternalViewable(!0),t.emit({type:"viewability",event:"internal-maximized"})}}});class rO extends rA{consentAction(e){this.mraidService.consentAction(e),this.close()}constructor(e=j.get(),t=tG.get(),n=tR.get(),i=eh()){super(rI(i_),rk(n,i),e),this.stateMachineService=e,this.mraidService=t,this.viewableService=n,this.viewabilityReportingService=i}}rO.identifier=new o;var rD=rO,rV=new o,rL=new o,rN=e=>({pauseAllIntervals:()=>{(e||tY.get()).pauseAll()},startAllIntervals:()=>{(e||tY.get()).startAll()}});class rx extends Error{constructor(e){super(e),this.name="FrameRateMeasurementError"}}var rP=(e={})=>{let{duration:t=1e3,onFrame:n}=e;return new Promise((e,i)=>{let r=0,a=null,s=performance.now(),o=s,l=c=>{r++;let d=c-s;if(c-o>500&&r>1){null!==a&&cancelAnimationFrame(a),i(new rx("Page was backgrounded during measurement"));return}o=c,n&&n(r,d),d<t?a=requestAnimationFrame(l):e(Math.round(r/(c-s)*1e3))};a=requestAnimationFrame(l),setTimeout(()=>{null!==a&&(cancelAnimationFrame(a),i(new rx("Measurement timeout")))},t+1e3)})};let rR=(e,t)=>`${e}__${t}`;var rM=(e,t,n=t6(t4))=>{var i,r;if(!(null==(i=t.data)?void 0:i.trackingEventMapConfig.enabled))return;let a=t.event.split("__").at(-1),s=null==(r=t.data)?void 0:r.trackingEventMapConfig.events;if(!(null==s?void 0:s[a]))return;let o=s[a];null==o||o.forEach(e=>{n.get(e)})},rB=()=>ed(),rF=(e,t,n,i=!1,r=rB())=>{if(!t||!n||!n.enabled)return;let a=n.events;if(!(null==a?void 0:a[e]))return;let s=rR(t,e);r.emit({type:"tracking-event",event:s,fireOnlyOnce:i,data:{trackingEventMapConfig:n}})};class rU extends rC{onSessionStarted(){!this.hasSDKRequestedSessionStart||this.hasSessionStarted||this.adEvents&&(this.hasSessionStarted=!0,this.adEvents.impressionOccurred(),this.adEvents.loaded(null),this.eventDrain())}constructor(e=ed()){super(e),this.reportingService=e;try{super.init(),this.configureAdSession("htmlDisplay"),this.startSession()}catch(e){this.reportInitError("htmlDisplay")}}}rU.identifier=new o;class rH extends d{isUserInterestedInEndcard(e){return e&&e.length>=10&&e.filter(e=>{var t;return(null!=(t=e.endcardInteractions)?t:0)>=2}).length>=3}calculateAmplifyValue(e){let t=Math.max(0,e-this.amplifyValue);return 0===t&&(this.amplifyValue=e),t}async getVideoCloseButtonDelayWithUserActivity(e){let t=null!=e?e:0,n=(await this.userActivityService.getAllRecords()).filter(e=>e.eventId!==this.sessionId&&("fullscreen"===e.placementType||!e.placementType));return this.isUserInterestedInEndcard(n)?(this.amplified=!0,this.calculateAmplifyValue(t)):t}isEndcardAmplified(){return this.amplified}getAmplifiedEndcardCloseButtonDelay(e){return(null!=e?e:0)+this.amplifyValue}constructor(e,t){super(),this.sessionId=e,this.userActivityService=t,this.amplified=!1,this.amplifyValue=2}}rH.identifier=new o;var rW=rH;let rG="last-chance-endcard",rK={actions:{onLastChanceEndcardShow:()=>{let e=ns(),t=tU();e.emit("lastChanceEndcardOpen"),t.emit("scene-start","last-chance-endcard-scene-start")},onLastChanceEndcardHide:()=>{ns().emit("lastChanceEndcardClose")}}};var rj=(e,t)=>{let n=null!=t?t:j.get(),i=null!=e?`${rG}-${e}`:rG;return n.interpreterMap.get(i)},rY=(e=h.get())=>({isPrivacyButtonVisible:!1,isPrivacyDrawerOpen:!1,shouldRenderIFrame:!0,shouldRenderPictureInPicture:!1,allowDebug:e.has("IS_RUNNING_INSIDE_EMBED")||e.has("IS_STAFF_DEVICE_BID"),globalTimer:0,isTheatreModeActive:!1}),rq=class{convertScene(e){let t=e.getTransitions(),n=e.getDelayedTransitions(),i={[e.getId()]:{entry:[],exit:[],on:{}}};for(let t of e.getEntryActions())i[e.getId()].entry.push(t.name);for(let t of e.getExitActions())i[e.getId()].exit.push(t.name);for(let n of t){let t=n.actions.map(e=>e.name),{cond:r}=n;n.scene?i[e.getId()].on[n.name]={actions:t,target:n.scene.getId(),cond:r}:i[e.getId()].on[n.name]={actions:t,cond:r}}if(n.length>0){i[e.getId()].after={};let t={};for(let e of n){var r;let n=String(e.delay),i={};(null==(r=e.actions)?void 0:r.length)&&(i.actions=e.actions.map(e=>e.name)),e.scene&&(i.target=e.scene.getId()),e.cond&&(i.cond=e.cond),t[n]||(t[n]=[]),t[n].push(i)}for(let[n,r]of Object.entries(t))i[e.getId()].after[n]=1===r.length?r[0]:r}return this.removeFalsyValues(i)}convertScenes(e){let t={};for(let n of e)Object.assign(t,this.convertScene(n));return t}removeFalsyValues(e){for(let t of Object.keys(e))e[t]&&"object"==typeof e[t]?(this.removeFalsyValues(e[t]),0===Object.keys(e[t]).length&&delete e[t]):e[t]||delete e[t];return e}},rz=class{parseAdExperienceData(e){try{let t=nm(e);return JSON.parse(t)}catch(e){this.reportingService.emit({type:"free-form",event:"decodingError"})}}getAdExperience(){var e,t;if(!this.adExperienceCache){let t=null!=(e=this.tokenService.get("AD_EXPERIENCE"))?e:"";this.adExperienceCache=this.parseAdExperienceData(t)}return null!=(t=this.adExperienceCache)?t:this.getDefaultAdExperience()}getDefaultAdExperience(){return{statemachine:{id:"ad",initial:"closed",states:{}}}}getAdMachineConfig(){let{statemachine:e}=this.getAdExperience();return I(g({},e),{id:"ad"})}getSceneData(){let{statemachine:e,components:t}=this.getAdExperience();return t?Object.entries(t).map(([e,t])=>I(g({},t),{id:e})):Object.entries(e.states||{}).map(([e,t])=>I(g({},t.meta),{id:e}))}constructor(e=h.get(),t=ed()){this.tokenService=e,this.reportingService=t}},r$=(e=j.get())=>e.interpret(((e=j.get())=>{let t=e.machineMap.get("ad");if(t)return t.machine;let[n,i]=((e=h.get())=>{let t;if(e.has("AD_EXPERIENCE"))t=((e=new rz,t=i$())=>{let n=e.getAdMachineConfig();return n.states=n.states||{},t.forEach(e=>{let t=e.getId();n.states[t]=n.states[t]||{on:{},entry:[],exit:[]},e.getTransitions().forEach(e=>{if(n.states[t].on){var i,r;let a=e.name,s=null==(i=e.scene)?void 0:i.getId(),o=n.states[t].on[a],l={actions:Array.from(new Set([...Array.from(null!=(r=null==o?void 0:o.actions)?r:[]),...e.actions.map(e=>e.name)])),cond:(null==o?void 0:o.cond)?o.cond:e.cond};s&&(l.target=s),n.states[t].on[a]=g({},null!=o?o:{},l)}}),n.states[t].entry||(n.states[t].entry=[]),n.states[t].entry.push(...e.getEntryActions().map(e=>e.name)),n.states[t].exit||(n.states[t].exit=[]),n.states[t].exit.push(...e.getExitActions().map(e=>e.name));let i=e=>{var t;return g({},(null==(t=e.actions)?void 0:t.length)&&{actions:e.actions.map(e=>e.name)},e.scene&&{target:e.scene.getId()},e.cond&&{cond:e.cond})},r=e.getDelayedTransitions();if(r.length>0){var a;null!=(a=n.states[t]).after||(a.after={});let e={};for(let t of r){let n=String(t.delay),r=i(t);null!=e[n]||(e[n]=[]),e[n].push(r)}for(let[i,r]of Object.entries(e))n.states[t].after[i]=1===r.length?r[0]:r}}),I(g({},n),{context:g({},rY(),n.context)})})();else{let e,n,i;e=new rq,n=i$(),i=e.convertScenes(n),t={id:"ad",initial:n[0].getId(),states:i,context:rY()}}let n={actions:g({},g({},((e=t0(),t=eo.getValue(),n=rT,i=()=>t3(rV),r=()=>rD.getIfExists())=>({closeAd:()=>{n()},setTheatreModeActive:K({isTheatreModeActive:!0}),setTheatreModeInactive:K({isTheatreModeActive:!1}),closeStoreKitOverlay:()=>{var e;null==(e=i())||e.close()},ensureRewardGranted:()=>{if(!t.placement.is.rewarded||e.hasExistingEvent({type:"incentivized-event",event:"forfeitReward"})||e.findAll({where:{type:"incentivized-event",event:"grantReward",data:{shouldNotifySuccessfulViewAd:!0}}}).length>0)return;let n=iK(!1,!0);e.emit(n)},showGdpr:()=>{var e;null==(e=r())||e.open()}}))(),((e=eo.getValue(),t=tU(),n=tG.get(),i=tR.get(),r=eh(),a=t2)=>({setPrivacyButtonVisible:K({isPrivacyButtonVisible:!0}),setPrivacyButtonHidden:K({isPrivacyButtonVisible:!1}),openPrivacyUrl:()=>{t.emit("privacy-cta","privacy-cta");let{scene:i}=a.getValue(),r=iQ(i)&&i.privacyUrl||e.platform.privacyUrl;n.openPrivacy(r)},setPrivacyDrawerOpen:K({isPrivacyDrawerOpen:!0}),setPrivacyDrawerClosed:K({isPrivacyDrawerOpen:!1}),triggerInternalViewableChange:e=>{i.setInternalViewable(!e.isPrivacyDrawerOpen),r.emit({type:"viewability",event:e.isPrivacyDrawerOpen?"internal-minimized":"internal-maximized"})}}))(),((e=re,t=()=>rb.getIfExists(),n=nI.get(),i=t2)=>({muteSound:()=>{tx.get().setMutedSignal(!0)},unMuteSound:()=>{tx.get().setMutedSignal(!1)},emitMuted:()=>{let e=nk(),t=tx.get();e.emit({type:"video",event:t.isMuted()?"mute":"unmute"})},emitVideoError:(e,t)=>{nk().emit({type:"video",event:"error",data:t})},closeVideo:()=>{e().forEach(e=>{e.send({type:"CLOSE"})})},closeVideoCurrentScene:()=>{e().forEach(e=>{e.send({type:"CLOSE"})})},fireImpression:()=>{iP().emit("checkpoint.0",!0)},postrollView:()=>{iP().emit("postroll.view",!0)},sendEventVideoSkipToNextScene:()=>{tU().emit("video-skip-to-endcard","video-skip-to-endcard")},setPictureInPictureVideoContext:()=>{let e=i.getValue().scene,t=rf(e.getId()),r=null==t?void 0:t.state.context.videoElement;n.setVideoContext(e,r,t)},showPictureInPicture:K({shouldRenderPictureInPicture:()=>!0}),closePictureInPicture:K({shouldRenderPictureInPicture:()=>!1}),sendFatalVideoError:()=>{let e=ne.get(),t=i.getValue().scene,n={type:"error-logging",event:"resource",data:{error:Error(t$),error_source:"resource",is_fatal:!0,resource_type:"video",resource_url:null==t?void 0:t.url}};e.send(n)},disableTheatreMode:()=>{nO().emit({type:"theatre-mode-event",event:"disableTheatreMode"})},finishVideoOmsdkSession:()=>{var e;null==(e=t())||e.onSessionChange({type:"sessionFinish"})}}))(),((e=t3(rV))=>({closeOverlayView:()=>{(null==e?void 0:e.isOpen())&&(null==e||e.close())},interruptOverlayView:()=>{(null==e?void 0:e.isOpen())&&(null==e||e.interrupt())},resumeOverlayView:()=>{(null==e?void 0:e.isInterrupted())&&(null==e||e.resume())},showOverlayView:()=>{null!=e&&e.isOpen()||((null==e?void 0:e.isInterrupted())?null==e||e.resume():null==e||e.open())}}))(),((e=t3(rL),t=t3(rV),n=rT,i=eo.getValue(),r=t0())=>e?{showProductView:()=>{i.sdk.is.below7&&"landscape"===nw()&&t?t.open({fallback:"off"}):null==e||e.open(!1)},hideProductView:()=>{},endAdOnProductViewClose:()=>{r.addEventHandler("app-store-mraid",(e,t)=>{"failed"===t.event&&n()}),i.sdk.is.v70x&&r.addEventHandler("viewability",(e,t)=>{"maximized"===t.event&&n()})}}:{showProductView:()=>void 0,hideProductView:()=>void 0,endAdOnProductViewClose:()=>void 0})(),rw(),rN(),((e=ns())=>({emitCloseButtonShow:()=>{e.emit("closeButtonShow")},emitCloseButtonClick:()=>{e.emit("closeButtonClick")}}))(),((e={})=>{let{sceneContext:t=t2,injectedGetTpatReportingService:n=iP,injectedEmitTrackingEvent:i=rF,injectedGetAmplifyEndcardEngagementService:r=()=>rW.getIfExists(),injectedGetObservabilityService:a=()=>t5.get(),injectedSceneEventReportingService:s=ns,injectedGetOmsdkHtmlDisplayService:o=()=>rU.getIfExists(),injectedViewabilityReportingService:l=eh,injectedMraidService:d=()=>tG.get()}=e;return{onCreativeView:()=>{let e=t.getValue().scene;e&&["endcard","image"].includes(e.getSceneType())&&i("postroll.view",e.getId(),e.getTrackingEventMapConfig(),!0)},destroyIframe:K({shouldRenderIFrame:!1}),initCheckpoints:()=>{n().hasExistingEvent({type:"tpat",event:"checkpoint.0"})||(tR.get().isViewable()?iU(0):i1(l(),"maximized").pipe(ie(1)).subscribe({next:()=>{iU(0)}}))},initOmsdkHtmlDisplayService:()=>{c.getInstance().bindService(rU,new rU)},closeWillAppear:()=>{s().emit("closeWillAppear")},fireIfEngagementIsUsed:()=>{var e;(null==(e=r())?void 0:e.isEndcardAmplified())&&a().pushEvent({name:"engagement-is-used",metric:"engagement-is-used"})},registerSizeChangeMraidEvent:()=>{window.addEventListener("resize",()=>{s().emit("sizeChange")})},finishHtmlDisplayOmsdkSession:()=>{var e;null==(e=o())||e.onSessionChange({type:"sessionFinish"})},detectBlackScreen:()=>{d().detectBlackScreen()},measureFrameRate:()=>{rP({duration:1e3}).then(e=>{a().pushEvent({name:"frame-rate-measurement",metric:"frame-rate-measurement",frame_rate:e})}).catch(e=>{throw Error(`Endcard frame rate measurement failed: ${e.message}`)})}}})(),{showLastChanceEndcard:()=>{let e=t2.getValue().scene;if(nj(e)){let t=rj(e.getId());rr.setValue({isLastChanceEndcardOverlayShowing:!0}),null==t||t.send({type:"SHOW"})}},closeLastChanceEndcard:()=>{rr.setValue({isLastChanceEndcardOverlayShowing:!1});let e=t2.getValue().scene;if(nj(e)){let t=rj(e.getId());null==t||t.send({type:"HIDE"})}}}))};return e.has("IS_RUNNING_INSIDE_EMBED")&&ed().emit({type:"scene-builder-event",event:"sceneBuilderComplete",data:((e,t,n={})=>{let i=[],r=new Set,a=new Map,s=new Set,o=new Set(t.filter(e=>e.isChild()).map(e=>e.getId())),l=t.filter(e=>!e.isChild()).reduce((e,t)=>(e[t.getId()]=t,e),{});if(!e.initial)throw Error("Initial state is required for the ad state machine");return!function t(c){var d;if(r.has(c)||o.has(c))return;r.add(c);let u=function(t){let r,s;if(a.has(t))return a.get(t);let o=l[t],c=o?o.getSceneType():"closed",d=!!o&&o.isAlternative();r=t===e.initial?"start":"closed"===c?"end":"intermediate";let u=[];d&&u.push("Alternate"),u.push((s=n[c]||c)?s.charAt(0).toUpperCase()+s.slice(1):s);let h={id:t,label:u.join(" "),type:r,alternative:d,connections:[]};return a.set(t,h),i.push(h),h}(c),h=(null==(d=e.states[c])?void 0:d.on)||{},v=null;if("LAST_CHANCE_ENDCARD"in h){let e=`${c}_last_chance`;v={id:e,label:"Last Chance Endcard",type:"intermediate",alternative:!1,connections:[]},a.set(e,v),i.push(v);let t=`${c}->${e}`;s.has(t)||(s.add(t),u.connections.push(e))}Object.entries(h).forEach(([n,i])=>{"LAST_CHANCE_ENDCARD"===n||(Array.isArray(i)?i:[i]).forEach(i=>{let a=null==i?void 0:i.target;if(!a||!function(t,n){let i=new Map,r=0;if(!e.initial)throw Error("Initial state is required for the ad state machine");return!function t(n){var a;i.has(n)||(i.set(n,r++),Object.values((null==(a=e.states[n])?void 0:a.on)||{}).forEach(e=>{(Array.isArray(e)?e:[e]).forEach(e=>{"object"==typeof e&&(null==e?void 0:e.target)&&!i.has(e.target)&&t(e.target)})}))}(e.initial),"closed"===n||!!i.has(n)&&(!i.has(t)||i.get(t)<=i.get(n))}(c,a))return;let o=c,l=u;"NEXT"===n&&v&&(o=v.id,l=v);let d=`${o}->${a}`;s.has(d)||(s.add(d),l.connections.push(a)),r.has(a)||t(a)})})}(e.initial),{nodes:i.map(e=>{let t=[...new Set(e.connections)],n=t.filter(e=>"closed"!==e||1===t.length||!t.some(e=>"closed"!==e));return I(g({},e),{connections:n})})}})(t,i$(),{endcard:"Playable"})}),[t,n]})();return e.createMachine(n,i)})(e)),rX=function(e,t,n=j.get()){let i=eZ(()=>n.createMachine(e,t),[e]),r=tT(i.initialState),[a,s]=eZ(()=>{let e=n.interpret(i),t=e.subscribe(e=>{r.value=e});return[e,t]},[i]);return eX(()=>("Running"!==a.status&&a.start(),()=>{s.unsubscribe(),a.stop()}),[a]),[r,a.send,a,e]},rQ=(e,t)=>"string"!=typeof e?JSON.stringify(e):e,rZ=(e,t=i$())=>{let n=rQ(e.value,"getSceneForState"),i=t.find(e=>e.getId()===n);if(!i)throw Error(`No scene found for state ${n}`);return i};let rJ={video:"video-scene-start",endcard:"endcard-scene-start"};var r0=(e,t=tU())=>{let n;if("closed"===e.getSceneType())return;let i=g({name:"scene-start"},e.getObservabilityData()),r=[i,...(!(n=e.getSceneType())||!(n in rJ)?[]:[rJ[n]]).map(e=>I(g({},i),{metric:e}))];t.emit(r)},r1="product-view",r2=class extends tB{emit(e){"app-store-orchestration"===e.type&&null!=e.event?this.wrappedService.emit(e):this.wrappedService.emit({type:"app-store-orchestration",event:e})}},r3=e=>new r2(null!=e?e:ed()),r6=()=>ed();let r4=()=>({id:r1,initial:"HIDDEN",context:{delay:0,openCount:0},states:{SHOWING:{on:{CLOSE:{target:"HIDDEN",actions:["closeStoreView","removeViewabilityHandler"]},SET_FALLBACK:{target:"FALLBACK",actions:"removeViewabilityHandler"}}},HIDDEN:{on:{OPEN:{target:"SHOWING",actions:["addViewabilityHandler","updateOpenCount","openStoreView"]}}},FALLBACK:{on:{OPEN:{actions:"showFallback"}}},INITIAL:{},PREPARING:{},DONE:{}}}),r7=(e,t)=>{var n;"maximized"===t.event&&(null==(n=((e=j.get(),t=r1)=>e.interpreterMap.get(t))())||n.send({type:"CLOSE"}))},r5=(e=tG.get(),t=eh(),n=r6(),i=r3(),r=eo)=>({actions:{openStoreView:()=>{n.emit({type:"app-store-product-view",event:"appStoreOpen"}),e.openAppStore(0)},closeStoreView:()=>{n.emit({type:"app-store-product-view",event:"appStoreClose"})},addViewabilityHandler:()=>{t.addEventHandler("viewability",r7)},removeViewabilityHandler:()=>{t.removeEventHandler("viewability",r7)},updateOpenCount:K({openCount:e=>e.openCount?e.openCount+1:1}),showFallback:()=>{let e=r.getValue();e.device.os.is.iOS?i.emit("skpvFallbackToSko"):e.device.os.is.android&&i.emit("appStoreFallbackToMraid")}}});var r8=class extends d{isDone(){var e;return null!=(e=this.interpreter.state.matches("DONE"))&&e}close(){this.interpreter.send({type:"CLOSE"})}fallback(){}init(){}isOpen(){var e;return null!=(e=this.interpreter.state.matches("SHOWING"))&&e}open(e){var t;return!!(null!=(t=this.interpreter.state.matches("HIDDEN")||this.interpreter.state.matches("FALLBACK"))&&t)&&(this.hasFallback=e,this.interpreter.send({type:"OPEN"}),!0)}subscribe(e){return this.interpreter.subscribe(e)}setPrepared(){}constructor(e,t={},n=j.get()){super(),this.machineConfig=e,this.machineOptions=t,this.stateMachineService=n;let i=this.stateMachineService.createMachine(this.machineConfig,this.machineOptions);this.interpreter=this.stateMachineService.interpret(i),this.interpreter.start()}};class r9 extends r8{fallback(){!1!==this.hasFallback&&(this.interpreter.send({type:"SET_FALLBACK"}),this.open())}constructor(e=r4,t=r5,n=j.get()){super(e(),t(),n)}}r9.identifier=rL;var ae=r9,at=e=>{let{iconType:t,extraStyle:n}=e,i=eZ(()=>{switch(t){case"skip":return"zt09cW_skipIcon";case"skip-without-border":return"zt09cW_skipIconWithoutBorder";default:return"zt09cW_closeIcon"}},[t]);return rm("div",{className:n?`${i} ${n}`:i})},an=({productViewService:e=ae.getIfExists(),timerService:t=H.get(),injectedCloseAd:n=rT})=>(eX(()=>{(null==e?void 0:e.isOpen())?e.subscribe(()=>{e.isOpen()||n()}):t.getNewTimer(500,()=>{n()}).start()},[]),rm("div",{id:"app-store-transition-fallback",className:"wnLcbW_fallback",children:rm("button",{title:"Close","aria-label":"Close",id:iv,type:"button",onClick:()=>{n()},className:"closeIcon",children:rm(at,{iconType:"close"})})})),ai=class extends e_{componentDidCatch(e,t){var n;ed().emit({type:"error-logging",event:"exception",data:{error:{message:e.message,stack:`Stack trace:
${null!=(n=null==e?void 0:e.stack)?n:"No stack trace available"}

Error info:
${JSON.stringify(t)}
`}}})}render(){let{children:e}=this.props;return e}},ar=(...e)=>e.filter(Boolean).join(" "),aa=(e,t=j.get(),n=tR.get(),i=eh())=>{let[r,a]=rX(rI(e),rk(n,i),t);return[r,a]},as=(e,t,n=ed())=>(eX(()=>(n.addEventHandler(e,t),()=>{n.removeEventHandler(e,t)}),[n,e,t]),()=>{n.removeEventHandler(e,t)}),ao=({gdprService:e=rD.getIfExists(),viewabilityReportingService:t=eh(),adData:n=eo.getValue()})=>{let[i]=aa(i_),r=tT(!0);return(eX(()=>{(window.innerWidth<300||window.innerHeight<250)&&(r.value=!1)},[]),as("viewability",(e,t)=>{!r.value&&["maximized","internal-maximized"].includes(t.event)&&window.innerWidth>=300&&window.innerHeight>=250&&(r.value=!0)},t),e&&r.value)?rm("div",{className:ar("C4yOdG_gdpr",i.value.matches("SHOWING")?"":"C4yOdG_hidden"),id:i_,"aria-hidden":i.value.matches("HIDDEN"),children:[rm("div",{className:"C4yOdG_content",children:[rm("header",{className:"C4yOdG_header",children:[rm("span",{className:"C4yOdG_icon"}),rm("h3",{id:"gdpr-title",className:"C4yOdG_title",children:n.gdpr.title})]}),rm("p",{id:"gdpr-body-text",className:"C4yOdG_bodyText",children:n.gdpr.body})]}),rm("div",{className:"C4yOdG_buttons",children:[rm("button",{type:"button",id:"gdpr-accept",className:"C4yOdG_primaryButton",onClick:()=>null==e?void 0:e.consentAction("opted_in"),children:n.gdpr.accept}),rm("button",{type:"button",id:"gdpr-deny",className:"C4yOdG_secondaryButton",onClick:()=>null==e?void 0:e.consentAction("opted_out"),children:n.gdpr.deny})]})]}):null};let al=e=>4===e.length?e:al(`0${e}`);var ac=class{constructor(e){this.adData=e,this.getBits=()=>{let e=this.adData.platform.sessionId;if(!e){let e=[];for(let t=0;t<96;t+=1)e.push("0");return e}return e.split("").map(e=>al(parseInt(e,16).toString(2))).join("").split("")}}};let ad=(e,t)=>`bit-${e}-${t}`;var au=({adData:e=eo.getValue()})=>{let t=new ac(e);return e.placement.is.fullscreen?rm("div",{className:"_0zGmtq_watermark",id:"watermark",children:[rm("div",{className:"_0zGmtq_one  _0zGmtq_leading _0zGmtq_bit"}),t.getBits().map((e,t)=>rm("div",{className:`_0zGmtq_bit ${"0"===e?"_0zGmtq_zero":"_0zGmtq_one"}`,id:ad(e,t)},ad(e,t)))]}):null},ah=function(e=nO()){let t=tT(!0);return as("theatre-mode-event",(n,i)=>{if(e.hasExistingEvent({type:"theatre-mode-event",event:"disableTheatreMode"})){t.value=!0;return}"hideControls"===i.event?t.value=!1:"revealControls"===i.event&&(t.value=!0)},e),t};let av={accelerate:"#96633d",others:"#853d96"};var ap=({handleClick:e,adSource:t,theatreModeReportingService:n=nO()})=>rm("button",{type:"button",id:iC,title:"Liftoff Privacy",className:ar("m2_mMq_privacyButton",ah(n).value?"fadeIn":"fadeOut"),onClick:e,"aria-label":"Liftoff Privacy",children:rm("svg",{id:"j",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 302 340",children:[rm("path",{d:"M274.04,32.82L160.56,7.74c-2.53-.42-5.1-.43-7.62,0L28.59,32.87c-12.39,2.04-21.55,13.63-21.55,27.27v165.78c0,7.75,2.99,15.14,8.25,20.36l55.61,55.27c44.48,44.21,116.29,44.21,160.77,0l55.61-55.27c5.26-5.22,8.25-12.62,8.25-20.36V60.08c0-13.62-9.13-25.19-21.49-27.26Z",fill:av[t],opacity:".6",strokeWidth:"0"}),rm("path",{d:"M275.5,26.22L161.67,1.07c-3.25-.55-6.56-.54-10.08.03L27.37,26.22C11.67,28.88.29,43.11.29,60.13v143.34c0,23.78,9.29,46.64,25.47,62.73l51.82,46.31c41.98,37.52,105.43,37.52,147.41,0l51.82-46.32c16.19-16.09,25.47-38.95,25.47-62.73V60.08c0-17.03-11.41-31.3-26.79-33.86ZM288.78,203.48c0,20.2-7.83,39.57-21.48,53.14l-32.94,29.99c-8.73-9.02-16.42-17.46-16.42-17.46-10.8-11.49-24.61-2.92-24.61-2.92-1.95,1.13-4.12,2.13-6.42,3.02-3.77,1.29-8.66,2.76-14.21,4-9.02,1.83-17.27,2.47-20.08,2.65-.44.01-.87.04-1.3.05-.44,0-.87-.04-1.3-.05-2.82-.18-11.06-.82-20.08-2.65-5.55-1.24-10.44-2.71-14.21-4-2.3-.89-4.47-1.88-6.42-3.02,0,0-13.82-8.57-24.61,2.92,0,0-7.28,7.89-16.44,17.48l-32.96-30.01c-13.65-13.56-21.48-32.93-21.48-53.14V60.13c0-10.25,6.83-19.11,15.89-20.6l124.34-25.14c.96-.15,1.92-.22,2.82-.22.8,0,1.57.05,2.25.16l113.83,25.15c9.04,1.51,15.85,10.36,15.85,20.59v143.4Z",fill:"#f3f4f5",strokeWidth:"0"}),rm("path",{d:"M188.96,142.21c-6.2,0-9.55,5-10.07,15.01l-.06,3.69c0,11.44,3.34,17.16,10.01,17.16,4.45,0,7.62-1.87,9.53-5.6v-24.54c-1.83-3.81-4.96-5.72-9.41-5.72Z",fill:"#f3f4f5",strokeWidth:"0"}),rm("polygon",{points:"107.78 160.02 126.43 160.02 117.07 129.93 107.78 160.02",fill:"#f3f4f5",strokeWidth:"0"}),rm("path",{d:"M151,57c-51.36,0-93,41.64-93,93s41.64,93,93,93,93-41.64,93-93-41.64-93-93-93ZM136.49,192.36l-5.06-16.2h-28.65l-5,16.2h-22.34l31.81-86.73h19.66l32.05,86.73h-22.46ZM200.46,192.36l-1.01-6.91c-4.13,5.4-9.37,8.1-15.73,8.1-7.67,0-13.74-2.94-18.23-8.82-4.49-5.88-6.73-14.24-6.73-25.08,0-10.21,2.2-18.25,6.61-24.13,4.41-5.88,10.56-8.82,18.47-8.82,5.76,0,10.6,2.26,14.54,6.79v-32.64h20.13v91.5h-18.05Z",fill:"#f3f4f5",strokeWidth:"0"})]})}),ag=((i={})[i.LEFT=0]="LEFT",i[i.RIGHT=1]="RIGHT",i[i.UP=2]="UP",i[i.DOWN=3]="DOWN",i),am=((r=am||{})[r.HORIZONTAL=0]="HORIZONTAL",r[r.VERTICAL=1]="VERTICAL",r);let af=to(0),aS=to(0),ay=to(!1),aC=to(0);var aE=({children:e,onSwipeLeft:t,onSwipeRight:n,onSwipeUp:i,onSwipeDown:r})=>{let a=eQ(null),s=(e,t)=>Math.abs(e)>Math.abs(t);return rm("div",{ref:a,title:"swipe",onTouchStart:e=>{ay.value=!0;let t=0,n=0;e instanceof TouchEvent?(t=e.touches[0].clientX,n=e.touches[0].clientY):e instanceof MouseEvent?(t=e.clientX,n=e.clientY):(t=e.detail.clientX,n=e.detail.clientY),af.value=t,aS.value=n,aC.value=Date.now()},onTouchEnd:e=>{var o,l,c,d,u;let h,v,p=null==a||null==(o=a.current)?void 0:o.childNodes;if(!ay||!p)return;let{endX:g,endY:m}=e instanceof TouchEvent?{endX:e.changedTouches[0].clientX,endY:e.changedTouches[0].clientY}:e instanceof MouseEvent?{endX:e.clientX,endY:e.clientY}:{endX:null!=(d=null==(l=e.detail)?void 0:l.clientX)?d:0,endY:null!=(u=null==(c=e.detail)?void 0:c.clientY)?u:0},f=(h=g-af.value,{Direction:s(h,v=m-aS.value)?+(h>0):v>0?3:2,Orientation:+!s(h,v),Distance:s(h,v)?Math.abs(h):Math.abs(v),DeltaX:h,DeltaY:v}),S=p[0],y=0===f.Orientation?S.clientWidth:S.clientHeight;if(f.Distance>=.05*y){switch(f.Direction){case 0:t&&t();break;case 1:n&&n();break;case 3:r&&r();break;default:i&&i()}ay.value=!1}},children:e})},a_=((a={})[a.LOVE=1]="LOVE",a[a.BROKEN=2]="BROKEN",a[a.OFFENSIVE=3]="OFFENSIVE",a),ab=class{getAdSource(){return this.adData.advertiser.rtb.name}getCreativeId(){return this.adData.advertiser.creative.id}getEventId(){return this.adData.platform.sessionId}getVersions(){var e;return`SDK ${this.adData.sdk.version}, VM ${null!=(e=window.appVersion)?e:"0.0.0"}, OS ${this.adData.device.os.version}`}handleDrawerClose(e){e({type:"PRIVACY_BOTTOM_DRAWER_CLOSE"})}handleIconClick(e){e({type:"PRIVACY_BOTTOM_DRAWER_OPEN"})}handleReadMoreClick(e){e({type:"PRIVACY_BOTTOM_DRAWER_CLOSE"}),window.setTimeout(()=>{e({type:"OPEN_PRIVACY_PAGE"})},50)}privacyDrawerEnabled(){return this.adData.placement.is.fullscreen}constructor(e=h.get(),t=eo.getValue(),n=tU()){this.tokenService=e,this.adData=t,this.observabilityReportingService=n,this.handleFeedbackSubmit=e=>{this.observabilityReportingService.emit("ad-feedback",{1:"ad-feedback-love",2:"ad-feedback-broken",3:"ad-feedback-offensive"}[e])}}};let aw=[{type:a_.LOVE,text:"Love it",emoji:""},{type:a_.BROKEN,text:"Broken",emoji:""},{type:a_.OFFENSIVE,text:"Offensive",emoji:""}];var aT=({handleFeedbackSubmit:e})=>{let t=tT(null);return rm("div",{className:"_0LRN8a_container",children:t.value?rm("div",{className:"_0LRN8a_completeContainer",children:[rm("div",{className:ar("_0LRN8a_title","_0LRN8a_thanks"),children:"Thank you"}),rm("span",{className:"_0LRN8a_complete"})]}):rm("div",{className:"_0LRN8a_popup",children:[rm("div",{className:ar("_0LRN8a_title","_0LRN8a_question"),children:"What do you think of this ad?"}),rm("div",{className:"_0LRN8a_options",children:aw.map(n=>rm("button",{type:"button",className:"_0LRN8a_option",onClick:()=>{t.value=n.type,e(t.value)},children:[rm("span",{className:"_0LRN8a_optionText",children:n.text}),rm("span",{className:"_0LRN8a_emoji",children:n.emoji})]},n.type))})]})})},aA=({label:e,value:t,id:n})=>{let i=tT(!1);return rm("div",{className:"rM5gmW_adInfoRow",id:n,children:[rm("div",{className:"rM5gmW_adInfoLabel",children:e}),rm("button",{type:"button",className:ar("rM5gmW_adInfoValue",i.value?"rM5gmW_expanded":""),onClick:()=>{i.value=!i.value},children:t})]})},aI=({isOpen:e,handleReadMoreClick:t,closeHandler:n,creativeID:i,eventID:r,versions:a,handleFeedbackSubmit:s})=>rm("div",{className:ar("FbTWOG_popupContainer",e?"FbTWOG_popupContainerDisplay":""),id:iy,children:[rm("div",{className:e?"FbTWOG_mask":"FbTWOG_displayNone",id:"privacy-popup-mask",onClick:n,role:"none"}),rm(aE,{onSwipeDown:n,children:rm("div",{id:"privacy-popup",role:"dialog","aria-label":"Privacy popup","aria-hidden":e?"false":"true",className:ar("FbTWOG_privacyPopup",e?"FbTWOG_show":"FbTWOG_hide"),children:[rm("div",{className:"FbTWOG_popupHeader",children:rm("button",{type:"button","aria-label":"Close privacy popup","aria-hidden":e?"false":"true",onClick:n,id:"privacy-close-button",children:rm(at,{iconType:"close",extraStyle:"FbTWOG_privacyCloseIcon"})})}),rm("div",{className:"FbTWOG_popupBody",children:rm(aT,{handleFeedbackSubmit:s})}),rm("div",{className:"FbTWOG_privacyPolicy",children:rm("button",{type:"button",className:"FbTWOG_readMore","aria-hidden":e?"false":"true",onClick:t,id:"privacy-read-more-button",children:"Privacy Policy"})}),rm("div",{className:"FbTWOG_popupFooter",children:[rm("div",{className:"FbTWOG_adInfoTitle",children:"Ad Info"}),rm(aA,{label:"Creative ID:",value:i,id:"privacy-drawer-creative-id"}),rm(aA,{label:"Event ID:",value:r,id:"privacy-drawer-event-id"}),rm(aA,{label:"Versions:",value:a,id:"privacy-drawer-versions"})]})]})})]});let ak=to(!1);var aO=({sendAdEvent:e,privacyService:t=new ab,mraidEventReportingService:n=eu()})=>{let i=()=>{ak.value=!1,t.handleDrawerClose(e)};return as("mraid-event",(e,t)=>{"custom-close"===t.event&&ak.value&&i()},n),rm(eE,{children:[rm(ap,{handleClick:()=>{t.handleIconClick(e),ak.value=!0},adSource:t.getAdSource()}),t.privacyDrawerEnabled()&&rm(aI,{isOpen:ak.value,closeHandler:i,handleReadMoreClick:()=>{ak.value=!1,t.handleReadMoreClick(e)},creativeID:t.getCreativeId(),eventID:t.getEventId(),versions:t.getVersions(),handleFeedbackSubmit:t.handleFeedbackSubmit})]})},aD=function(e,t){let n=eQ(0),i=eQ(0);return eX(()=>{let r=r=>{let a=Date.now();a-i.current>800&&(n.current=0),n.current+=1,i.current=a;let{clientX:s,clientY:o}=r;n.current>=3&&(e(s,o,t),n.current=0)};return window.addEventListener("pointerdown",r),()=>window.removeEventListener("pointerdown",r)},[e,t]),null},aV=({delay:e,handleCountdownUpdate:t,isVisible:n=!0,children:i})=>{let r=((e,t=tY.get())=>{let n=tT(e),i=eQ(void 0),r=()=>{var e;null==i||null==(e=i.current)||e.destroy(),i.current=void 0};return eX(()=>{if(void 0===i.current){var e;i.current=t.getNewInterval(1e3,()=>{let e=n.value-1;n.value=e<=0?0:e}),null==(e=i.current)||e.start()}return()=>r()},[]),tL(()=>{0===n.value&&r()}),as("scene-event",(e,t)=>{"forceCompleteCountdown"===t.event&&(n.value=0)}),n})(e);if(eX(()=>{t&&t(r.value)},[r.value]),r.value>0&&!n)return rm("div",{id:ip,className:"NQnIja_countdownInvisible"});if(r.value>0&&n){let e=Math.round(r.value);return 0===e?null:rm("div",{id:ip,className:"NQnIja_countdown",children:e})}return rm("div",{children:i})};let aL=["mrec","banner","in_line"];var aN=class{placementSupportsNextButton(){return!aL.includes(this.adData.placement.type)}constructor(e=eo.getValue(),t=ns(),n=t2){this.adData=e,this.sceneEventReportingService=t,this.sceneContext=n,this.handleCountdownUpdate=e=>{let t=this.sceneContext.getValue().scene;this.sceneEventReportingService.emit({type:"scene-event",event:"nextButtonCountdownTick",data:{scene_id:t.getId(),scene_type:t.getSceneType(),delay:e}})}}},ax=class{getButtonPadding(e=0,t=10){return((e=iP())=>["clickUrl","postroll.click"].some(t=>e.findAll({where:{type:"tpat",event:t}}).length>0))()?t:Math.min(Math.max(parseInt(this.tokenService.get("CLOSE_BUTTON_PADDING"),10)||e,e),t)}constructor(e=h.get()){this.tokenService=e}},aP=(e=r$())=>e.state.context.isTheatreModeActive,aR=({sendEvent:e,showGooglePlayText:t,type:n=nQ.CLOSE,service:i=new ax,showLastChanceEndcard:r=!1,beforeClick:a=()=>{}})=>{let s=eZ(()=>t?"skip-without-border":n===nQ.SKIP?"skip":"close",[t,n]),o=n===nQ.SKIP?"Skip button":"Close button",l=tT(i.getButtonPadding());eX(()=>{e&&e({type:"CLOSE_BUTTON_WILL_SHOW"})},[]),as("tpat",()=>{t||(l.value=i.getButtonPadding())}),((e,t=ih,n=eo.getValue(),i=nO(),r=H.get(),a=r$(),s=eh())=>{let o=eQ(null),{scene:l}=t2.getValue(),c=!n.placement.is.fullscreen||!iQ(l)||!l.theatreModeEnabled||i.hasExistingEvent({type:"theatre-mode-event",event:"disableTheatreMode"}),d=()=>{c||i.emit({type:"theatre-mode-event",event:"hideControls"})};as("viewability",()=>{c||i.emit({type:"theatre-mode-event",event:"revealControls"})},s),as("theatre-mode-event",(n,i)=>{if(!c){if("revealControls"===i.event){var a;e({type:"STOP_THEATRE_MODE"}),null==(a=o.current)||a.destroy(),o.current=r.getNewTimer(t,d),o.current.start()}"hideControls"===i.event&&e({type:"START_THEATRE_MODE"})}},i),eX(()=>{if(c)return()=>{};let e=e=>{if(aP(a)&&iQ(l)&&!l.getFullScreenClickConfig().enabled){let t=e.target;t&&"function"==typeof t.closest&&(t.closest("#download-button")||t.closest("#persistent-simple-cta")||t.closest("#persistent-rich-cta")||t.closest('[id*="persistent"][id*="cta"]'))||i.emit({type:"theatre-mode-event",event:"revealControls"})}};return document.addEventListener("pointerdown",e),o.current=r.getNewTimer(t,d),o.current.start(),()=>{document.removeEventListener("pointerdown",e),o.current&&o.current.destroy()}},[])})(e);let c=-l.value;return rm("button",{title:o,"aria-label":o,id:iv,type:"button",style:{padding:`${l.value}px`,margin:`${c}px`},onClick:t=>{t.stopPropagation(),e({type:"CLOSE_BUTTON_CLICK"}),a(),e(r?{type:"LAST_CHANCE_ENDCARD"}:{type:"NEXT"})},children:rm("div",{className:t?"mqB7Ka_googlePlayTextContainer":"",children:[t&&rm("div",{className:"mqB7Ka_googlePlayText",children:"Google Play"}),rm(at,{iconType:s})]})})};let aM=to(!0);var aB=({id:e,sendAdEvent:t,showLastChanceEndcard:n=!1,config:i,beforeClick:r=()=>{},theatreModeReportingService:a=nO(),adData:s=eo.getValue(),appStoreContext:o=tH})=>{let l=!!o.getValue().inlineInstallUrl,c=s.sdk.supports.apv&&((e=t2)=>{let t=e.getValue().scene;if(!t)return!1;let n=t.getTransitions().find(e=>"NEXT"===e.name);return!!n&&n.actions.some(e=>"showProductView"===e.name)})()&&l,{delay:d=0,countdown:u=!0}=i,h=new aN,v=d>0;as("viewability",(e,t)=>{aM.value="maximized"===t.event});let p=ah(a);return h.placementSupportsNextButton()?rm("div",{id:(null!=e?e:n)?ig:iS,className:ar("LJWyoG_nextButton",p.value?"fadeIn":"fadeOut"),role:"button",tabIndex:0,"data-countdown-running":aM.value,children:v?rm(aV,{delay:d,isVisible:u,handleCountdownUpdate:h.handleCountdownUpdate,children:rm(aR,{sendEvent:t,showGooglePlayText:c,type:c?nQ.SKIP:i.style,showLastChanceEndcard:n,beforeClick:r})}):rm(aR,{sendEvent:t,showGooglePlayText:c,type:c?nQ.SKIP:i.style,showLastChanceEndcard:n,beforeClick:r})}):null},aF=(e,t)=>{eX(()=>{let n=window.setInterval(()=>{var i;(null==(i=e.current)?void 0:i.complete)&&(t({type:"PRIVACY_LOGO_SHOW"}),window.clearInterval(n))},100);return()=>{window.clearInterval(n)}},[e])},aU=class{clickHandler(e,t){aP(this.adMachineInterpreter)?this.theatreModeReportingService.emit({type:"theatre-mode-event",event:"revealControls"}):this.fscReportingService.emit({type:"fsc",event:"fsc",data:{cta_url:t,scene_id:e}})}constructor(e=nb(),t=ed(),n=t3(rV),i=r$()){this.fscReportingService=e,this.theatreModeReportingService=t,this.storeKitOverlayService=n,this.adMachineInterpreter=i}},aH=({config:e,ctaUrl:t,sceneId:n,service:i=new aU,reportingService:r=eh(),children:a})=>{let s=tT(!1);return as("viewability",(e,t)=>{s.value="minimized"===t.event},r),rm(eE,{children:[e.enabled&&rm("button",{className:ar("_7pzQ5q_overlayCta",s.value?"_7pzQ5q_hidden":""),type:"button",id:e.id?`${e.id}-fullscreen-overlay`:"fullscreen-overlay","data-scene-id":n,"aria-label":"fsc","aria-hidden":s.value,style:e.styleData,onClick:()=>i.clickHandler(n,t)}),a]})},aW=class{emitClickEvents(e){this.ctaReportingService.emit({type:"cta",event:"lastChanceEndcardCta",data:{scene_id:e}})}constructor(e=ed()){this.ctaReportingService=e}};let aG=to(!1);var aK=({config:e,sendAdEvent:t=()=>{},backgroundNone:n=!1,onVisibilityChange:i,sceneId:r})=>{var a,s,o,l,c,d,u,h,v;let p=new aW,g=eQ(null),m=(e=>{let[t]=rX(eZ(()=>({id:null!=e?`${rG}-${e}`:rG,initial:"HIDDEN",context:{delay:0},states:{SHOWING:{on:{HIDE:{target:"HIDDEN",actions:"onLastChanceEndcardHide"}}},HIDDEN:{on:{SHOW:{target:"SHOWING",actions:"onLastChanceEndcardShow"}}}}}),[e]),rK);return t})(e.id);aF(g,t);let f=()=>{aG.value=!0,p.emitClickEvents(r)};return(eX(()=>{i(e.enabled&&!m.value.matches("HIDDEN"))},[e.enabled,m.value]),!e.enabled||m.value.matches("HIDDEN"))?null:rm("div",{className:ar("poFP6W_overlay",(null==(a=e.appMeta)?void 0:a.icon)?"poFP6W_opaque":""),id:"last-chance-endcard-overlay",children:rm(aH,{config:{enabled:!!(null==(s=e.fsc)?void 0:s.enabled),styleData:null==(o=e.fsc)?void 0:o.styleData},sceneId:r,children:[rm(aB,{sendAdEvent:t,config:null!=(v=e.close)?v:{},showLastChanceEndcard:!1}),rm("div",{className:ar("poFP6W_lastChanceEndCard",n?"poFP6W_backgroundNone":""),id:"last-chance-endcard",children:[(null==(l=e.appMeta)?void 0:l.icon)&&rm("img",{className:"poFP6W_icon",ref:g,src:null==(c=e.appMeta)?void 0:c.icon,alt:null==(d=e.appMeta)?void 0:d.name,id:"last-chance-endcard-app-icon",onClick:f,"aria-hidden":"true"}),rm("p",{className:"poFP6W_name",id:"last-chance-endcard-app-name",onClick:f,"aria-hidden":"true",children:null==(u=e.appMeta)?void 0:u.name}),rm("button",{type:"button",className:ar("poFP6W_button",aG.value?"":"poFP6W_animate"),"data-animate":!aG.value,onClick:f,id:im,children:null==(h=e.cta)?void 0:h.text})]})]})})},aj=()=>ed(),aY=(e,t=aj())=>{eX(()=>{var n;e&&"function"==typeof e.getCallToActionConfig&&t.emit({type:"app-meta",event:"app-meta-update",data:null!=(n=e.getCallToActionConfig().appMeta)?n:{enabled:!1}})},[])},aq=({htmlString:e,VmComponent:t})=>{let[n,i]=e$(null);return eX(()=>{let n,r;i((n=new DOMParser().parseFromString(e,"text/html"),(r=e=>{var n;if(!e)return null;if(e.nodeType===Node.TEXT_NODE)return(null==(n=e.nodeValue)?void 0:n.trim())?e.nodeValue:null;if(e.nodeType!==Node.ELEMENT_NODE)return null;let i=e.tagName.toLowerCase(),a={};return(Array.from(e.attributes).forEach(e=>{a[e.name]=e.value}),"vm-component"===i)?rm(t,{sceneId:a["scene-id"]||""}):ey(i,a,...Array.from(e.childNodes).map(r).filter(e=>!!e))})(n.body.firstChild)))},[e]),n},az=class extends nx{getId(){return"closed"}getSceneType(){return"closed"}getObservabilityData(){return{scene_id:this.getId(),scene_type:this.getSceneType(),scene_index:this.getSceneIndex()}}getSceneIndex(){return -1}constructor(){super(),this.addEntryAction({name:"ensureRewardGranted"}),this.addEntryAction({name:"destroyIframe"}),this.getEntryActions().some(e=>"closeAd"===e.name)||this.addEntryAction({name:"closeAd"}),this.addTransition(g({},nF)),this.addTransition(g({},nW))}},a$=()=>ed();class aX extends nY{getId(){return this.id}getSceneType(){return"endcard"}getSceneIndex(){return this.injectedGetScenes().findIndex(e=>e.getId()===this.getId())}getStoreKitOverlayAutoShowConfig(){return this.storeKitOverlayAutoShowConfig}getAppStoreOnDelayConfig(){return this.appStoreOnDelayConfig}getCloseButtonConfig(){var e,t,n,i,r;let a=this.closeButtonConfigProvider.getCloseButtonConfig(),s=0;if(this.prev&&iQ(this.prev)&&(r=this.prev)&&"function"==typeof r.getCloseButtonConfig){let i=rf(this.prev.getId()),r=i?rQ(i.state.value,"Endcard scene"):"";if(!i||["FAILED","LOADING","LOAD_FAIL_RETRY","AUTO_PLAY_FAIL"].includes(r)){let r=null!=(n=null==(e=this.prev.getCloseButtonConfig())?void 0:e.delay)?n:0;s=9999===r?((...e)=>e.find(e=>(null!=e?e:0)>0))(null==i||null==(t=i.state.context)?void 0:t.duration,this.prev.expectedVideoDuration,6):r}}return I(g({},a),{delay:(null!=(i=null==a?void 0:a.delay)?i:0)+s,style:this.isLastPage()?nQ.CLOSE:a.style})}getLastChanceEndcardConfig(){return this.lastChanceEndcardConfig}getTrackingEventMapConfig(){return this.trackingEventMapConfig}getCallToActionConfig(){return this.callToActionConfig}setLastChanceEndcardConfig(e){this.lastChanceEndcardConfig=e}getEventStreams(){return this.eventStreams?this.eventStreams:(({incentivizedConfig:e,hasLastChanceEndcard:t,reportingService:n=t0(),timerService:i=H.get(),mraidEventsProxyService:r=i7.get(),viewableService:a=tR.get(),viewabilityReportingService:s=eh(),observabilityEventReportingService:o=tU(),adData:l=eo.getValue()})=>{let c,d=ns(n),u=n7(n,"playable").pipe(n5()).pipe(n8(n4(d,"sceneEnd"))),h=it(n4(d,"loadStart"),n4(d,"loadComplete"),n4(d,"sceneEnd")),v=I(g({},ik(n,t)),{error_count:u,iframe_type:((e,t,n=t2)=>new n2(i=>{let r=n4(e,"sceneEnd").subscribe({next:()=>{var e;i.next(((e=t2,t=a$())=>{var n;let i=null==(n=e.getValue().scene)?void 0:n.getId(),r=t.findAll({where:{type:"iframe",event:"nestedIframeType",data:{scene_id:i}}}).map(e=>{var t;return null==(t=e.activity.data)?void 0:t.nested_iframe_type});return r.includes("cors")?"cors":r.includes("basic")?"basic":""})(n,t)),null==(e=i.complete)||e.call(i)}});return{unsubscribe:()=>{r.unsubscribe()}}}))(d,n),load_duration:h,viewable_change:i2(d,s,r,a),size_change:i0(d,r),close_will_appear:iJ(d,r),flush_mraid_events:i3(d,r)});return l.sdk.supports.hapticFeedback&&(c=n4(d,"sceneEnd"),v.haptic_feedback_count=n4(d,"hapticFeedback").pipe(n8(c),n5(),is(0))),l.sdk.is.v763OrAbove&&l.device.os.is.iOS&&(v.black_screen_percentage=iI(n4(d,"sceneEnd").pipe(ia(()=>-2)),rh(o,"black-screen-detected").pipe(ia(e=>e.data.percentage)))),e.enabled&&(v.has_reward_been_granted=ij("endcard",e,n,i)),v})({incentivizedConfig:this.incentivizedConfig,hasLastChanceEndcard:this.lastChanceEndcardConfig.enabled})}getIncentivizedConfig(){return this.incentivizedConfig}getHasNestedIframe(){return this.hasNestedFrame}initIframeContentData(e){let t=e.getNestedIframeContentData(this.endcardContent);this.hasNestedFrame=!!t,this.iframeContentData=e.initializeIframeContentData(this.endcardContent,this.id,t)}async getIframeContentData(){var e;return null!=(e=this.iframeContentData)?e:Promise.resolve({content:this.endcardContent})}getObservabilityData(){return{scene_id:this.getId(),scene_type:this.getSceneType(),scene_index:this.getSceneIndex(),has_nested_iframe:this.getHasNestedIframe()}}getInlineInstallConfig(){return this.inlineInstallConfig}constructor({id:e,endcardContent:t,index:n,isAlternative:i,isFullscreen:r,storeKitOverlayAutoShowConfig:a,appStoreOnDelayConfig:s,lastChanceEndcardConfig:o,omsdkConfig:l,closeButtonConfigProvider:c,trackingEventMapConfig:d,muted:u=!1,callToActionConfig:h,shouldSplitVideoEndcardClick:v=!1,eventStreams:p,incentivizedConfig:g,amplifyEndcardEngagementService:m=rW.getIfExists(),injectedGetScenes:f=i$,inlineInstallConfig:S,adData:y=eo.getValue()}){super({isFullscreen:r}),this.hasNestedFrame=!1,this.id=e,this.endcardContent=t,this.index=n,this.alternative=i,this.storeKitOverlayAutoShowConfig=a,this.appStoreOnDelayConfig=s,this.lastChanceEndcardConfig=o,this.trackingEventMapConfig=d,this.closeButtonConfigProvider=c,this.callToActionConfig=h,this.muted=u,this.shouldSplitVideoEndcardClick=v,this.eventStreams=p,this.incentivizedConfig=g,this.amplifyEndcardEngagementService=m,this.injectedGetScenes=f,this.inlineInstallConfig=S,(null==l?void 0:l.enabled)&&this.addEntryAction({name:"initOmsdkHtmlDisplayService"}),this.addEntryAction({name:"registerSizeChangeMraidEvent"}),this.addTransition(nU),this.addTransition(nH),this.addOrUpdateTransition({name:"CLOSE",actions:[],scene:new az}),this.addOrUpdateTransition({name:"CLOSE_BUTTON_WILL_SHOW",actions:[{name:"closeWillAppear"}]}),this.addTransition({name:"CREATIVE_VIEW",actions:[{name:"onCreativeView"}]}),this.addEntryAction({name:"postrollView"}),this.addEntryAction({name:"fireIfEngagementIsUsed"}),this.addEntryAction({name:"initCheckpoints"}),this.addExitAction({name:"finishHtmlDisplayOmsdkSession"}),this.addDelayedTransition({delay:5e3,actions:[{name:"detectBlackScreen"}],cond:()=>y.sdk.is.v763OrAbove&&y.device.os.is.iOS}),this.addDelayedTransition({delay:5e3,actions:[{name:"measureFrameRate"}]})}}aX.isEndcardOnly=(e=h.get())=>{let t=!e.has("MAIN_VIDEO")&&!e.has("MAIN_STREAM"),n=1===iq.filter(t=>e.has(t)).length;return t&&n};var aQ=aX,aZ=function(e){return e instanceof aQ&&"image"===e.getSceneType()},aJ=(e,t,n=!0,i=tR.get())=>{let[,r]=rX({id:`app-store-on-delay-${e}`,initial:"GATE",context:{delay:t.autoShowDelay,canStartTimer:!1},states:{GATE:{always:[{target:"WAITING",cond:"canStartTimer"},{target:"IDLE"}]},IDLE:{on:{SET_READY:[{target:"GATE",actions:"setCanStartTimer"}]}},WAITING:{after:{DELAY:{target:"SHOWING",cond:"shouldOpen"}}},SHOWING:{entry:["openAppStore"]}}},((e=t3(rL),t=t3(rV),n=eo.getValue(),i=rr)=>({actions:{setCanStartTimer:K({canStartTimer:()=>!0}),openAppStore:()=>{"landscape"===nw()&&n.sdk.is.below7&&t?t.open():null==e||e.open(!1)}},guards:{canStartTimer:e=>e.canStartTimer,shouldOpen:()=>!i.getValue().isLastChanceEndcardOverlayShowing},delays:{DELAY:e=>e.delay}}))()),a=tT(i.isViewable()),s=eQ(!1);eX(()=>{t.enabled&&n&&!s.current&&a.value&&(r({type:"SET_READY"}),s.current=!0)},[n,a.value]),as("viewability",()=>{a.value=i.isViewable()})},a0=(e,t,n=!0,i=t3(rV),r=tR.get())=>{let a=tT(r.isViewable()),s=eQ(!1),[,o]=rX({id:`store-kit-overlay-auto-show-${e}`,initial:"GATE",context:{config:t,canStartTimer:!1,isCancelled:!1},states:{GATE:{always:[{target:"WAITING",cond:"canStartTimer"},{target:"IDLE"}]},IDLE:{on:{SET_READY:{target:"GATE",actions:"setCanStartTimer"},RESET:{actions:"setIsCancelled"}}},WAITING:{after:{OPEN_DELAY:{target:"SHOWING",cond:"shouldOpen"}},on:{RESET:{target:"IDLE",actions:"setIsCancelled"}}},SHOWING:{entry:["openAppStore"],on:{SET_VISIBLE:{target:"VISIBLE",actions:"triggerOpenCallback"}}},VISIBLE:{after:{CLOSE_DELAY:{target:"CLOSING",cond:"shouldClose"}}},CLOSING:{entry:"closeAppStore"}}},((e,t=rr)=>({actions:{setCanStartTimer:K({canStartTimer:!0}),setIsCancelled:K({isCancelled:!0}),openAppStore:()=>{null==e||e.open({fallback:"off"})},closeAppStore:()=>{(null==e?void 0:e.isOpen())&&e.close()},triggerOpenCallback:e=>{var t,n;null==(t=(n=e.config).openCallback)||t.call(n)}},guards:{canStartTimer:e=>e.canStartTimer&&!e.isCancelled,shouldOpen:e=>!e.isCancelled&&!t.getValue().isLastChanceEndcardOverlayShowing,shouldClose:e=>{var t;return null!=(t=e.config.isAutoClose)&&t}},delays:{OPEN_DELAY:e=>{var t;return null!=(t=e.config.autoShowDelay)?t:0},CLOSE_DELAY:e=>{var t;return null!=(t=e.config.autoCloseDelay)?t:5e3}}}))(i));eX(()=>{t.enabled&&n&&!s.current&&a.value&&(o({type:"SET_READY"}),s.current=!0)},[n,a.value]),as("viewability",()=>{a.value=r.isViewable()}),as("app-store-orchestration",(e,t)=>{"skoVisible"===t.event&&o({type:"SET_VISIBLE"})}),eX(()=>()=>{o({type:"RESET"})},[])};let a1=()=>({id:"aak",initial:"IDLE",context:{openCount:0},states:{IDLE:{on:{OPEN:{actions:["updateOpenCount","openAak"]},SET_FALLBACK:{target:"FALLBACK"}}},FALLBACK:{on:{OPEN:{actions:"showFallback"}}},INITIAL:{},PREPARING:{},DONE:{}}}),a2=(e=tG.get(),t=r3())=>({actions:{openAak:()=>{e.openAppStore(2)},updateOpenCount:K({openCount:e=>e.openCount?e.openCount+1:1}),showFallback:()=>{t.emit("aakFallbackToSkpv")}}});class a3 extends d{canOpen(){var e;return null!=(e=this.interpreter.state.matches("IDLE")||this.interpreter.state.matches("FALLBACK"))&&e}fallback(){var e;null==(e=this.interpreter)||e.send({type:"SET_FALLBACK"}),this.open()}init(){}open(){this.interpreter.send({type:"OPEN"})}subscribe(e){return this.interpreter.subscribe(e)}constructor(e=a1,t=a2,n=j.get()){super(),this.machineConfig=e,this.machineOptions=t,this.stateMachineService=n;let i=this.stateMachineService.createMachine(this.machineConfig(),this.machineOptions());this.interpreter=this.stateMachineService.interpret(i),this.interpreter.start()}}a3.identifier=new o;class a6 extends d{openCTAWithMraid(){this.url&&this.mraidService.open(this.url)}handleOverlayViewCTA(){var e,t;(null==(e=this.storeKitOverlayService)?void 0:e.open())||null!=(t=this.productViewService)&&t.open()||this.openCTAWithMraid()}notifyClickEventToEDsp(){let{isClickEventFromIframe:e,url:t}=this;e&&t&&t.length>0&&(new Image().src=t)}handleIosProductViewCTA(){var e,t,n;if(null==(e=this.productViewService)||!e.isOpen())if(this.shouldReplaceShowStoreKitOverlay&&(null==(t=this.storeKitOverlayService)?void 0:t.open()))return;else this.adData.advertiser.appStoreId&&(null==(n=this.productViewService)?void 0:n.open())?this.notifyClickEventToEDsp():this.openCTAWithMraid()}handleAndroidProductViewCTA(){var e,t;if(null==(e=this.productViewService)?void 0:e.isOpen())return;let{inlineInstallUrl:n}=this.appStoreContext.getValue();n&&(null==(t=this.productViewService)?void 0:t.open())||this.openCTAWithMraid()}handleAdAttributionKitCTA(){var e,t;(null==(e=this.adAttributionKitService)?void 0:e.canOpen())?null==(t=this.adAttributionKitService)||t.open():this.handleIosProductViewCTA()}invoke(e){if(!this.tpatReportingService.hasExistingEvent({type:"tpat",event:"checkpoint.0"}))return;let{target:t,url:n,shouldReplaceShowStoreKitOverlay:i,isClickEventFromIframe:r,shouldFireMMP:a=!0}=e;if(a&&this.fireMMPEvents(),this.url=n||this.url,this.shouldReplaceShowStoreKitOverlay=null!=i&&i,this.isClickEventFromIframe=null!=r&&r,this.adData.device.os.is.iOS)switch(t){case nE.OFF:this.openCTAWithMraid();break;case nE.SKO:this.handleOverlayViewCTA();break;case nE.AAK:this.handleAdAttributionKitCTA();break;case nE.PV:default:this.handleIosProductViewCTA()}else if(this.adData.device.os.is.android)switch(t){case nE.OFF:this.openCTAWithMraid();break;case nE.PV:default:this.handleAndroidProductViewCTA()}else this.openCTAWithMraid()}fireMMPEvents(){let{scene:e}=this.sceneContext.getValue();if(!e)return;let t=e.getSceneType(),n=["image","endcard"].includes(t),i="video"===t,r="shouldSplitVideoEndcardClick"in e&&e.shouldSplitVideoEndcardClick;r||this.tpatReportingService.emit("clickUrl",!0),r&&i&&this.tpatReportingService.emit("clickUrl",!0),n&&this.tpatReportingService.emit("postroll.click",!0)}constructor(e=tG.get(),t=eo.getValue(),n=t3(rL),i=t3(rV),r=a3.getIfExists(),a=iP(),s=t2,o=tH){super(),this.mraidService=e,this.adData=t,this.productViewService=n,this.storeKitOverlayService=i,this.adAttributionKitService=r,this.tpatReportingService=a,this.sceneContext=s,this.appStoreContext=o,this.url="",this.shouldReplaceShowStoreKitOverlay=!1,this.isClickEventFromIframe=!1}}a6.identifier=new o;var a4=a6,a7=({fullScreenClickConfig:e,sceneId:t,shouldReplaceShowStoreKitOverlay:n,callToActionService:i=a4.get(),sceneEventReportingService:r=ns(),trackingEventMapConfig:a})=>as("fsc",(s,o)=>{var l,c;(null==(l=o.data)?void 0:l.scene_id)===t&&(null==e?void 0:e.enabled)&&(i.invoke({target:e.target,url:e.ctaUrl,shouldReplaceShowStoreKitOverlay:n}),rF("clickUrl",null==(c=o.data)?void 0:c.scene_id,a,!0),r.emit("click"))});let a5=(e,t=i$())=>{let n=t.find(t=>t.getId()===e);return n||t.filter(i8).map(t=>a5(e,t.getChildScenes())).find(Boolean)};var a8=a5,a9=(e,t=eo.getValue(),n=tH)=>{if(!t.advertiser.creative.is.adPodding)return;let i=n.getValue();n.setValue(I(g({},i),{appStoreId:e}))},se=({callToActionConfig:e,sceneId:t,shouldReplaceShowStoreKitOverlay:n,callToActionService:i=a4.get(),sceneEventReportingService:r=ns(),trackingEventMapConfig:a})=>as("cta",(s,o)=>{var l,c,d,u,h;let v=(e,t,n,a,s,o,l)=>{i.invoke({target:e,url:t,shouldReplaceShowStoreKitOverlay:l,isClickEventFromIframe:s,shouldFireMMP:o}),rF("clickUrl",n,a,!0),r.emit("click")};if("combinedEndcardCta"===o.event){let e=null==(u=o.data)?void 0:u.scene_id;if(!e)return;let t=a8(e);if(!iQ(t))return;let{appStoreId:n,shouldFireTpat:i}=t;a9(n);let{target:r,url:a}=t.getCallToActionConfig();v(r,a,e,t.getTrackingEventMapConfig(),!1,i);return}(null==(l=o.data)?void 0:l.scene_id)===t&&e&&v(e.target,null!=(h=null==(c=o.data)?void 0:c.cta_url)?h:e.url,null==(d=o.data)?void 0:d.scene_id,a,"endcardCta"===o.event,void 0,n)}),st=(e=document.documentElement)=>"ontouchstart"in e?"touchstart":"click",sn=(e,t,n=iT,i=ns)=>{eX(()=>{if(t)return()=>{};let e=e=>{n(e,i)};return document.body.addEventListener(st(),e,!0),()=>{document.body.removeEventListener(st(),e,!0)}},[e])},si=class{handleImageFailure(){this.smartDownloadQueueService.resume();let e=this.nextButtonService.placementSupportsNextButton(),t=this.scene.isChild();e&&!t&&this.sendAdEvent({type:"IMAGE_FAILURE"})}handleImageLoaded(){this.mraidEventReportingService.emit({type:"mraid-event",event:"readyToPlay"}),this.smartDownloadQueueService.resume(),this.revokeBlobUrl()}revokeBlobUrl(){this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)}decodeCachedImage(e,t){let{mimeType:n,data:i}=e;if(!n)return t;try{let e=new Uint8Array(i),t=new Blob([e],{type:n});return this.blobUrl=URL.createObjectURL(t),this.blobUrl}catch(e){return this.errorLoggingReportingService.emit({type:"error-logging",event:"resource",data:{error:{message:`Unable to decode cached image data: ${e}`},error_source:"resource",resource_url:t}}),t}}async getImageUrl(e){if(!/^https?:/i.test(e))return e;let t=this.smartDownloadQueueService.getCompletedItem(e);if(t)return this.decodeCachedImage(t,e);let n=await this.urlCacheService.get(e);return n?this.decodeCachedImage(n,e):await this.handleCurrentDownload(e)}async handleCurrentDownload(e){if(this.smartDownloadQueueService.getCurrentUrl()!==e)return e;let t=await this.smartDownloadQueueService.awaitDownload(e);return t?this.decodeCachedImage(t,e):e}constructor(e,t,n=new aN,i=nC.get(),r=ng.get(),a=t8(),s=eu()){this.sendAdEvent=e,this.scene=t,this.nextButtonService=n,this.smartDownloadQueueService=i,this.urlCacheService=r,this.errorLoggingReportingService=a,this.mraidEventReportingService=s}},sr=(e={})=>{var t,n;let{appStoreId:i,inlineInstallUrl:r}=e;t=[i,r],n=ez(eP++,4),!eH.__s&&e6(n.__H,t)&&(n.__=()=>{a9(i),((e,t=tH)=>{let n=t.getValue();t.setValue(I(g({},n),{inlineInstallUrl:e}))})(r)},n.u=t,eR.__h.push(n))};let sa=to(!1);var ss=({scene:e,sendAdEvent:t,customClassName:n,isBackgroundImage:i=!1,shouldRenderLastChanceEndcard:r=!0})=>{let a=tT(""),s=eZ(()=>new si(t,e),[e,t]),o=eZ(()=>e.getLastChanceEndcardConfig(),[e]),l=eQ(null),c=e.getId();aJ(c,e.getAppStoreOnDelayConfig()),a0(c,e.getStoreKitOverlayAutoShowConfig()),aF(l,t),aY(e),sr({inlineInstallUrl:e.getInlineInstallConfig().url}),a7({fullScreenClickConfig:sa.value?o.fsc:e.getFullScreenClickConfig(),sceneId:c}),se({callToActionConfig:sa.value?o.cta:void 0,sceneId:c});let d=eJ(e=>{sa.value=e},[]);return eX(()=>{t({type:"CREATIVE_VIEW"})},[]),sn(c,e.isChild()),eX(()=>{(async()=>{a.value=await s.getImageUrl(e.url)})()},[]),rm(eE,{children:[r&&rm(aK,{config:o,sendAdEvent:t,onVisibilityChange:d,sceneId:c}),rm("div",{className:null!=n?n:"J2DrKG_staticImageEndcard",style:i?{backgroundImage:`url(${e.url})`}:{},children:rm(aH,{config:e.getFullScreenClickConfig(),ctaUrl:e.getFullScreenClickConfig().ctaUrl,sceneId:c,children:[!e.isChild()&&!sa.value&&rm(aB,{config:e.getCloseButtonConfig(),sendAdEvent:t,showLastChanceEndcard:o.enabled}),a.value&&rm("img",{src:a.value,ref:l,alt:"image",id:c,onError:()=>{s.handleImageFailure()},onLoad:()=>{s.handleImageLoaded()}})]})})]})};class so extends window.Hls.DefaultConfig.abrController{onFragLoaded(e,t){if(t.frag.isCached)return;super.onFragLoaded(e,t);let n=this.hls;"main"===t.frag.type&&n.bandwidthEstimate>0&&n.bandwidthEstimate!==n.config.abrEwmaDefaultEstimate&&this.videoReportingService.emit({type:"video",event:"bandwidthEstimation",data:{bwe:Math.round(n.bandwidthEstimate/1024)}})}constructor(e){super(e),this.config=e,this.videoReportingService=nk()}}var sl=class{loadHls(e,t){let n,i,r=new window.Hls({maxLoadingDelay:4,maxStarvationDelay:4,fragLoadingMaxRetry:this.viewableService.isViewable()?3:360,pLoader:(n=this.scene,class extends window.Hls.DefaultConfig.loader{findMatchingManifestUrl(e,t,n){let i=Object.keys(n);for(let t of i)if(e.toLowerCase().endsWith(t.toLowerCase()))return t;if(1===i.length&&"0"===i[0]&&0===t)return"0"}openAndSendXhr(e,t,n){var i;if("manifest"===t.type&&(null==(i=this.cachedManifestMetadata.video)?void 0:i.manifest))return void this.loadFromString(this.cachedManifestMetadata.video.manifest,e,t);if(["level","audioTrack"].includes(t.type)){let n="level"===t.type?this.cachedManifestMetadata.video.tracks:this.cachedManifestMetadata.audio.tracks,i=this.findMatchingManifestUrl(t.url,t.id,n);if(i)return void this.loadFromString(n[i],e,t)}super.openAndSendXhr(e,t,n)}load(e,t,n,i=nk()){let{onSuccess:r}=n,a=(e,t,n,a)=>{var s;r(e,t,n,a);let o=null==(s=n.levelDetails)?void 0:s.startSN;"level"===n.type&&void 0!==o&&i.emit({type:"video",event:"hlsLevelPlaylistLoaded",data:{scene_id:this.scene.getId(),starting_sequence_number:o}})};super.load(e,t,I(g({},n),{onSuccess:a}))}loadFromString(e,t,n){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;let i={url:n.url,data:e,code:200};Promise.resolve().then(()=>{var e;null==(e=this.callbacks)||e.onSuccess(i,this.stats,n,t)})}constructor(){super(),this.scene=n,this.cachedManifestMetadata=new n1(this.scene).getCachedManifestMetadata()}}),fLoader:(i=this.scene,class extends window.Hls.DefaultConfig.loader{getOffset(e){var t,n;let i=e.findAll({where:{type:"video",event:"hlsLevelPlaylistLoaded",data:{scene_id:this.scene.getId()}}});return i.length>0&&null!=(n=null==(t=i[0].activity.data)?void 0:t.starting_sequence_number)?n:1}getFragmentInfo(e,t){var n,i,r;let a={shouldUseLocalFile:!1,localUrl:""};if(!["main","audio"].includes(e.type)||void 0===e.relurl)return a;let s="main"===e.type?"video":"audio";if("initSegment"===e.sn)a.localUrl=null!=(n=this.cachedManifestMetadata[s].chunk_init)?n:"";else{let n=this.getOffset(t);a.localUrl=null!=(r=(null!=(i=this.cachedManifestMetadata[s].chunks)?i:[])[e.sn-n])?r:""}return a.localUrl.endsWith(e.relurl.split("/").pop())||(a.localUrl=""),a.shouldUseLocalFile=nJ(a.localUrl),a}async load(e,t,n,i=nk()){let{shouldUseLocalFile:r,localUrl:a}=this.getFragmentInfo(e.frag,i);if(r)e.url=a,e.frag.isCached=!0,super.load(e,t,n);else{let r=ng.get(),a=await r.get(e.url);if(a){e.frag.isCached=!0;let r=this.getOffset(i);"initSegment"!==e.frag.sn&&e.frag.sn>r+1&&(e.frag.isCached=!1),this.context=e,this.loader={readyState:4,status:200,response:a.data},this.config=t,this.callbacks=n,this.loadedFromCache=!0,this.readystatechange()}else e.frag.isCached=!1,super.load(e,t,n)}}readystatechange(e,t=nk()){let{context:n,loader:i,stats:r}=this;if(!n||!i||r.aborted)return;if(4!==i.readyState)return void super.readystatechange();let{shouldUseLocalFile:a}=this.getFragmentInfo(this.context.frag,t);if(a){if(this.callbacks){let{onProgress:e}=this.callbacks;e&&e(r,n,i.response,i);let t={url:i.responseURL,data:i.response,code:200};Promise.resolve().then(()=>{this.callbacks.onSuccess(t,r,n,i)})}}else{var s;(null==(s=i.response)?void 0:s.byteLength)>=0&&!this.loadedFromCache&&ng.get().addRecord({url:n.url,data:new Uint8Array(i.response)}),super.readystatechange()}}constructor(){super(),this.scene=i,this.cachedManifestMetadata=new n1(this.scene).getCachedManifestMetadata()}}),abrController:so,lowLatencyMode:!1,useMediaCapabilities:!1,debug:!1});return i1(eh(),"maximized").pipe(ie(1)).subscribe({next:()=>{r.config.fragLoadingMaxRetry=3}}),this.addEventListeners(r,t),r.loadSource(e),r.attachMedia(t),r}canIgnoreError(e){switch(e.details){case window.Hls.ErrorDetails.BUFFER_NUDGE_ON_STALL:case window.Hls.ErrorDetails.BUFFER_SEEK_OVER_HOLE:return!0;case window.Hls.ErrorDetails.FRAG_PARSING_ERROR:var t;return(null==(t=e.frag)?void 0:t.type)==="audio"&&!0===e.frag.endList;default:return!1}}addEventListeners(e,t){e.on(window.Hls.Events.FRAG_BUFFERED,(e,n)=>{0!==t.buffered.length&&"main"===n.frag.type&&(t.currentTime<=0||t.currentTime<t.buffered.start(0))&&(t.currentTime=t.buffered.start(0))}),e.on(window.Hls.Events.LEVEL_SWITCHING,(t,n)=>{-1===e.currentLevel||e.bufferedToEnd||this.playedThrough||this.videoReportingService.emit({type:"video",event:"hlsLevelSwitched",data:{scene_id:this.scene.getId(),level:n.level,bitrate:e.levels[n.level].bitrate}})}),e.on(window.Hls.Events.ERROR,(n,i)=>{var r,a,s,o;let l=(null==i||null==(r=i.frag)?void 0:r.url)||(null==i||null==(a=i.context)?void 0:a.url);switch(i.type){case window.Hls.ErrorTypes.MEDIA_ERROR:if(i.details===window.Hls.ErrorDetails.BUFFER_STALLED_ERROR){if(t.currentTime>t.duration-2.5){t.currentTime=(null==(s=t.buffered)?void 0:s.end(0))||t.duration,this.playedThrough=!0,null==(o=this.stateMachineService.interpreterMap.get(this.scene.getId()))||o.send({type:"END"});return}this.videoReportingService.emit({type:"video",event:"hlsVideoStalled",data:{scene_id:this.scene.getId(),level:e.currentLevel,bitrate:e.levels[e.currentLevel].bitrate}})}else!this.canIgnoreError(i)&&(this.errorLoggingService.emit({type:"error-logging",event:"resource",data:{error:{message:`HLS media error: ${i.details}`,stack:Error(`HLS media error: ${i.details}`).stack},resource_url:l}}),i.fatal&&e.recoverMediaError());break;case window.Hls.ErrorTypes.NETWORK_ERROR:this.errorLoggingService.emit({type:"error-logging",event:"exception",data:{error:Error(`HLS network error: ${i.details}`)}}),i.details===window.Hls.ErrorDetails.FRAG_LOAD_ERROR&&this.videoReportingService.emit({type:"video",event:"hlsFragLoadError",data:{is_first_segment:0===t.buffered.length}});break;default:this.errorLoggingService.emit({type:"error-logging",event:"resource",data:{error:{message:`HLS ${i.fatal?"":"non-"}fatal error: ${i.details}`},resource_url:l}}),i.fatal&&(e.destroy(),this.videoReportingService.emit({type:"video",event:"hlsFatalError"}))}})}constructor(e,t=eo.getValue(),n=t8(),i=nk(),r=j.get(),a=tR.get()){this.scene=e,this.adData=t,this.errorLoggingService=n,this.videoReportingService=i,this.stateMachineService=r,this.viewableService=a,this.playedThrough=!1}},sc=class{startVideoMonitor(e,t,n){var i;n&&((null==(i=this.videoMonitorTimer)?void 0:i.getId())!=null&&this.videoMonitorTimer.destroy(),this.videoMonitorTimer=this.timerService.getNewTimer(1e4,()=>{if(!["AUTO_PLAY_FAIL","FAILED","DO_NOT_PLAY"].includes(rQ(e.value.value,"Video player service"))){if(!this.viewableService.isViewable())return void i1(this.viewabilityReportingService,"maximized").pipe(ie(1)).subscribe({next:()=>{this.startVideoMonitor(e,t,n)}});this.stopStreamingVideo(),t(tQ)}}),this.videoMonitorTimer.start())}stopVideoMonitor(){var e;null==(e=this.videoMonitorTimer)||e.destroy()}startStreamingVideo(e,t,n,i=new sl(this.scene,this.adData,this.errorLoggingService,this.videoReportingService,this.stateMachineService)){e.setAttribute("type","application/x-mpegURL"),window.Hls.isSupported()?(this.hlsLibraryInstance=i.loadHls(t,e),this.pictureInPictureService.setStopStreamingVideo(this.stopStreamingVideo.bind(this))):(this.observabilityReportingService.emit("hls-not-supported","hls-not-supported"),n({type:"NEXT"}))}stopStreamingVideo(){this.hlsLibraryInstance&&Promise.resolve(this.hlsLibraryInstance).then(e=>{var t;null==e||null==(t=e.destroy)||t.call(e)})}getMutedSignal(){return this.muteService.getMutedSignal()}constructor(e,t=H.get(),n=eo.getValue(),i=t8(),r=tU(),a=tx.get(),s=nk(),o=nI.get(),l=eh(),c=tR.get(),d=j.get()){this.scene=e,this.timerService=t,this.adData=n,this.errorLoggingService=i,this.observabilityReportingService=r,this.muteService=a,this.videoReportingService=s,this.pictureInPictureService=o,this.viewabilityReportingService=l,this.viewableService=c,this.stateMachineService=d,this.hlsLibraryInstance=void 0}};let sd="incentivized-dialog";class su extends rA{forfeitReward(){this.reportingService.emit({type:"incentivized-event",event:"forfeitReward",fireOnlyOnce:!0}),this.observabilityEventReportingService.emit("forfeit-reward")}closeWithForfeit(){this.forfeitReward(),this.close()}constructor(e=j.get(),t=tR.get(),n=eh(),i=ed(),r=tU()){super(rI(sd),rk(t,n),e),this.stateMachineService=e,this.viewableService=t,this.viewabilityReportingService=n,this.reportingService=i,this.observabilityEventReportingService=r}}su.identifier=new o;var sh=su,sv=class extends nY{getTransitions(){let e=super.getTransitions();return e.push(nq,nz,n$,nU,nH),e}getId(){return this.id}getSceneType(){return this.sceneType}getSceneIndex(){return this.injectedGetScenes().findIndex(e=>e.getId()===this.getId())}getObservabilityData(){return{scene_id:this.getId(),scene_type:this.getSceneType(),scene_index:this.getSceneIndex()}}addChildScenes(e){this.childScenes.push(...e),this.hideVideoProgressBar()}getChildScenes(){return this.childScenes}getChildSceneById(e){return this.childScenes.find(t=>t.getId()===e)}getCloseButtonConfig(e){let t=this.closeButtonConfigProvider.getCloseButtonConfig(e);return I(g({},t),{style:this.isLastPage()?nQ.CLOSE:t.style})}getLastChanceEndcardConfig(){return this.lastChanceEndcardConfig}setLastChanceEndcardConfig(e){this.lastChanceEndcardConfig=e}getEventStreams(){return this.eventStreams?this.eventStreams:((e=t0())=>{let t=ns(e);return{duration:n9(n4(t,"sceneStart"),n4(t,"sceneEnd")),modular_video_close:((e=t0())=>new n2(t=>{let n,i=n4(ns(e),"sceneEnd"),r=iO(e,"progress").pipe(n8(i),ia(e=>e.data.scene_id),n3(e=>e!==n)).subscribe({next:e=>{n=e},error:e=>{var n;return null==(n=t.error)?void 0:n.call(t,e)},complete:()=>{var e;t.next(n),null==(e=t.complete)||e.call(t)}});return{unsubscribe:()=>{r.unsubscribe()}}}))(e),modular_video_transition:((e=t0(),t=tU(e))=>new n2(n=>{let i=n4(ns(e),"sceneEnd"),r=new Map,a=n6(e,"modular-event").pipe(n3(e=>"transition"===e.event)).pipe(n8(i)).subscribe({next:e=>{let{scene_id:t,transition:n}=e.data,i=r.get(t)||[];r.set(t,[...i,n])},error:e=>{var t;return null==(t=n.error)?void 0:t.call(n,e)},complete:()=>{var e;if(null==(e=n.complete)||e.call(n),r.size>0){let e=[].concat(...Array.from(r.entries()).map(([e,t])=>t.map(t=>({name:"modular-video-user-interaction",metric:"modular-video-user-interaction",modular_video_id:e,transition:t}))));t.emit({type:"observability",event:"event",data:e})}}});return{unsubscribe:()=>{a.unsubscribe()}}}))(e),modular_video_watched_duration:((e=t0(),t=tU(e))=>new n2(n=>{let i=n4(ns(e),"sceneEnd"),r=new Map,a=iO(e,"progress").pipe(n8(i)).subscribe({next:e=>{let t,{current_time:n=0,scene_id:i}=e.data||{};i&&(t=r.get(i)||0,r.set(i,Math.max(t,n)))},error:e=>{var t;return null==(t=n.error)?void 0:t.call(n,e)},complete:()=>{var e;let i;null==(e=n.complete)||e.call(n),i=Array.from(r.entries()).map(([e,t])=>({name:"modular-video-complete",metric:"modular-video-complete",modular_video_id:e,duration:t})),t.emit({type:"observability",event:"event",data:i})}});return{unsubscribe:()=>{a.unsubscribe()}}}))(e)}})()}hideVideoProgressBar(){this.childScenes.forEach(e=>{if(iQ(e)){let t=e.getProgressBarConfig();t&&(t.show=!1,e.progressBarConfig=t)}})}constructor({id:e,children:t,isFullscreen:n,closeButtonConfigProvider:i,lastChanceEndcardConfig:r,eventStreams:a,injectedGetScenes:s=i$,childScenes:o=[]}){super({isFullscreen:n}),this.childScenes=[],this.id=e,this.children=t,this.closeButtonConfigProvider=i,this.lastChanceEndcardConfig=r,this.sceneType="modular",this.eventStreams=a,this.childScenes=o,this.injectedGetScenes=s,this.addExitAction({name:"finishVideoOmsdkSession"})}},sp=function(e){return e instanceof sv&&"modular"===e.getSceneType()};let sg=new Set(["internal-minimized","internal-maximized"]),sm="storyProgress";var sf=({sendAdEvent:e,isMuted:t,isVisible:n,videoPlayerHeight:i,videoElement:r,videoPlayerWrapRef:a,theatreModeReportingService:s=nO()})=>{let o={marginLeft:"0px",marginTop:"0px"},l=tT(o),[c,d]=e$(!1),u=()=>{if(!n)return;let e=document.getElementsByClassName(sm);if(!r)return;let t=a.current;if(!t)return;let i=g({},o),{videoWidth:s,videoHeight:c}=r;if(0===s||0===c)return;let{clientWidth:u,clientHeight:h}=t;if(0===u||0===h)return;let v=s/c,p=(h-u/v)/2;u/h>v?i.marginLeft=`${(u-h*v)/2}px`:i.marginTop=`${p}px`,e.length>0&&(i.marginTop=`${Math.max(p,18)}px`),l.value=i,d(!0)};eX(()=>(window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u)})),eX(()=>{if(r)return r.addEventListener("loadeddata",u),()=>{r.removeEventListener("loadeddata",u)}},[r]),eX(()=>{u()},[n,i]);let h=ah(s);return n&&c?rm("button",{type:"button","data-id":id,className:ar(t?"S2LOeW_muted":"S2LOeW_unmuted",h.value?"fadeIn":"fadeOut"),title:t?"Unmute":"Mute","aria-label":"Mute button",style:l.value,onClick:()=>{e({type:t?"UNMUTE":"MUTE"})},children:rm("span",{className:"S2LOeW_icon"})}):null},sS=({value:e,duration:t,progressBarConfig:{show:n,color:i},paused:r,isLooping:a=!1,theatreModeReportingService:s=nO()})=>{let o=ah(s);return n?rm("div",{role:"progressbar",title:"Video progress",className:ar("OaF7uW_videoProgress",o.value?"fadeIn":"fadeOut"),"aria-label":"Video progress",children:rm("span",{className:!r&&e>0?"":"OaF7uW_paused",style:{backgroundColor:i,animationDuration:`${t}s`,animationIterationCount:a?"infinite":"1"},title:"Video progress bar"})}):null},sy=({sendVideoEvent:e,sendAdEvent:t,videoState:n,scene:i,onMetadataLoaded:r,canMuteAudio:a=!0,theatreModeReportingService:s})=>{var o,l;let d=new sc(i),u=eZ(()=>eh(),[]),{url:h}=i,v=eQ(null),p=eQ(null),g=tT(0),m=tT(h),f=nC.get(),S=tR.get(),y=tG.get(),C=d.getMutedSignal(),E=tT(""),_=t=>{e({type:t,eventTarget:v.current,url:m.value})},b=()=>{S.isViewable()?_("CAN_PLAY"):_("AWAIT_VIEWABILITY"),t({type:"PRIVACY_LOGO_SHOW"})},w=e=>{let{buffered:t,currentTime:n}=e;if(1===t.length)return t.end(0)-n;for(let e=0;e<t.length;e+=1)if(n>=t.start(e)&&n<=t.end(e))return t.end(e)-n;return 0},T=0;as("scene-event",(e,t)=>{"nextButtonCountdownTick"===t.event&&t.data.scene_id===i.getId()&&t.data.delay&&(T=t.data.delay)});let A=e=>{let t=w(e),i=e.duration-e.currentTime,{loopCount:r}=n.value.context,a=Number.isInteger(r)&&r>0;t>5&&i>=5&&!a&&(T>=5||!S.isViewable())?f.resume():f.pause()},I=n=>{d.stopVideoMonitor(),t({type:"VIDEO_ERROR",error:Error(n),video_url:m.value}),e({type:"FAIL"}),i.getLastChanceEndcardConfig().enabled&&(t({type:"LAST_CHANCE_ENDCARD"}),t({type:"PRIVACY_LOGO_SHOW"})),t({type:"VIDEO_FAILURE",scene_id:i.getId()})},k=()=>{setTimeout(()=>{v.current&&v.current.muted!==C.value&&(v.current.muted=C.value)},100)};if(eX(()=>{var r,a,o;switch(n.value.value){case"LOADING":(()=>{if(v.current&&m.value){let{loadAttempts:a}=n.value.context;if(0===a){var t,r;t=v.current,(null==(r=i.getOmsdkConfig())?void 0:r.enabled)&&r.data&&c.getInstance().bindService(rb,new rb(t,r.data)),v.current.setAttribute("muted","true"),v.current.addEventListener("playing",()=>{_("TIME_UPDATE"),d.stopVideoMonitor()}),d.startVideoMonitor(n,I,v.current)}if("hls"===i.videoType)E.value=m.value;else{if(a>9)return y.notifyFailToLoad();let t=a<2?0:1e3*Math.pow(2,a-1),i=H.get().getNewTimer(t,()=>{v.current&&0==w(v.current)&&(v.current.setAttribute("src",m.value),v.current.load())});i.start(),0==a&&i1(u,"maximized").pipe(ie(1)).subscribe({next:()=>{setTimeout(()=>{i.destroy()},0),n.value.context.loadAttempts>4&&v.current&&0==w(v.current)&&e({type:"LOAD_FAIL"})}})}}})();break;case"PLAYING":let l;(l=null==(r=v.current)?void 0:r.play())?l.then(k).catch(t=>{let n=t.name.toLowerCase();"notallowederror"===n?e({type:"AUTO_PLAY_FAIL"}):"aborterror"===n||I(tZ)}):window.setTimeout(()=>{if("PLAYING"===n.value.value){var t;0===(null==(t=document.getElementsByTagName("video")[0])?void 0:t.currentTime)&&e({type:"AUTO_PLAY_FAIL"})}},2500);break;case"LOAD_FAIL_RETRY":let h;e({type:"RETRY"}),(h=i.originalVideoUrl)&&h!==m.value?m.value=h:S.isViewable()&&I(tX);break;case"PAUSED":(null==(a=v.current)?void 0:a.paused)||null==(o=v.current)||o.pause();break;case"ENDED":if(1===i.loopVideo){if(requestAnimationFrame(()=>{e({type:"PLAY"})}),aP()){let e=t3(rV);null==s||s.emit({type:"theatre-mode-event",event:"revealControls"}),i.storeKitOverlayAutoShowConfig.enabled&&(null==e||e.open())}}else if(0===i.loopVideo){let n=i.getLastChanceEndcardConfig().enabled;e({type:"CLOSE"}),t(n?{type:"LAST_CHANCE_ENDCARD"}:{type:"COMPLETE"})}}},[n.value.value]),tL(()=>{""!==E.value&&v.current&&d.startStreamingVideo(v.current,E.value,t)}),tL(()=>{var e,t;v.current&&(null==(e=(t=n.value).matches)?void 0:e.call(t,"PLAYING"))&&v.current.muted!==C.value&&(v.current.muted=C.value)}),tL(()=>()=>{d.stopVideoMonitor()}),as("viewability",(e,t)=>{if("internal-maximized"===t.event&&n.value.matches("AWAITING_VIEWABILITY"))return e.emit({type:"viewability",event:"maximized"});((e,t,n=rf(null==t?void 0:t.getId()),i=sh.getIfExists(),r=tR.get(),a=j.get(),s=t2.getValue().scene)=>{if(iQ(t)&&n&&(null==i||!i.isOpen()||sg.has(e.event))){if(t.isChild()&&sp(s)){let e,n=(e=s.getId(),a.interpreterMap.get(e));if((null==n?void 0:n.state.value)!==t.getId())return}nT(e,n,r)}})(t,i)},u),eX(()=>{let e=t=>{v.current&&(v.current.readyState>2?b():H.get().getNewTimer(t,()=>{e(t)}).start())};return e(200),()=>{i.isPictureInPictureEnabled||d.stopStreamingVideo()}},[]),"FINAL"===n.value.value&&(null==(o=i.getLastChanceEndcardConfig().appMeta)?void 0:o.icon))return null;let O=(n.value.context.currentTime>0||i.isChild())&&a;return rm("div",{className:ar("ok_seq_videoPlayerWrap","videoPlayer"),ref:p,id:i.getId(),children:[rm(sf,{sendAdEvent:t,isMuted:C.value,isVisible:O,videoElement:v.current,videoPlayerWrapRef:p,videoPlayerHeight:null==(l=p.current)?void 0:l.clientHeight}),rm("video",{title:"Video player",ref:v,muted:!0,playsInline:!0,controls:!1,className:"ok_seq_videoPlayer",poster:n.value.context.duration>0?void 0:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQAAAAA3bvkkAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAnRSTlMAAHaTzTgAAAACYktHRAAB3YoTpAAAAAd0SU1FB+YHDAoSGnw+PegAAAAKSURBVAjXY2AAAAACAAHiIbwzAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIyLTA3LTEyVDEwOjE4OjI2KzA4OjAww+Ou8wAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMi0wNy0xMlQxMDoxODoyNiswODowMLK+Fk8AAAAASUVORK5CYII=",onError:()=>{m.value!==h&&S.isViewable()?I(tz):_("LOAD_FAIL")},onDurationChange:()=>{_("DURATION_CHANGE")},onWaiting:()=>{_("WAITING"),f.pause()},onSuspend:()=>{_("SUSPEND"),f.pause()},onCanPlay:b,onProgress:e=>{let{target:t}=e;if(null!==t){let e=w(t);(e>5||e>0&&t.duration<6&&e>t.duration-1)&&eu().emit({type:"mraid-event",event:"readyToPlay"}),A(t)}},onTimeUpdate:t=>{let{target:i}=t;A(i);let r="PLAYING"!==n.value.value;Number.isNaN(i.duration)||0===i.duration||i.seeking||r||(g.value=i.currentTime,e({eventTarget:i,type:"TIME_UPDATE"}))},onEnded:()=>{g.value=0,e({type:"END"})},onSeeking:e=>{let t=e.target,n=t.currentTime-g.value;!(t.readyState<3)&&Math.abs(n)>3&&(t.currentTime=g.value)},"data-loop-count":n.value.context.loopCount,"data-scene-id":i.getId(),disableRemotePlayback:!0,onLoadedMetadata:()=>{null==r||r()},preload:"auto"}),rm(sS,{value:n.value.context.progress,duration:n.value.context.duration,isLooping:1===i.loopVideo,paused:"PAUSED"===n.value.value,progressBarConfig:i.getProgressBarConfig()})]})},sC=({isInLine:e=!1,sceneId:t})=>{let n=eQ(null),i=eQ(null),r=eQ(),a=eQ(),s=rf(t),o=tT(!1),l=tT(window.document.body.clientWidth),c=tT(window.document.body.clientHeight),d=tT(0),u=tT(0),h=tT(0),v=tT(0),p=null==s?void 0:s.state.context.videoElement,g=null==s?void 0:s.state.context.canPlay,m=()=>{var e,t;n.current&&(l.value=null==(e=n.current)?void 0:e.clientWidth,c.value=null==(t=n.current)?void 0:t.clientHeight)},f=()=>{if(!p)return;let t=p.videoHeight>p.videoWidth;o.value=(e||t)&&!!p&&(!!e||p.videoWidth/p.videoHeight<l.value/c.value)},S=()=>{var e;m(),null==(e=r.current)||e.clearRect(0,0,h.value,v.value),f()};return eX(()=>{p&&(d.value=p.clientHeight,u.value=p.clientWidth),f()},[null==p?void 0:p.clientHeight,null==p?void 0:p.clientWidth,r.current]),eX(()=>(g&&(window.addEventListener("resize",S),m(),(()=>{if(!p)return;let{videoWidth:e,videoHeight:t}=p;if(i.current&&l.value&&c.value&&e&&t&&c.value){var n;let a=e/l.value,s=t/c.value,o=e/t<l.value/c.value?a:s,d=Math.floor(e/o),u=Math.floor(t/o);r.current=null==(n=i.current)?void 0:n.getContext("2d"),h.value=d,v.value=u}})(),a.current=tY.get().getNewInterval(60,()=>{o.value&&r.current&&r.current.drawImage(p,0,0,h.value,v.value)}),a.current.start()),()=>{var e;window.removeEventListener("resize",S),null==(e=a.current)||e.destroy()}),[g]),rm("div",{title:"Video blur",ref:n,className:"RypQCq_videoBlurWrap",children:rm("canvas",{title:"Video blur canvas",ref:i,width:h,height:v})})},sE=({isVisible:e,sendVideoEvent:t})=>e?rm("div",{role:"none",className:"dDtiqq_tapToPlayMask",onClick:()=>{var e;null==(e=document.getElementsByTagName("video")[0])||e.play(),t({type:"PLAY"})},title:"Tap to play",children:rm("div",{className:"dDtiqq_tapToPlayContainer",children:[rm("div",{className:"dDtiqq_tapToPlayIcon"}),rm("div",{className:"dDtiqq_tapToPlayText",children:"Tap to play"})]})}):null,s_=class{getFadeInClass(e){var t;return this.storeKitOverlayAutoShowConfig.enabled&&(null==(t=this.storeKitOverlayService)?void 0:t.isOpen())?e?"fadeIn":"fadeOut":"fadeIn"}constructor(e,t=t3(rV)){this.storeKitOverlayAutoShowConfig=e,this.storeKitOverlayService=t}},sb=({callToActionReportingService:e,sceneId:t,storeKitOverlayAutoShowConfig:n,theatreModeReportingService:i=nO(),storeKitOverlayService:r=t3(rV),service:a=new s_(n,r)})=>{let s="Download button",o=ah(i);return rm("button",{className:ar("Zz6y0G_download",a.getFadeInClass(o.value)),title:s,"aria-label":s,type:"button",onClick:()=>{e.emit({type:"cta",event:"downloadButtonCta",data:{scene_id:t}})},children:rm("span",{className:"Zz6y0G_downloadIcon"})})},sw=({id:e="star",index:t=0,size:n,offset:i=100})=>{let r=`${e}-gradient-${t}`;return rm("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,height:n,viewBox:"0 0 100 100",children:[rm("defs",{children:rm("linearGradient",{id:r,x1:"0",x2:"100%",y1:"0",y2:"0",children:[rm("stop",{offset:"0%","stop-color":"#ffd055"}),rm("stop",{offset:`${i}%`,"stop-color":"#ffd055"}),rm("stop",{offset:`${i}%`,"stop-color":"#ddd"})]})}),rm("path",{d:"M50,0,64.69463130731182,29.774575140626315,97.55282581475768,34.54915028125263,73.77641290737884,57.72542485937368,79.38926261462366,90.45084971874736,50,75,20.61073738537635,90.45084971874738,26.223587092621162,57.72542485937369,2.447174185242318,34.549150281252636,35.30536869268816,29.774575140626318Z",fill:`url(#${r})`,"stroke-linejoin":"round","stroke-linecap":"round"})]})},sT=class{getOffsetPercent(e,t){let n=Math.floor(t);return e<n?100:e>n?0:Math.ceil(t%1*100/this.unitValue)*this.unitValue}constructor(){this.unitValue=10}};let sA=12,sI=5,sk=0;var sO=({size:e=sA,count:t=sI,value:n=sk,onClick:i=()=>{console.warn("StarRating: onClick not implemented")}})=>{let r=[],a=new sT;for(let i=0;i<t;i+=1){let t=a.getOffsetPercent(i,n);r.push(rm(sw,{id:`star-${i}-${e}-${t}`,index:i,size:e,offset:t},i))}return rm("span",{onClick:i,children:r})},sD=class{getVideoComputedHeight(){let e=this.injectedGetVideoInterpreter(this.sceneId),t=null==e?void 0:e.state.context.videoElement;if(!t)return 0;let n=t.videoWidth/t.videoHeight;return Number.isNaN(n)?0:parseFloat(window.getComputedStyle(t).getPropertyValue("width"))/n}updateScreenshotsHeight(e){if(!e.current)return;let t=this.getVideoComputedHeight();if(0===t)return;let n=window.innerHeight-t-120;n>=100?e.current.style.height=`${n}px`:e.current.style.display="none"}handleClick(e,t){if(t){e.preventDefault(),e.stopPropagation(),this.ctaReportingService.emit({type:"cta",event:"persistentCta",data:{scene_id:this.sceneId}}),this.sceneEventReportingService.emit("ctaButtonClick");return}this.fullScreenClickConfig.enabled&&this.fullCtaReportingService.emit({type:"fsc",event:"fsc",data:{scene_id:this.sceneId}})}constructor(e,t,n,i=n_(),r=nb(),a=ns(),s=rf){this.fullScreenClickConfig=e,this.sceneId=t,this.storeKitOverlayAutoShowConfig=n,this.ctaReportingService=i,this.fullCtaReportingService=r,this.sceneEventReportingService=a,this.injectedGetVideoInterpreter=s}};let sV=to(!1);var sL=({fullScreenClickConfig:e,callToActionConfig:t,storeKitOverlayAutoShowConfig:n,sceneId:i,sceneEventReportingService:r=ns(),timerService:a=H.get(),ctaReportingService:s=n_(),fullCtaReportingService:o=nb()})=>{var l,c,d,u,h,v;let p=new sD(e,i,n,s,o,r),m=e=>{p.handleClick(e,!0)};return eX(()=>{a.getNewTimer(1e3*t.delay,()=>{sV.value=!0,r.emit("ctaButtonShow")}).start()},[]),rm("div",{title:il,className:ar("UUyEIq_persistentSimpleCta",sV.value?"UUyEIq_slideIn":""),style:g({},(null==(l=t.position)?void 0:l.right)?{right:t.position.right}:{},(null==(c=t.position)?void 0:c.bottom)?{bottom:t.position.bottom}:{}),"aria-hidden":"true",onClick:e=>p.handleClick(e,!1),children:[(null==(d=t.appMeta)?void 0:d.icon)&&rm("img",{className:"UUyEIq_appIcon",onClick:m,alt:"app-icon",src:t.appMeta.icon}),((null==(u=t.appMeta)?void 0:u.name)||(null==(h=t.appMeta)?void 0:h.company))&&rm("div",{className:"UUyEIq_appDetail",title:"Persistent simple CTA app detail",children:[t.appMeta.name&&rm("h1",{onClick:m,children:t.appMeta.name}),t.appMeta.company&&rm("h2",{onClick:m,children:t.appMeta.company}),t.appMeta.isRatingGreaterThanMinimum&&rm(sO,{value:t.appMeta.rating,onClick:m})]}),rm("button",{"aria-label":ic,className:"UUyEIq_persistentSimpleCtaBtn",style:(null==(v=t.background)?void 0:v.color)?{backgroundColor:t.background.color}:{},type:"button",onClick:m,"data-id":ic,"data-scene-id":i,children:t.text})]})},sN=({fullScreenClickConfig:e,callToActionConfig:t,storeKitOverlayAutoShowConfig:n,sceneId:i,sceneEventReportingService:r=ns(),ctaReportingService:a=n_(),fullCtaReportingService:s=nb()})=>{var o,l,c,d,u,h,v,p;let g=new sD(e,i,n,a,s,r),m=e=>{g.handleClick(e,!0)};eX(()=>{let e=document.createElement("style");return e.textContent=`
    .videoPlayer {
      width: 100%;
      height: auto;
      margin-top: 120px;
    }
    `,document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]),eX(()=>{r.emit("ctaButtonShow")},[]);let f=null==(o=t.appMeta)?void 0:o.isRatingGreaterThanMinimum;return rm("div",{title:"Persistent rich CTA",className:"DwKKSa_persistentRichCta",onClick:e=>g.handleClick(e,!1),"aria-hidden":"true",children:[(null==(l=t.appMeta)?void 0:l.icon)&&rm("img",{className:"DwKKSa_appIcon",alt:"app-icon",onClick:m,src:null==(c=t.appMeta)?void 0:c.icon}),rm("div",{className:"DwKKSa_appInfo",children:[(null==(d=t.appMeta)?void 0:d.name)&&rm("h1",{onClick:m,children:null==(u=t.appMeta)?void 0:u.name}),f&&rm(sO,{value:null==(h=t.appMeta)?void 0:h.rating,onClick:m}),!f&&rm("p",{onClick:m,children:null==(v=t.appMeta)?void 0:v.company}),rm("button",{className:"DwKKSa_persistentRichCtaBtn",type:"button",style:(null==(p=t.background)?void 0:p.color)?{backgroundColor:t.background.color}:{},onClick:m,"data-id":io,children:t.text})]})]})},sx=({fullScreenClickConfig:e,callToActionConfig:t,storeKitOverlayAutoShowConfig:n,sceneId:i,sceneEventReportingService:r=ns(),ctaReportingService:a=n_(),fullCtaReportingService:s=nb()})=>{var o;let l=new sD(e,i,n,a,s,r),c=eQ(null);eX(()=>{l.updateScreenshotsHeight(c)},[window.innerHeight,window.innerWidth]);let d=null==(o=t.appMeta)?void 0:o.screenshots;return d&&0!==d.length?rm("div",{title:"Persistent rich CTA screenshots",ref:c,className:"dalDea_persistentRichCtaScreenshots",onClick:()=>{e.enabled?nb().emit({type:"fsc",event:"fsc",data:{scene_id:i}}):n_().emit({type:"cta",event:"persistentCta",data:{scene_id:i}})},"aria-hidden":"true",children:d.map(e=>e&&rm("div",{className:"dalDea_slide",children:rm("img",{alt:e,src:e})},e))}):null},sP=({videoOrientation:e,viewportOrientation:t,scene:n,disableRichCta:i=!1})=>{var r,a;if("unknown"===e)return null;let s=n.getId();return!i&&"landscape"===e&&"portrait"===t&&(null!=(a=null==(r=n.getCallToActionConfig().appMeta)?void 0:r.screenshots)?a:[]).length>0?rm(eE,{children:[rm(sN,{fullScreenClickConfig:n.getFullScreenClickConfig(),callToActionConfig:n.getCallToActionConfig(),storeKitOverlayAutoShowConfig:n.getStoreKitOverlayAutoShowConfig(),sceneId:s}),rm(sx,{fullScreenClickConfig:n.getFullScreenClickConfig(),callToActionConfig:n.getCallToActionConfig(),storeKitOverlayAutoShowConfig:n.getStoreKitOverlayAutoShowConfig(),sceneId:s})]}):rm(sL,{fullScreenClickConfig:n.getFullScreenClickConfig(),callToActionConfig:n.getCallToActionConfig(),storeKitOverlayAutoShowConfig:n.getStoreKitOverlayAutoShowConfig(),sceneId:s})},sR=(e,t,n,i,r=iP(),a=rB())=>{let s=iL(e,t);iV.slice(0,s+1).filter(e=>!r.hasExistingEvent({type:"tpat",event:e})).forEach(i=>{r.emit(i,!0,{progress:n,current_time:e,duration:t})}),rF(iV[s],i.getId(),i.getTrackingEventMapConfig(),!0,a)};let sM=e=>"eventTarget"in e?e.eventTarget:null;var sB=class{getCloseButtonDelaySeconds(e,t){return void 0===e||Number.isNaN(e)||e<=0?6:this.injectedIsVideoUnskippable(e,this.adData.placement.is.fullscreen,t)?e:t}getCloseButtonCountDown(e,t){return!(void 0===e||Number.isNaN(e))&&!(e<=0)&&t}getCloseButtonStyle(e,t){return e?nQ.CLOSE:t}async getCloseButtonConfig(e,t){let n=e.getCloseButtonConfig({videoDuration:t}),i=e.isLastPage(),r={delay:this.getCloseButtonDelaySeconds(t,n.delay),style:this.getCloseButtonStyle(i,n.style),countdown:this.getCloseButtonCountDown(t,n.countdown)},a=this.injectedIsVideoUnskippable(null!=t?t:6,this.adData.placement.is.fullscreen,n.delay);return this.amplifyEndcardEngagementService&&!a&&(r.delay=await this.amplifyEndcardEngagementService.getVideoCloseButtonDelayWithUserActivity(r.delay)),r}shouldReplaceShowStoreKitOverlay(){var e;return!!(this.storeKitOverlayService&&this.adData.placement.is.fullscreen&&(null==(e=this.productViewService)?void 0:e.isDone()))}getFullScreenClickConfig(e,t,n){return this.injectedIsTheatreModeActive()?{enabled:!1}:e?null!=n?n:{enabled:!1}:t}constructor(e=t3(rV),t=t3(rL),n=eo.getValue(),i=rW.getIfExists(),r=rE,a=aP){this.storeKitOverlayService=e,this.productViewService=t,this.adData=n,this.amplifyEndcardEngagementService=i,this.injectedIsVideoUnskippable=r,this.injectedIsTheatreModeActive=a}},sF=(e,t=sh.getIfExists(),n=ed())=>i=>{if(["NEXT","LAST_CHANCE_ENDCARD"].includes(i.type)){if(!n.hasExistingEvent({type:"incentivized-event",event:"grantReward"})){null==t||t.open();return}null==t||t.close()}e(i)},sU=(e=eo.getValue())=>e.placement.is.rewarded&&!e.advertiser.creative.is.freeForm,sH=(e,t)=>{var n,i;let r=rb.getIfExists();if(r)switch(t.event){case"durationChange":{let e=(null==(n=t.data)?void 0:n.duration)||0;r.onVideoMetadataAvailable(e),r.onVideoDisplayState("fullscreen");break}case"waiting":case"suspend":r.onVideoBuffering();break;case"timeUpdate":r.onVideoTimeUpdate(),r.onVideoCheckpoint();break;case"mute":case"unmute":r.onSoundChange(t.event);break;case"play":case"pause":r.onVideoStateChanged(t.event);break;case"close":(null==(i=t.data)?void 0:i.is_video_fully_played)||r.onVideoPageClose();break;case"downloadButtonCta":case"fsc":r.onCtaClick()}},sW=({dialogTitle:e,dialogText:t,isVisible:n,title:i,children:r})=>rm("div",{title:null!=i?i:"Dialog",role:"dialog",className:"W6zMza_dialogBox",style:{visibility:n?"visible":"hidden"},children:rm("div",{className:"W6zMza_dialog",children:rm("div",{className:"W6zMza_dialogContent",children:[rm("div",{className:"W6zMza_dialogTitle",children:e}),rm("div",{className:"W6zMza_dialogBody",children:[rm("div",{className:"W6zMza_dialogText",children:t}),rm("div",{className:"W6zMza_dialogActions",children:r})]})]})})}),sG=({sendAdEvent:e,showLastChanceEndcard:t=!1,adData:n=eo.getValue(),incentivizedDialogService:i=sh.getIfExists()})=>{let[r]=aa(sd);return sU(n)?rm(sW,{title:"Incentivized dialog",dialogTitle:n.incentivized.title,dialogText:n.incentivized.body,isVisible:r.value.matches("SHOWING"),children:rm(eE,{children:[rm("div",{className:"tikWIq_primaryButton",children:rm("button",{className:"primary",type:"button",title:"Incentivized dialog continue",onClick:()=>{null==i||i.close()},children:[n.incentivized.continue,rm("span",{className:"tikWIq_continueIcon",title:"Incentivized dialog continue icon"})]})}),rm("div",{className:"tikWIq_secondaryButton",children:rm("button",{className:"secondary",type:"button",title:"Incentivized dialog close",onClick:()=>{null==i||i.closeWithForfeit(),e({type:t?"LAST_CHANCE_ENDCARD":"NEXT"})},children:n.incentivized.close})})]})}):null};let sK=to(!1),sj=to(!1);var sY=({scene:e,sendAdEvent:t,showVideoBlur:n=!1,adData:i=eo.getValue(),theatreModeReportingService:r,shouldRenderLastChanceEndcard:a=!0,onVideoStateChange:s})=>{let o=e.getStoreKitOverlayAutoShowConfig().enabled,l=eZ(()=>e.getLastChanceEndcardConfig(),[e]),c=new sB,[d,u]=rX({id:e.getId(),initial:"LOADING",context:{currentTime:0,duration:0,frameRateMeasured:!1,progress:0,videoElement:null,loadAttempts:-1,canPlay:!1,loopCount:0,orientation:"unknown",id:e.getId()},states:{LOADING:{entry:["incrementLoadAttempts","emitLoad"],on:{LOAD_FAIL:{target:"LOAD_FAIL_RETRY"},AWAIT_VIEWABILITY:{target:"AWAITING_VIEWABILITY",actions:"setMetadata"},CAN_PLAY:{target:"PLAYING",actions:["setMetadata","reportVideoStart","setCanPlay"]},PAUSE:"STALLED",DURATION_CHANGE:{actions:"emitDurationChange"},WAITING:{actions:"emitWaiting"},SUSPEND:{actions:"emitSuspend"},FAIL:"FAILED"}},LOAD_FAIL_RETRY:{on:{RETRY:"LOADING",FAIL:"FAILED"}},AWAITING_VIEWABILITY:{entry:"emitAwaitingViewability",on:{MAXIMIZE:{target:"PLAYING",actions:["reportVideoStart","setCanPlay"]}}},PLAYING:{entry:"emitPlay",on:{MINIMIZE:{target:"PAUSED",actions:"updateCurrentTime"},PAUSE:"PAUSED",END:{target:"ENDED",actions:"emitVideoCompleteEvents"},RESTART:{actions:["pauseVideoElement","resetProgress","resetCurrentTime","playVideoElement"]},AUTO_PLAY_FAIL:"AUTO_PLAY_FAIL",TIME_UPDATE:{actions:["updateProgress","emitProgress","emitCheckpointEvent","emitTimeUpdate","measureFrameRate"]},SUSPEND:{actions:"emitSuspend"},WAITING:{actions:"emitWaiting"},CLOSE:{target:"FINAL",actions:"emitClose"}}},STALLED:{on:{AWAIT_VIEWABILITY:{target:"DO_NOT_PLAY",actions:"setMetadata"},CAN_PLAY:{target:"DO_NOT_PLAY",actions:"setMetadata"},PLAY:"LOADING"}},DO_NOT_PLAY:{on:{PLAY:{target:"PLAYING",actions:["reportVideoStart","setCanPlay"]}}},PAUSED:{entry:"emitPause",on:{MINIMIZE:{actions:"updateCurrentTime"},CAN_PLAY:{actions:"setCanPlay"},MAXIMIZE:{target:"PLAYING",actions:"resetCurrentTime"},PLAY:"PLAYING",TIME_UPDATE:{actions:["updateProgress","emitProgress","emitCheckpointEvent","measureFrameRate"]},AUTO_PLAY_FAIL:"AUTO_PLAY_FAIL",CLOSE:{target:"FINAL",actions:"emitClose"},RESET_PLAY:{actions:["resetProgress","resetCurrentTime"]}}},AUTO_PLAY_FAIL:{entry:["standbyTimers","pauseAllIntervals"],on:{PLAY:{target:"PLAYING",actions:["wakeTimers","startAllIntervals"]}}},ENDED:{on:{PLAY:{target:"PLAYING",actions:["incrementLoopCount","disableTheatreMode","resetProgress","resetCurrentTime"]},PAUSE:"PAUSED",CLOSE:{target:"FINAL",actions:"emitCloseFullyPlayed"}}},FINAL:{on:{PLAY:{target:"PLAYING",actions:"reportVideoStart"}}},FAILED:{}}},{actions:g({updateProgress:K({currentTime:(e,t)=>{var n,i;return null!=(i=null==(n=sM(t))?void 0:n.currentTime)?i:0},duration:(e,t)=>{var n,i;return null!=(i=null==(n=sM(t))?void 0:n.duration)?i:0},progress:(e,t)=>{let n=sM(t);return(null==n?void 0:n.duration)?Math.round(n.currentTime/n.duration*100):0}}),resetProgress:K({currentTime:()=>0,progress:()=>0}),emitProgress:t=>{void 0===t.duration||nk().emit({type:"video",event:"progress",data:{progress:t.progress,current_time:t.currentTime,duration:t.duration,scene_id:e.getId()}})},emitVideoCompleteEvents:t=>{sR(t.duration,t.duration,100,e),iR(t.duration,t.duration,t.duration)},emitCheckpointEvent:t=>{let{currentTime:n,duration:i,progress:r}=t;void 0!==i&&sR(n,i,r,e)},measureFrameRate:K(e=>e.currentTime>=2&&!e.frameRateMeasured?(rP({duration:1e3}).then(e=>{tU().emit([{name:"frame-rate-measurement",metric:"frame-rate-measurement",frame_rate:e}])}).catch(e=>{throw Error(`Video frame rate measurement failed: ${e.message}`)}),{frameRateMeasured:!0}):{}),emitPause:()=>{nk().emit({type:"video",event:"pause"})},emitPlay:e=>{nk().emit({type:"video",event:"play",data:{duration:e.duration}})},reportVideoStart:t=>{let n=tx.get(),i=tU(),r=e.expectedVideoDuration;i.emit([{name:"video-start",metric:"video-start",is_muted:n.isMuted(),actual_video_duration:t.duration,expected_video_duration:r},{name:"video-start",metric:{custom:"custom-video-player",native:"native-video-player",progressive:"progressive-video-player"}[e.getVideoPlayer()]}]),ns().emit("loadComplete")},incrementLoopCount:K({loopCount:e=>e.loopCount+1}),emitClose:e=>{let t=e.loopCount>0,n=t?null==e?void 0:e.duration:null==e?void 0:e.currentTime;nk().emit({type:"video",event:"close",data:{is_video_fully_played:t,maximum_viewing_time:n}})},emitCloseFullyPlayed:e=>{nk().emit({type:"video",event:"close",data:{is_video_fully_played:!0,maximum_viewing_time:e.duration}})},setMetadata:K({duration:(e,t)=>{var n;let i=sM(t);return null!=(n=null==i?void 0:i.duration)?n:0},videoElement:(e,t)=>sM(t),orientation:(e,t)=>{let n=sM(t);return(null==n?void 0:n.videoWidth)&&(null==n?void 0:n.videoHeight)&&n.videoWidth/n.videoHeight>1?"landscape":"portrait"}}),setCanPlay:K({canPlay:()=>!0}),emitAwaitingViewability:()=>{ed().emit({type:"video",event:"awaiting-viewability"})},emitDurationChange:(e,t)=>{let n=ed(),i=sM(t);n.emit({type:"video",event:"durationChange",data:{duration:null==i?void 0:i.duration}})},emitWaiting:()=>{ed().emit({type:"video",event:"waiting"})},emitSuspend:()=>{ed().emit({type:"video",event:"suspend"})},emitTimeUpdate:()=>{ed().emit({type:"video",event:"timeUpdate"})},updateCurrentTime:K({currentTime:e=>e.videoElement?e.videoElement.currentTime:0}),resetCurrentTime:e=>{e.videoElement&&(e.videoElement.currentTime=e.currentTime)},emitLoad:e=>{let t=ns();0===e.loadAttempts&&t.emit("loadStart")},incrementLoadAttempts:K({loadAttempts:e=>e.loadAttempts+1}),disableTheatreMode:e=>{let t=nO();1===e.loopCount&&t.emit({type:"theatre-mode-event",event:"disableTheatreMode"})},pauseVideoElement:e=>{e.videoElement&&e.videoElement.pause()},playVideoElement:e=>{if(e.videoElement){let t=e.videoElement.play();"function"==typeof(null==t?void 0:t.catch)&&t.catch(e=>{nk().emit({type:"video",event:"error",data:{error:Error(e.message)}})})}}},rN(),rw())}),h=sU(i)?sF(t):t,v=e.getId();sr({appStoreId:e.appStoreId,inlineInstallUrl:e.getInlineInstallConfig().url}),((e,t,n,i=eo.getValue(),r=tG.get())=>{as("tracking-event",(a,s)=>{if(!i.sdk.supports.skAdImpression||n||!t)return;let o=rR(e,"checkpoint.0");s.event===o&&r.triggerImpressions(t)})})(v,e.appStoreId,e.shouldFireTpat),aJ(v,e.getAppStoreOnDelayConfig(),d.value.context.canPlay),a0(v,e.getStoreKitOverlayAutoShowConfig(),sj.value),sn(v,e.isChild()),aY(e),se({callToActionConfig:sK.value?l.cta:e.getCallToActionConfig(),sceneId:v,shouldReplaceShowStoreKitOverlay:c.shouldReplaceShowStoreKitOverlay(),trackingEventMapConfig:e.getTrackingEventMapConfig()}),a7({fullScreenClickConfig:c.getFullScreenClickConfig(sK.value,e.fullScreenClickConfig,l.fsc),sceneId:v,shouldReplaceShowStoreKitOverlay:c.shouldReplaceShowStoreKitOverlay(),trackingEventMapConfig:e.getTrackingEventMapConfig()}),as("cta",(e,t)=>{sK.value||sH(e,t),null==r||r.emit({type:"theatre-mode-event",event:"revealControls"})}),as("fsc",(e,t)=>{sK.value||sH(e,t)});let p=eJ(e=>{sK.value=e},[]);eX(()=>(s&&s(d),()=>{s&&s(void 0)}),[d.value]);let m=!e.isChild()&&d.value.context.canPlay&&!sK.value,f=((e,t,n,i=!1)=>{let r=tT(null);return eX(()=>(!r.value&&i&&t.getCloseButtonConfig(e,n).then(e=>{r.value=e}),()=>{}),[n,i]),r})(e,c,d.value.context.duration,m),S=e.getCallToActionConfig().isPersistent&&!o&&(d.value.context.currentTime>0||e.isChild());return rm(eE,{children:[rm(sG,{sendAdEvent:t,showLastChanceEndcard:l.enabled}),a&&rm(aK,{config:l,sendAdEvent:t,onVisibilityChange:p,sceneId:v}),rm(aH,{config:e.getFullScreenClickConfig(),sceneId:v,children:[m&&f.value&&rm(aB,{config:f.value,sendAdEvent:h,showLastChanceEndcard:l.enabled,theatreModeReportingService:r}),rm(sE,{isVisible:d.value.matches("AUTO_PLAY_FAIL"),sendVideoEvent:u}),rm(sC,{isInLine:i.placement.is.inLine||n,sceneId:v},`blur-key-${JSON.stringify(d.value.value)}`),rm(sy,{scene:e,videoState:d,sendVideoEvent:u,sendAdEvent:t,theatreModeReportingService:r,onMetadataLoaded:()=>{sj.value=!0},canMuteAudio:!i.placement.is.banner}),e.showDownloadButton&&rm(aV,{delay:e.getCallToActionConfig().delay,isVisible:!1,children:rm(sb,{sceneId:v,storeKitOverlayAutoShowConfig:e.getStoreKitOverlayAutoShowConfig(),callToActionReportingService:ed(),theatreModeReportingService:r})}),S&&rm(sP,{scene:e,videoOrientation:d.value.context.orientation,viewportOrientation:nw(),disableRichCta:e.isChild()})]})]})},sq=e=>{e.addEventListener("error",t=>{var n,i,r;e.parent.postMessage({title:"playable-error",content:{message:null!=(r=null==t?void 0:t.message)?r:null==t||null==(n=t.error)?void 0:n.message,stack:null==t||null==(i=t.error)?void 0:i.stack}},"*")}),e.addEventListener("unhandledrejection",t=>{e.parent.postMessage({title:"playable-error",content:{message:null==t?void 0:t.reason}},"*")})},sz=()=>({width:window.innerWidth,height:window.innerHeight}),s$=()=>I(g({},sz()),{useCustomClose:!1,isModal:!1}),sX=()=>g({x:0,y:0},sz());let sQ=(e,t,n,i)=>!!e&&(!i.device.os.is.iOS||!!t)&&(!!e.isOpen()||!(n.getEventCount("open-storekit-product-view-command")>=2)&&(n.emit("open-storekit-product-view-command"),e.open(),e.isOpen())),sZ={allowOrientationChange:!0,forceOrientation:"none"};var sJ=class{getProxyMraid(){return new Proxy(this.targetProxyMraid,this.getProxyHandler())}constructor(e,t,n=(()=>{let e=g({open:()=>()=>{},openSceneCta:()=>()=>{},openSceneFsc:()=>()=>{},close:(e=r$)=>()=>e().send("CLOSE"),addEventListener:(e=i7.get())=>(t,n)=>{e.addEventListener(t,n)},isViewable:(e=tR.get())=>()=>e.isViewable(),getViewable:(e=tR.get())=>()=>e.isViewable(),getCurrentPosition:()=>sX,getDefaultPosition:()=>sX,getExpandProperties:()=>s$,getMaxSize:()=>sz,getPlacementType:(e=eo.getValue())=>()=>e.placement.type,getScreenSize:()=>sz,getState:()=>()=>"default",removeEventListener:(e=i7.get())=>(t,n)=>{e.removeEventListener(t,n)},setOrientationProperties:(e=tG.get(),t=eo.getValue())=>t.sdk.supports.orientationProperties?t=>{let n=g({},sZ,t);e.setOrientationProperties(n)}:()=>null},{cacheFile:(e=ng.get())=>(t,n)=>!!t&&!!n&&"string"==typeof t&&!!t.toLowerCase().startsWith("http")&&!!ArrayBuffer.isView(n)&&(e.addRecord({url:t,data:n}),!0),fetchFile:(e=ng.get())=>async t=>{if(!t||"string"!=typeof t||!t.toLowerCase().startsWith("http"))return;let n=await e.get(t);return null==n?void 0:n.data},grantReward:(e=tG.get(),t=tU(),n=iP())=>(t.emit("grant-reward","grant-reward"),e.notifySuccessfulViewAd(),n.emit("rewardGranted",!0),()=>null),next:(e=r$)=>t=>{rr.getValue().isLastChanceEndcardOverlayShowing||e().send(t)},openStoreKitOverlayView:(e=t3(rV))=>async()=>{if(!e||!(null==e?void 0:e.isIdle()))return!1;if(null==e?void 0:e.isOpen())return!0;null==e||e.open({fallback:"off"});try{return await nr(()=>null==e?void 0:e.isOpen(),3e3),!0}catch(e){return!1}},openStoreKitProductView:(e=t3(rV),t=t3(rL),n=tU(),i=eo.getValue())=>()=>sQ(t,e,n,i),openAppStoreProductView:(e=t3(rL),t=t3(rV),n=tU(),i=eo.getValue())=>()=>sQ(e,t,n,i),closeStoreKitOverlayView:(e=t3(rV))=>async()=>{if(!e)return!1;if(!(null==e?void 0:e.isOpen()))return!0;null==e||e.close();try{return await nr(()=>!(null==e?void 0:e.isOpen()),3e3),!0}catch(e){return!1}},showClose:(e=ns())=>()=>{e.emit("forceCompleteCountdown")},isRewarded:(e=eo.getValue())=>()=>e.placement.is.rewarded,getNewTimer:(e=H.get())=>(t,n)=>e.getNewTimer(t,n),getNewInterval:(e=tY.get())=>(t,n)=>e.getNewInterval(t,n),hapticFeedback:(e=tG.get(),t=ns(),n=t2.getValue(),i=eo.getValue())=>(r,a)=>{if(!i.sdk.supports.hapticFeedback)return;let s=n.scene;s&&t.emit({type:"scene-event",event:"hapticFeedback",data:{scene_id:s.getId(),scene_type:s.getSceneType(),haptic_feedback_data:{type:r,style:a}}}),e.hapticFeedback(r,a)}});return I(g({},e,{createCalendarEvent:()=>void 0,expand:()=>void 0,getConsentAcceptButtonText:()=>void 0,getConsentBodyText:()=>void 0,getConsentDenyButtonText:()=>void 0,getConsentRequired:()=>void 0,getConsentTitleText:()=>void 0,getOrientationProperties:()=>void 0,getResizeProperties:()=>void 0,getVersion:()=>()=>"1.0",playVideo:()=>void 0,resize:()=>void 0,setExpandProperties:()=>void 0,setResizeProperties:()=>void 0,storePicture:()=>void 0,useCustomClose:()=>()=>!1}),{supports:()=>t=>t in e})})()){this.targetProxyMraid=e,this.observabilityEventReportingService=t,this.commandHandlers=n,this.getProxyHandler=()=>{let{commandHandlers:e,observabilityEventReportingService:t}=this;return{get:(n,i)=>n[i]?n[i]:e[i]?e[i]():(t.emit({name:"unknown-mraid-command",value:i}),()=>!1)}}}},s0=function(e,t){let n,i=!1;return function(...r){!i&&(n||(e.apply(this,r),i=!0,n=window.setTimeout(()=>{i=!1,n=void 0},null!=t?t:300)))}};let s1=s0((e,t,n,i=n_())=>{i.emit({type:"cta",event:n,data:{cta_url:e,scene_id:t}})}),s2=s0((e,t=nb())=>{t.emit({type:"fsc",event:"fsc",data:{cta_url:void 0,scene_id:e}})});var s3=(e,t,n=ns(),i=nC.get(),r=t2)=>{t.addEventListener("load",()=>{n.emit("loadComplete"),setTimeout(()=>{var t;e.getId()===(null==(t=r.getValue().scene)?void 0:t.getId())&&i.resume()},5e3)})},s6=class{interceptAudioContext(){let e=this.originAudioContext,t=this.shouldMute,n=this.instances;function i(){let i=new e,r=i.createGain();r.gain.setValueAtTime(+!t,i.currentTime),r.connect(i.destination);try{Object.defineProperty(i,"destination",{get:()=>r,configurable:!0})}catch(e){}return n.set(i,r),i}i.prototype=this.originAudioContext.prototype,Object.defineProperty(this.targetWindow,"AudioContext",{value:i,configurable:!0})}muteAll(){this.shouldMute=!0,this.instances.forEach((e,t)=>{e.gain.setValueAtTime(0,t.currentTime)})}unmuteAll(){this.shouldMute=!1,this.instances.forEach((e,t)=>{e.gain.setValueAtTime(1,t.currentTime)})}constructor(e,t){this.instances=new Map,this.targetWindow=e,this.originAudioContext=e.AudioContext||e.webkitAudioContext,this.shouldMute=t,this.interceptAudioContext()}},s4=e=>{let t=e.nodeName.toLowerCase();switch(t){case"audio":case"video":case"iframe":return t;default:return"default"}},s7=class{isNodeAllowed(e){return["audio","video"].includes(s4(e))}preventSoundResume(e){Object.defineProperty(e,"muted",{set:()=>{},get:()=>!0,configurable:!0})}mute(e,t=!0){t&&!this.isNodeAllowed(e)||(e.muted=!0,this.preventSoundResume(e),this.storeElement(e))}unmute(e,t=!0){if(t&&!this.isNodeAllowed(e))return;let n=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"muted");n&&Object.defineProperty(e,"muted",n),e.muted=!1,this.storeElement(e)}muteAll(){this.instances.forEach(e=>{this.mute(e,!1)}),Array.from(this.targetWindow.document.querySelectorAll("audio, video")).forEach(e=>{this.mute(e,!1)})}unmuteAll(){this.instances.forEach(e=>{this.unmute(e,!1)})}storeElement(e){this.instances.has(e)||this.instances.add(e)}constructor(e){this.targetWindow=e,this.instances=new Set}};class s5{interceptStaticIframes(){Array.from(this.targetWindow.document.querySelectorAll("iframe")).forEach(e=>{this.handleIframeNode(e)})}doMuteAllIfMute(){this.mute&&this.muteAllMedias()}unmuteAllMedias(){this.mute=!1,this.silencers.forEach(e=>e.unmuteAll())}muteAllMedias(){this.mute=!0,this.silencers.forEach(e=>e.muteAll())}handleIframeNode(e){var t;s5.isWindowAccessible(e.contentWindow)&&s5.interceptAllMediaElements(e.contentWindow,this.mute);let n=!s5.hasIframeCrossOriginUrl(e);this.iframeEventReportingService.emit({type:"iframe",event:"nestedIframeType",data:{nested_iframe_type:n?"basic":"cors",scene_id:null==(t=this.sceneContext.getValue().scene)?void 0:t.getId()}})}handleNewNode(e){"iframe"===s4(e)&&this.handleIframeNode(e),this.mute?this.silencers.forEach(t=>{var n;return null==(n=t.mute)?void 0:n.call(t,e)}):this.silencers.forEach(t=>{var n;return null==(n=t.unmute)?void 0:n.call(t,e)})}interceptCreateElement(){let e=this.targetWindow.document.createElement;Object.defineProperty(this.targetWindow.document,"createElement",{value:(t,...n)=>{let i=e.call(this.targetWindow.document,t,...n);return this.handleNewNode(i),i},configurable:!0})}observeDomMutation(){new this.targetWindow.MutationObserver(e=>{e.forEach(e=>{let{addedNodes:t}=e;for(let e of t)this.handleNewNode(e)})}).observe(this.targetWindow.document,{subtree:!0,childList:!0})}constructor(e,t,n=!1,i=a$(),r=t2){this.targetWindow=e,this.silencers=t,this.mute=n,this.iframeEventReportingService=i,this.sceneContext=r,this.interceptCreateElement(),"complete"===this.targetWindow.document.readyState?(this.doMuteAllIfMute(),this.observeDomMutation()):this.targetWindow.document.addEventListener("DOMContentLoaded",()=>{this.doMuteAllIfMute(),this.observeDomMutation()}),this.interceptStaticIframes(),this.doMuteAllIfMute()}}s5.instances=new Map,s5.hasIframeCrossOriginUrl=e=>{var t;return null==(t=e.src)?void 0:t.toLowerCase().startsWith("http")},s5.isWindowAccessible=e=>{try{return!!(null==e?void 0:e.document)}catch(e){return!1}},s5.interceptAllMediaElements=(e,t,n=a$(),i=t2)=>{let r=new s5(e,[new s7(e),new s6(e,t)],t,n,i);s5.instances.set(e,r)},s5.muteAllMedias=()=>{s5.instances.forEach(e=>{s5.isWindowAccessible(e.targetWindow)&&e.muteAllMedias()})},s5.unmuteAllMedias=()=>{s5.instances.forEach(e=>{s5.isWindowAccessible(e.targetWindow)&&e.unmuteAllMedias()})};var s8=(e,t)=>{Object.defineProperty(e,t,{configurable:!1,enumerable:!0,value:e[t],writable:!1})};class s9{intercept(){this.interceptors.forEach(e=>e(this.targetWindow)),this.checkExistingIframes(),this.observeNestedIframes()}static init(e,t){null!==e.contentDocument&&new s9(e.contentWindow,t).intercept()}checkExistingIframes(){Array.from(this.targetWindow.document.querySelectorAll("iframe")).forEach(e=>{this.handleNewIframe(e)})}observeNestedIframes(){let e=new this.targetWindow.MutationObserver(this.handleMutation);this.startObservation(e)}startObservation(e){let{document:t}=this.targetWindow,n=()=>{this.checkExistingIframes(),this.observeDocument(e)};"loading"===t.readyState?t.addEventListener("DOMContentLoaded",n):n()}observeDocument(e){e.observe(this.targetWindow.document,{subtree:!0,childList:!0})}constructor(e,t){this.targetWindow=e,this.interceptors=t,this.handleNewIframe=e=>{"iframe"===s4(e)&&s9.init(e,this.interceptors)},this.handleMutation=e=>{e.reduce((e,t)=>e.concat(Array.from(t.addedNodes)),[]).forEach(this.handleNewIframe)}}}var oe=class extends aN{getIframeContentData(){return this.scene.getIframeContentData()}getLastChanceEndcardConfig(e,t){let n=this.scene.getLastChanceEndcardConfig(),i="accelerate"!==this.adData.advertiser.rtb.name;return n.enabled&&t&&i?I(g({},n),{enabled:e}):n}getCloseButtonConfig(){var e;let t=this.scene.getCloseButtonConfig();return(null==(e=this.amplifyEndcardEngagementService)?void 0:e.isEndcardAmplified())&&(t.delay=this.amplifyEndcardEngagementService.getAmplifiedEndcardCloseButtonDelay(t.delay)),t}initMraidInIframeForFullscreen(e){e&&(e.mraid=this.proxyMraidService.getProxyMraid(),s8(e,"mraid"),e.open=this.customOpen)}initMraidInIframeForNonFullscreen(e){let t=e.contentWindow;t.mraid=this.proxyMraidService.getProxyMraid(),s8(t,"mraid"),t.open=()=>null;let n=e=>{if(e.isTrusted){var i,r,a;t.document.removeEventListener("click",n,!0),t.open=this.customOpen;let s=e.target.closest("a");(null==s||null==(i=s.href)?void 0:i.startsWith("http"))?e.preventDefault():null==(r=(a=e.target).click)||r.call(a)}},i=()=>{var e;(null==(e=t.document)?void 0:e.readyState)!=="loading"?t.document.addEventListener("click",n,{capture:!0}):requestAnimationFrame(i)};requestAnimationFrame(i)}injectMethodToIframe(e){this.adData.placement.is.fullscreen?this.initMraidInIframeForFullscreen(e.contentWindow):this.initMraidInIframeForNonFullscreen(e)}loadNestedIframe(e,t){if(!(null==t?void 0:t.content))return;let n=()=>{this.loadNestedIframe(e,t)},i=e.querySelector("iframe");if(!i)return void e.addEventListener("DOMContentLoaded",n);e.removeEventListener("DOMContentLoaded",n),i.width="100%",i.height="100%";let{content:r}=t;this.loadIframe(i,r,!0)}loadIframe(e,t,n=!1){try{var i;let r=e.contentWindow,a=null==r?void 0:r.document;this.injectMethodToIframe(e),a.open(),this.injectedAddErrorListenerToIframe(r),this.injectedAddLoadListenerToIframe(this.scene,r),n||this.addLoadEventForAndroid(r),this.addSourceInfoToFunctions(r),a.write(t),a.close(),s9.init(e,[this.blockBeforeunloadEvent,this.addSourceInfoToFunctions,this.addEndcardClickListener,this.blockFullScreenNativeVideoPlayer]),i=this.customOpen,r.document.addEventListener("click",e=>{let t=e.target.closest("a");if(t){if(!e.isTrusted)return void e.preventDefault();t.href&&(e.preventDefault(),i(t.href))}},{capture:!0}),this.injectedInterceptAllMediaElements(r,this.muteService.isMuted()),this.mraidEventReportingService.emit({type:"mraid-event",event:"readyToPlay"})}catch(e){this.errorLoggingService.emit({type:"error-logging",event:"exception",data:{error:{message:"Failed to write endcard to iframe"}}})}}updateIframeContent(e,t){if(null==e?void 0:e.current){let{content:n,nestedFrameContent:i}=t;this.loadIframe(e.current,n);let r=e.current.contentWindow;this.loadNestedIframe(r.document,i)}}constructor(e){let{scene:t,errorLoggingService:n=t8(),adData:i=eo.getValue(),muteService:r=tx.get(),sceneEventReportingService:a=ns(),addErrorListenerToIframe:s=sq,addLoadListenerToIframe:o=s3,interceptAllMediaElements:l=s5.interceptAllMediaElements,amplifyEndcardEngagementService:c=rW.getIfExists(),observabilityEventReportingService:d=tU(),throttleCustomCta:u=s1,throttleCustomFsc:h=s2,mraidEventReportingService:v=eu(),ctaReportingService:p=n_(),fscReportingService:g=nb()}=e;super(i,a),this.customOpen=e=>this.adData.placement.is.fullscreen||0!==this.sceneEventReportingService.getEventCount("click")?this.injectedThrottleCustomCta(e,this.scene.getId(),"endcardCta",this.ctaReportingService):null,this.customOpenSceneCta=(e,t="combinedEndcardCta")=>this.injectedThrottleCustomCta(void 0,e,t,this.ctaReportingService),this.customOpenSceneFsc=e=>this.injectedThrottleCustomFsc(e,this.fscReportingService),this.blockFullScreenNativeVideoPlayer=e=>{let t=Array.from(e.document.querySelectorAll("video"));0!==t.length?t.forEach(e=>e.setAttribute("playsinline","")):"complete"!==e.document.readyState&&e.document.addEventListener("DOMContentLoaded",()=>{this.blockFullScreenNativeVideoPlayer(e)})},this.addEndcardClickListener=e=>{((e,t,n,i=iT)=>{e&&e.document.addEventListener(st(),e=>{i(e)},!0)})(e,this.scene.getTrackingEventMapConfig(),this.scene.getId())},this.addLoadEventForAndroid=e=>{if(this.adData.device.os.is.android){let t,n=e.addEventListener;e.addEventListener=(t,i,r)=>{n.call(e,"load"===t?"DOMContentLoaded":t,i,r)},Object.defineProperty(e,"onload",{set:n=>{t=n,e.addEventListener("DOMContentLoaded",t)},get:()=>t})}},this.blockBeforeunloadEvent=e=>{let t=e.addEventListener;e.addEventListener=(n,i,r)=>{"beforeunload"!==n&&t.call(e,n,i,r)}},this.addSourceInfoToFunctions=e=>{e.Object.defineProperty(e.Function.prototype,iE,{value:"iframe",writable:!0,enumerable:!1,configurable:!0})},this.scene=t,this.errorLoggingService=n,this.adData=i,this.muteService=r,this.sceneEventReportingService=a,this.injectedAddErrorListenerToIframe=s,this.injectedAddLoadListenerToIframe=o,this.injectedInterceptAllMediaElements=l,this.amplifyEndcardEngagementService=c,this.observabilityEventReportingService=d,this.injectedThrottleCustomCta=u,this.injectedThrottleCustomFsc=h,this.mraidEventReportingService=v,this.ctaReportingService=p,this.fscReportingService=g,this.proxyMraidService=new sJ({open:this.customOpen,openSceneCta:this.customOpenSceneCta,openSceneFsc:this.customOpenSceneFsc},d)}};let ot=window.addEventListener;var on=({sendAdEvent:e,htmlService:t,iframeService:n,scene:i})=>{var r;let a,s=eQ(null),[o,l]=e$(!1);return eX(()=>{o&&requestAnimationFrame(()=>{t.getIframeContentData(i).then(async e=>{e.content=await n.stitchCachedContentToIframe(e.content,i.id,!0),t.updateIframeContent(s,e)})})},[o]),((e=tx.get())=>{eX(()=>{e.isMuted()?s5.muteAllMedias():s5.unmuteAllMedias()},[e.getMutedSignal().value])})(),eX(()=>(window.addEventListener=a,()=>{window.addEventListener=ot}),[a=eJ((e,t,n)=>{var i;(null==r||null==(i=r.current)?void 0:i.contentWindow)&&"iframe"===t[iE]?r.current.contentWindow.addEventListener(e,t,n):ot.call(window,e,t,n)},[r=s])]),rm("iframe",{id:"endcardIframe",title:"endcard",onLoad:()=>{o||(e({type:"PRIVACY_LOGO_SHOW"}),l(!0))},ref:s,className:"oAV7cW_endcardIframe",allow:"autoplay",scrolling:"no"})},oi=(e,t)=>{let n=e.getAttribute(t);if(null!==n){if(n.endsWith("%")&&0===parseFloat(n))return!1;let e=parseFloat(n);return!(Number.isNaN(e)||e<=1)}return!0},or=(e,t)=>{let n=new DOMParser().parseFromString(e,"text/html"),i=t?`href="${t}"`:"";return(n.head.insertAdjacentHTML("afterbegin","<style>body {margin: 0;padding: 0;overflow: hidden;}</style>"),n.head.insertAdjacentHTML("afterbegin",`<base target="_parent" ${i}>`),e.toLocaleLowerCase().startsWith("<!doctype html>"))?`<!DOCTYPE html>${n.documentElement.outerHTML}`:n.documentElement.outerHTML},oa=e=>{let t=/rootURL\s*:\s*["']([^"']+)["']/.exec(e.textContent),n=null==t?void 0:t[1];if(n)return n.endsWith("/")?n:`${n}/`};class os extends d{getNestedIframeContentData(e){try{let t=new DOMParser().parseFromString(e,"text/html").getElementsByTagName("iframe");if(1!==t.length)return;let n=t[0],i=n.getAttribute("src");if(!(null==i?void 0:i.startsWith("http")))return;let r=n.getAttribute("style");if(null==r?void 0:r.toLowerCase().replace(/\s+/g," ").includes("display: none"))return;let a=oi(n,"width"),s=oi(n,"height");if(!a||!s)return;let o=(e=>{try{let t=new URL(e),n=t.pathname,i=n.lastIndexOf("/"),r=n.substring(0,i+1);return t.origin+r}catch(e){return""}})(i);return{src:i,baseUrl:o}}catch(e){this.errorLoggingReportingService.emit({type:"error-logging",event:"exception",data:{error:{message:"Unable to get nested iframe content data"}}})}}decodeCachedItem(e,t){if(!e)return;let{mimeType:n,data:i}=e;if(i){let e=new TextDecoder((e=>{if(!e)return"utf-8";let t=e.toLowerCase().split(";").find(e=>e.trim().startsWith("charset="));if(t){var n;let e=null==(n=t.split("=")[1])?void 0:n.trim();if(e)return e}return"utf-8"})(n),{fatal:!0});try{return e.decode(i)}catch(e){this.errorLoggingReportingService.emit({type:"error-logging",event:"resource",data:{error:{message:`Unable to decode cached item: ${e}`},error_source:"resource",resource_url:t}})}}}async getRemoteResource(e){if(!e.toLowerCase().startsWith("http"))return;let t=this.smartDownloadQueueService.getCompletedItem(e);if(t)return this.decodeCachedItem(t,e);let n=await this.urlCacheService.get(e);if(n)return this.decodeCachedItem(n,e)}async stitchCachedContentToIframe(e,t,n=!1){if(n&&this.smartDownloadQueueService.pause(),this.adData.advertiser.disableEndcardCache||"accelerate"!==this.adData.advertiser.rtb.name)return e;let i=await this.stitchCachedContentToHtml(e,t,n),r=Array.from(i.querySelectorAll("script")).find(e=>{var t;return null==(t=e.textContent)?void 0:t.includes("LiftoffOuterEnv.init")});if(r){let e,i=(e=>{let t=/scriptSrcURLs\s*:\s*(\[[^\]]*\])/.exec(e.textContent);if(null==t?void 0:t[1])try{return JSON.parse(t[1].replace(/'/g,'"'))}catch(e){}return[]})(r);await Promise.all(i.map(async e=>{let i=await this.getRemoteResource(e);if(i){let t=`data:text/javascript;charset=utf-8,${encodeURIComponent(i)}`;r.textContent=r.textContent.replace(e,t)}else if(n&&this.smartDownloadQueueService.getCurrentUrl()===e){let t=await this.smartDownloadQueueService.awaitDownload(e),n=this.decodeCachedItem(t,e);if(n){let t=`data:text/javascript;charset=utf-8,${encodeURIComponent(n)}`;r.textContent=r.textContent.replace(e,t)}}else n||this.smartDownloadQueueService.add(e,t)}));let a=null==(e=/externalHtmlURL\s*:\s*["']([^"']+)["']/.exec(r.textContent))?void 0:e[1];if(a){let e=await this.getRemoteResource(a);if(e){let i=oa(r),s=await this.stitchCachedContentToHtml(e,t,n,i);r.textContent=r.textContent.replace(`"${a}"`,"null"),r.textContent=r.textContent.replace("html: null",`html: "${encodeURIComponent(this.getDocummentAsString(s))}"`)}else if(n&&this.smartDownloadQueueService.getCurrentUrl()===a){let e=await this.smartDownloadQueueService.awaitDownload(a),t=this.decodeCachedItem(e,a);t&&(r.textContent=r.textContent.replace(`"${a}"`,"null"),r.textContent=r.textContent.replace("html: null",`html: "${encodeURIComponent(t)}"`))}else n||this.smartDownloadQueueService.add(a,t,e=>{var n;let i=oa(r),s=null!=(n=this.decodeCachedItem(e,a))?n:"";this.stitchCachedContentToHtml(s,t,!1,i)})}}return this.getDocummentAsString(i)}async stitchCachedContentToHtml(e,t,n=!1,i=""){let r,a,s,o,l=((e,t="")=>{let n,i,r=(n=e,0===(i=t).length?n:/<head[^>]*>/i.test(n)?n.replace(/<head([^>]*)>/i,`<head$1><base href="${i}">`):/<html[^>]*>/i.test(n)?n.replace(/<html[^>]*>/i,e=>`${e}<head><base href="${i}"></head>`):`<head><base href="${i}"></head>${n}`);return new DOMParser().parseFromString(r,"text/html")})(e,i),c=(r=l.querySelectorAll("script[src]"),a=[],r.forEach(e=>{a.push(e)}),a);await Promise.all(c.map(async e=>{let i=await this.getRemoteResource(e.src);if(i)e.removeAttribute("src"),e.textContent=i;else if(n&&this.smartDownloadQueueService.getCurrentUrl()===e.src){let t=await this.smartDownloadQueueService.awaitDownload(e.src),n=this.decodeCachedItem(t,e.src);n&&(e.removeAttribute("src"),e.textContent=n)}else n||this.smartDownloadQueueService.add(e.src,t)}));let d=(s=l.querySelectorAll('link[rel="stylesheet"]'),o=[],s.forEach(e=>{o.push(e)}),o);return await Promise.all(d.map(async e=>{let i=await this.getRemoteResource(e.href);if(i){let t=l.createElement("style");t.textContent=i,e.replaceWith(t)}else if(n&&this.smartDownloadQueueService.getCurrentUrl()===e.href){let t=await this.smartDownloadQueueService.awaitDownload(e.href),n=this.decodeCachedItem(t,e.href);if(n){let t=l.createElement("style");t.textContent=n,e.replaceWith(t)}}else n||this.smartDownloadQueueService.add(e.href,t)})),l}getDocummentAsString(e){return 1===e.head.children.length&&0===e.body.children.length?e.head.children[0].outerHTML:0===e.head.children.length&&1===e.body.children.length?e.body.children[0].outerHTML:e.documentElement.outerHTML}async initializeIframeContentData(e,t,n){let i={content:or(e)};if(n){let{src:e}=n;i.nestedFrameContent=g({},n);try{var r;let t,a=await window.fetch(e);if(!a.ok)throw Error("fetch returned not ok status");let s=await a.text();i.nestedFrameContent.content=or(s,n.baseUrl),r=i.content,(t=new DOMParser().parseFromString(r,"text/html")).getElementsByTagName("iframe")[0].removeAttribute("src"),i.content=r.toLocaleLowerCase().startsWith("<!doctype html>")?`<!DOCTYPE html>${t.documentElement.outerHTML}`:t.documentElement.outerHTML}catch(t){this.errorLoggingReportingService.emit({type:"error-logging",event:"playable",data:{error:{message:`Unable to get nested iframe: ${t}`},error_source:"template",resource_url:e}})}}return i.content=await this.stitchCachedContentToIframe(i.content,t),i}constructor(e=eo.getValue(),t=ng.get(),n=nC.get(),i=t8()){super(),this.adData=e,this.urlCacheService=t,this.smartDownloadQueueService=n,this.errorLoggingReportingService=i}}os.identifier=new o;let oo=to(!1);var ol=({scene:e,sendAdEvent:t,shouldRenderIFrame:n=!0,customClassName:i,shouldRenderLastChanceEndcard:r=!0})=>{let a,s=new oe({scene:e}),o=new os,l=eJ(e=>{oo.value=e},[]);aJ(e.getId(),e.getAppStoreOnDelayConfig()),a0(e.getId(),e.getStoreKitOverlayAutoShowConfig()),se({callToActionConfig:oo.value?e.getLastChanceEndcardConfig().cta:e.getCallToActionConfig(),sceneId:e.getId()}),a7({fullScreenClickConfig:oo.value?e.getLastChanceEndcardConfig().fsc:void 0,sceneId:e.getId()}),as("cta",(e,t)=>{let n;!oo.value&&(n=rU.getIfExists(),"endcardCta"===t.event&&n&&n.onCtaClick())}),aY(e),sr({inlineInstallUrl:e.getInlineInstallConfig().url}),sn(e.getId(),e.isChild()),eX(()=>{t({type:"CREATIVE_VIEW"})},[]),a=e=>{Object.entries({"z-index":"auto",isolation:"isolate"}).forEach(([t,n])=>{e.style.setProperty(t,n,"important")})},eX(()=>{let e=new Map,t=Element.prototype.appendChild;return Element.prototype.appendChild=function(n){if(n.nodeType===Node.ELEMENT_NODE&&"style"in n){let t,i=(t=new MutationObserver(()=>{a(n)}),a(n),t.observe(n,{attributes:!0,attributeFilter:["style"]}),t);e.set(n,i)}return t.call(this,n)},()=>{e.forEach((e,t)=>{e.disconnect(),t.remove()}),Element.prototype.appendChild=t}},[]);let c=e.getId(),[d]=((e=ns())=>{let t=tT(!1);return as("scene-event",(e,n)=>{"click"===n.event&&iw(n.data.click_target,ib)&&(t.value=!0)},e),[t.value]})(),u=s.getLastChanceEndcardConfig(d,aQ.isEndcardOnly());return rm(eE,{children:[r&&rm(aK,{config:u,sendAdEvent:t,onVisibilityChange:l,sceneId:c}),rm("div",{className:null!=i?i:"oAV7cW_endcard",id:c,children:[!e.isChild()&&!oo.value&&rm(aB,{sendAdEvent:t,config:s.getCloseButtonConfig(),showLastChanceEndcard:u.enabled}),n&&rm(on,{sendAdEvent:t,htmlService:s,iframeService:o,scene:e})]})]})},oc=e=>e instanceof aQ&&"endcard"===e.getSceneType(),od=({htmlCustomClassName:e,imageCustomClassName:t,onVideoStateChange:n,scene:i,sendEvent:r,shouldRenderIFrame:a,showVideoBlur:s=!1,theatreModeReportingService:o,isBackgroundImage:l=!1})=>rm(eE,{children:[aZ(i)&&rm(ss,{scene:i,sendAdEvent:r,isBackgroundImage:l,customClassName:t},i.getId()),iQ(i)&&rm(sY,{scene:i,sendAdEvent:r,showVideoBlur:s,theatreModeReportingService:o,onVideoStateChange:n},i.getId()),oc(i)&&rm(ol,{scene:i,shouldRenderIFrame:a,customClassName:e,sendAdEvent:r,sceneEventReportingService:ns()},i.getId())]}),ou=({sceneId:e,sceneContext:t=t2,injectedGetAdMachineInterpreter:n})=>{let i=((e,t=t2)=>eZ(()=>{let n=t.getValue().scene;return i8(n)&&n.getChildScenes().find(t=>t.getId()===e)||null},[e]))(e,t),r=((e=r$)=>eZ(()=>e().send,[]))(n);return i?rm("div",{className:"_37VDnG_component",children:rm(od,{scene:i,sendEvent:r,shouldRenderIFrame:!0,showVideoBlur:!0,imageCustomClassName:"_37VDnG_compositeImage",isBackgroundImage:!0,htmlCustomClassName:"_37VDnG_compositeHtml"})}):null};let oh=to(!1);var ov=({scene:e,sendAdEvent:t})=>{aY(e);let n=eJ(e=>{oh.value=e},[]);se({callToActionConfig:e.getLastChanceEndcardConfig().cta,sceneId:e.getId()}),a7({fullScreenClickConfig:e.getLastChanceEndcardConfig().fsc,sceneId:e.getId()}),sn(e.getId(),e.isChild());let i=eZ(()=>e.getDecodedHtml(),[e]);return rm("div",{className:"_37VDnG_composite",children:[rm(aK,{config:e.getLastChanceEndcardConfig(),sendAdEvent:t,onVisibilityChange:n,sceneId:e.getId()}),!e.isChild()&&!oh.value&&rm(aB,{config:e.getCloseButtonConfig(),sendAdEvent:t,showLastChanceEndcard:e.getLastChanceEndcardConfig().enabled}),rm("div",{className:"_37VDnG_composite",children:rm(aq,{htmlString:i,VmComponent:ou})})]})},op=()=>ed(),og=({service:e=nI.get(),pictureInPictureReportingService:t=op()})=>{var n;let i=eQ(null),[r]=((e=nI.get())=>{let t=e.getVideoInterpreter(),n=tT(null==t?void 0:t.state);return eX(()=>{if(!t)return()=>{};let{state:e,status:i}=t;if("Running"!==i){let n=rQ(e.value,"usePictureInPictureVideoMachine");t.start({context:e.context,value:n})}let r=t.subscribe(e=>{n.value=e});return()=>{r.unsubscribe()}},[t]),[n]})(e),a=eZ(()=>eh(),[]),s=tT(!1),o=tT(!1),l=tT(!1),c=e=>{e===ag.LEFT&&(l.value=!0),e===ag.UP&&(o.value=!0)},d=()=>{t.emit({type:"picture-in-picture",event:"close",fireOnlyOnce:!0})};return eX(()=>{let t=e.getVideoElement(),n=i.current;t&&n&&(n.appendChild(t),s.value=!0,t.onended=()=>{d()})},[]),as("viewability",(t,n)=>{e.videoAdViewableChange(t,n)},a),eX(()=>{var t;let n=e.getVideoElement();if(n)switch(null==(t=r.value)?void 0:t.value){case"PLAYING":n.play();break;case"PAUSED":n.pause()}},[null==(n=r.value)?void 0:n.value]),eX(()=>{i.current&&(e.isPortrait()?i.current.style.height="auto":i.current.style.width="auto")},[e.isPortrait()]),a7(e.getFullScreenCallToActionEventHandlerProps()),rm(aE,{onSwipeUp:()=>c(ag.UP),onSwipeLeft:()=>c(ag.LEFT),children:rm("button",{type:"button",id:"picture-in-picture","aria-label":"Picture in Picture",ref:i,onClick:()=>e.clickHandler(),onAnimationEnd:()=>{s.value=!1},onTransitionEnd:d,className:ar("i0Mp0G_pictureInPictureContainer",`${s.value?"i0Mp0G_animatingVideo":"i0Mp0G_animationEnded"}`,`${l.value?"i0Mp0G_slideLeft":""}`,`${o.value?"i0Mp0G_slideUp":""}`)})})},om=(e,t,n,i=tU())=>{i.emit({name:"frustration-clicks",metric:"frustration-clicks",scene_id:null==n?void 0:n.getId(),scene_type:null==n?void 0:n.getSceneType(),coordinates:[e,t].join(",")})},of=class{addScenes(e){return this.scenes=e,this}addTransformer(e){return this.transformers.push(e),this}build(){for(let e of this.transformers)this.scenes=e.transform(this.scenes);return this.scenes}constructor(){this.transformers=[],this.scenes=[]}},oS=class{transform(e){var t,n,i,r;let a=(null!=(t=this.freeformService)?t:new rz).getAdMachineConfig(),s=t=>e.find(e=>e.getId()===t);for(let t of e){let e=t.getId(),o=s(null==(r=a.states[e])||null==(i=r.on)||null==(n=i.NEXT)?void 0:n.target);o&&(t.next=o,o.prev=t)}return e}constructor(e){this.freeformService=e}},oy=class{transform(e){for(let t of e){let e=t.prev;if(!e)continue;let n=t.getTransitions().find(e=>"PREVIOUS"===e.name);n?n.scene=e:t.addTransition({name:"PREVIOUS",scene:e,actions:[]})}return e}},oC=e=>!!nj(e)&&e.getLastChanceEndcardConfig().enabled,oE=class{transform(e){for(let t of e){if(!iQ(t))continue;let e=t.getTransitions().find(e=>"NEXT"===e.name),n=null==e?void 0:e.actions.filter(e=>"showProductView"!==e.name),i={name:"VIDEO_FAILURE",actions:null!=n?n:[],scene:oC(t)||null==e?void 0:e.scene};t.getLastChanceEndcardConfig().enabled&&i.actions.push({name:"fireImpression"}),t.isLastPage()&&!oC(t)?i.actions.push({name:"sendFatalVideoError"}):i.actions.push({name:"sendEventVideoSkipToNextScene"}),t.addTransition(i)}return e}},o_=class{transform(e){for(let i=0;i<e.length;i++){var t,n;let r=e[i],a=i===e.length-1;if(!this.loop&&a)continue;let s=this.loop&&a?0:i+1,o=r.getTransitions().find(e=>"NEXT"===e.name);o?o.scene=null!=(t=e[s])?t:void 0:r.addTransition({name:"NEXT",scene:null!=(n=e[s])?n:void 0,actions:[]})}return e}constructor(e=!1){this.loop=e}},ob=class{transform(e){for(let n of e){if(!iQ(n)||n.getTransitions().some(e=>"COMPLETE"===e.name&&void 0!==e.scene))continue;let e=n.getTransitions().find(e=>"NEXT"===e.name);if(e){var t;let i=["showPictureInPicture","setPictureInPictureVideoContext"];n.addOrUpdateTransition({name:"COMPLETE",scene:null==e?void 0:e.scene,actions:[...null!=(t=e.actions.filter(e=>!i.includes(e.name)))?t:[]]})}}return e}},ow=class{getStateMachineConfig(){return this.stateMachineConfig}getStateMachineOptions(){return this.stateMachineOptions}buildStateMachineConfig(){let e={id:this.scene.getId(),initial:this.scene.children[0],states:{}},t=this.scene.getChildScenes();if(0===t.length)return e;for(let e of t)e.transitions=[],e.entryActions=[],e.exitActions=[];t.at(-1).next=t[0],t[0].prev=t.at(-1);let n=new of().addScenes(t).addTransformer(new o_(!0)).addTransformer(new oS(this.freeFormService)).addTransformer(new oE).addTransformer(new ob).addTransformer(new oy).build(),i=new rq().convertScenes(n);return I(g({},e),{states:i})}getSceneForState(e){return rZ(e,this.scene.getChildScenes())}handleManualVideoTransition(e,t){this.reportingService.emit({type:"modular-event",event:"transition",data:{transition:e,scene_id:t}})}constructor(e,t,n=ed(),i){this.scene=e,this.sendAdEvent=t,this.reportingService=n,this.freeFormService=i,this.stateMachineConfig=this.buildStateMachineConfig(),this.stateMachineOptions=void 0}},oT=({duration:e,active:t,paused:n,restartKey:i,completed:r})=>rm("div",{role:"progressbar",title:"Modular progress",className:"S3Yt8a_segment","aria-label":"Modular progress","aria-current":t?"true":"false","data-paused":n.value?"true":"false","data-completed":r?"true":"false","data-duration":e,"data-type":"story-progress-segment",children:(t&&e>0||r)&&rm("span",{"data-key":i.value,className:ar(t?"S3Yt8a_active":"",n.value?"S3Yt8a_paused":"",r?"S3Yt8a_completed":""),style:{animationDuration:`${e}s`}},i.value)}),oA=(e,t)=>new n2(n=>{let i=e=>n.next(e);return e.addEventListener(t,i),{unsubscribe:()=>{e.removeEventListener(t,i)}}});let oI={delayMs:250};var ok=function(e={}){let t=g({},oI,e);return e=>new n2(n=>{let i=null,r=0,a=null,s=e.subscribe({next:e=>{let s=Date.now();if(s-r<t.delayMs){i&&(clearTimeout(i),i=null),r=0,a=null,n.next({kind:"double",event:e});return}r=s,a=e,i&&clearTimeout(i),i=setTimeout(()=>{a&&n.next({kind:"single",event:a}),a=null,i=null},t.delayMs)},error:e=>{var t;return null==(t=n.error)?void 0:t.call(n,e)},complete:()=>{var e;null==(e=n.complete)||e.call(n)}});return{unsubscribe:()=>{i&&clearTimeout(i),s.unsubscribe()}}})},oO=({scene:e,durations:t,activeState:n,handleClick:i,restartKey:r,viewabilityReportingService:a=eh()})=>{let s=eQ(null),o=eQ(null),l=tT(!1),c=t=>e.getChildScenes().findIndex(e=>e.getId()===t);return as("viewability",(e,t)=>{l.value=["internal-minimized","minimized"].includes(t.event)},a),((e,t,n,i=oA)=>{eX(()=>{let r=e.current,a=t.current;if(!r||!a)return;let s=((...e)=>new n2(t=>{let n=0,i=e.length,r=[];return e.forEach(e=>{let a=e.subscribe({next:t.next,error:t.error,complete:()=>{var e;(n+=1)===i&&(null==(e=t.complete)||e.call(t))}});r.push(a)}),{unsubscribe:()=>{r.forEach(e=>e.unsubscribe())}}}))(i(r,"click").pipe(ok()),i(a,"click").pipe(ok())).pipe(ia(e=>e.event.target===a?"previous":"next")).subscribe({next:e=>n(e)});return()=>{s.unsubscribe()}},[])})(s,o,i),rm("div",{id:"story-progress",className:ar("_6ix-Eq_storyProgress",sm),"aria-label":"story-progress",children:[rm("div",{className:"_6ix-Eq_gradient"}),rm("div",{className:"_6ix-Eq_segmentContainer",children:e.getChildScenes().map(e=>{var i;return rm(oT,{duration:null!=(i=t.value[e.getId()])?i:0,active:e.getId()===n,paused:l,restartKey:r,completed:c(e.getId())<c(n)},e.getId())})}),rm("div",{id:"story-progress-controls",children:[rm("button",{type:"button",id:"story-progress-previous-button",className:"_6ix-Eq_prev",ref:o}),rm("button",{type:"button",id:"story-progress-next-button",className:"_6ix-Eq_next",ref:s})]})]})};let oD=to(!1);var oV=({scene:e,sendAdEvent:t,modularService:n,theatreModeReportingService:i})=>{let r=tT(0),a=eZ(()=>null!=n?n:new ow(e,t),[e,t]),s=eZ(()=>e.getLastChanceEndcardConfig(),[e]),[o,l]=rX(a.getStateMachineConfig(),a.getStateMachineOptions()),[,c,d]=((e,t,n,i=rf)=>{let r=tT({}),a=eZ(()=>t.getSceneForState(n.value),[n.value.value]);eX(()=>{let t={};for(let n of(e.getChildScenes().forEach(e=>{t[e.getId()]=i(e.getId())}),r.value=t,Object.values(t)))null==n||n.send({type:"PAUSE"})},[e]);let s=eJ(e=>{for(let t of Object.values(r.value))null==t||t.send({type:e})},[r.value]);eX(()=>{if(!a)return;s("PAUSE");let e=r.value[a.getId()];e&&(e.send({type:"RESET_PLAY"}),e.send({type:"PLAY"}))},[a]);let o=tT({});return eX(()=>{let t=[];for(let a of e.getChildScenes()){var n,r;let e=a.getId(),s=i(e);o.value=I(g({},o.value),{[e]:null!=(r=null==s?void 0:s.state.context.duration)?r:0});let l=null==s||null==(n=s.subscribe)?void 0:n.call(s,t=>{var n;let i=null!=(n=t.context.duration)?n:0;o.value[e]!==i&&(o.value=I(g({},o.value),{[e]:i}))});l&&t.push(l)}return()=>{for(let e of t)e.unsubscribe()}},[e]),[a,r,o]})(e,a,o);aY(e);let u=tT(void 0),h=((e,t,n,i=!1)=>eJ(r=>{"VIDEO_FAILURE"===r.type&&r.scene_id===n?e(i?{type:"LAST_CHANCE_ENDCARD"}:{type:"NEXT"}):["COMPLETE","NEXT","PREVIOUS","VIDEO_FAILURE"].includes(r.type)?t(r):e(r)},[e,t]))(t,l,e.children[e.children.length-1],s.enabled),v=eJ(e=>{oD.value=e},[]);return se({callToActionConfig:s.cta,sceneId:e.getId()}),a7({fullScreenClickConfig:s.fsc,sceneId:e.getId()}),as("scene-event",(e,t)=>{"nextButtonCountdownTick"===t.event&&(u.value=t.data.delay)}),tL(()=>{let e=rQ(o.value.value,"Modular component"),t=c.value[e];(null==t?void 0:t.state.matches("FAILED"))&&h({type:"VIDEO_FAILURE",scene_id:e})}),rm("div",{className:"SUBbvW_modular",children:[rm(aK,{config:s,sendAdEvent:t,onVisibilityChange:v,sceneId:e.getId()}),!e.isChild()&&!oD.value&&rm(aB,{config:e.getCloseButtonConfig(u.value),sendAdEvent:t,showLastChanceEndcard:s.enabled}),rm("div",{className:"SUBbvW_modular",children:[rm(oO,{scene:e,durations:d,activeState:rQ(o.value.value,"Modular component"),handleClick:t=>{let n=rQ(o.value.value,"Modular component");if("next"===t)a.handleManualVideoTransition("next",n),h({type:"NEXT"});else if("previous"===t)if(e.getChildScenes()[0].getId()===n){let e=c.value[n];a.handleManualVideoTransition("restart",n),null==e||e.send({type:"RESTART"}),r.value+=1}else a.handleManualVideoTransition("previous",n),h({type:"PREVIOUS"})},restartKey:r}),e.getChildScenes().map(e=>{let t=rQ(o.value.value,"Modular component"),n=e.getId()===t;return iQ(e)?rm("div",{style:{opacity:+!!n,pointerEvents:n?"auto":"none"},children:rm(sY,{scene:e,sendAdEvent:h,showVideoBlur:!1,theatreModeReportingService:i},e.getId())},`modular-child-${e.getId()}`):null})]})]})},oL=({theatreModeReportingService:e=nO()})=>{let[t,n]=(()=>{let e=r$(),t=e.send,n=tT(e.state),[i,r]=rX(eZ(()=>({id:"throttle-ad",initial:"IDLE",context:{},states:{IDLE:{on:{CALL:{target:"BUSY"}}},BUSY:{on:{DONE:{target:"IDLE"}}}}}),[])),a=eZ(()=>e=>{["NEXT","LAST_CHANCE_ENDCARD","LAST_CHANCE_ENDCARD_CLOSE"].includes(e.type)?i.value.matches("IDLE")&&(r({type:"CALL"}),t(e),window.setTimeout(()=>{r({type:"DONE"})},500)):t(e)},[i,r]);return eX(()=>{let t=e.subscribe(e=>{let t=n.value;if(n.value=e,e.changed&&t.value!==e.value){let n=rZ(t),i=nl.get();i.end(n);let r=rZ(e);t2.setValue({scene:r}),i.start(r),r0(r),["video","endcard","composite","image"].includes(r.getSceneType())&&nC.get().pause()}});return()=>{t.unsubscribe()}},[e]),[n,a]})(),i=rZ(t.value),r=i.getSceneType();aD(om,i),((e,t=nC.get())=>{eX(()=>{t.clearScene(e)},[e])})(i.getId());let{isPrivacyButtonVisible:a,shouldRenderIFrame:s,shouldRenderPictureInPicture:o}=t.value.context;return rm("div",{id:"gRz7DW_ad",children:rm(ai,{children:[rm(ao,{}),rm(au,{}),o&&rm(og,{}),a&&"closed"!==r&&rm(aO,{sendAdEvent:n}),rm(od,{scene:i,sendEvent:n,shouldRenderIFrame:s,theatreModeReportingService:e}),i8(i)&&rm(ov,{scene:i,sendAdEvent:n},i.getId()),sp(i)&&rm(oV,{scene:i,sendAdEvent:n},i.getId()),"closed"===r&&rm(an,{})]})})},oN=async(e,t,n)=>{var i;let r={adCount:0,sameCreative:0,sameVideo:0},a=t.get("AD_SOURCE"),s=t.get("CREATIVE_ID"),o=null!=(i=t.get("ORIGINAL_VIDEO_URL"))?i:t.get("MAIN_STREAM");return(await e.getAllRecords()).forEach(({placementType:e,creativeId:t,adSource:i,videoUrl:l})=>{e===n&&(r.adCount+=1),t===s&&i===a&&(r.sameCreative+=1),l===o&&(r.sameVideo+=1)}),{ad_count:r.adCount,same_creative:r.sameCreative,same_video:r.sameVideo}};let ox={video:"ad-start-with-video",endcard:"ad-start-with-endcard",adStart:"ad-start",lastChanceEndcard:"ad-start-with-last-chance-endcard"},oP=(e,t=new Set,n=[ox.adStart],i=null)=>{if(0===e.length)return i&&!n.includes(ox.lastChanceEndcard)?[...n,ox.lastChanceEndcard]:n;let[r,...a]=e,s=r.getSceneType(),o=oC(r),l=i;return(o&&!i&&(l=r),!t.has(s)&&s in ox)?(t.add(s),oP(a,t,[...n,ox[s]],l)):oP(a,t,n,l)},oR=async(e=nN.get(),t=h.get(),n=eo.getValue(),i=tU(),r=oN,a=i$)=>{let s={name:"ad-start",metric:"ad-start",elapsed:Date.now()-c.getInstance().startTimestamp};await e.addRecord();let o=g({},s,await r(e,t,n.placement.type)),l=oP(a()).map(e=>I(g({},o),{metric:e}));i.emit(l)};var oM=(e=i$())=>{let t=[],n=e=>{e.forEach(e=>{let i=e.getSceneType();["video","endcard"].includes(i)&&t.push(e),["composite","modular"].includes(i)&&n(e.getChildScenes())})};return n(e),t.some(e=>e.muted)},oB=(e,t,n,i,r,a,s)=>{var o,l,d,u;let h,v=c.getInstance(),p=a.getValue().scene,m=g({ad_duration:s(v.startTimestamp,i),is_ado_enabled:n.device.ado,adv_app_store_id:n.advertiser.appStoreId,advertiser_domain:n.advertiser.domain,country_code:n.device.countryCode,creative_id:n.advertiser.creative.id,creative_type:n.advertiser.creative.type,delivery_to_ad_start:(h=new Date(1e3*parseInt((null!=(u=e.get("SESSION_ID"))?u:"").substring(0,8),16)),v.startTimestamp-h.getTime()),dsp:n.advertiser.rtb.name,elapsed:Date.now()-v.startTimestamp,event_id:n.platform.sessionId,is_header_bidding:n.advertiser.headerBidding,is_incentivized:n.placement.is.rewarded,mediation_name:n.advertiser.mediation,nautilus_version:n.platform.nautilusVersion,observed_experiments:n.platform.observedExperiments,os_version:n.device.os.version,placement_id:n.placement.id,placement_reference_id:n.placement.referenceId,placement_type:n.placement.type,platform:n.device.os.name,pub_app_store_id:n.publisher.id,rtb_id:n.advertiser.rtb.id,rtb_name:n.advertiser.rtb.name,scene_id:null!=(o=null==p?void 0:p.getId())?o:"",scene_type:null!=(l=null==p?void 0:p.getSceneType())?l:"",sdk_version:n.sdk.version,template_version:null!=(d=window.appVersion)?d:"0.0.0",is_viewable:r.isViewable()},null==p?void 0:p.getObservabilityData());return"accelerate"===n.advertiser.rtb.name&&n.platform.accTests&&(m.acc_tests=n.platform.accTests),m},oF=e=>{var t;return!!e&&(null==e||null==(t=e.trim())?void 0:t.toLowerCase())==="true"},oU=class{getUrl(){return`${this.endpoint}/vm/logs`}getObservabilitySequenceId(){return`${this.adData.platform.sessionId}_${this.sequenceId++}`}pushEvent(e,t,n){this.sendLog(g(I(g({},oB(this.tokenService,this.networkRequestService,this.adData,this.reportingService,this.viewableService,this.sceneContext,this.getAdDuration)),{kind:"event",observability_sequence_id:this.getObservabilitySequenceId(),timestamp:null!=n?n:new Date,name:e}),t))}pushManyEvents(e){this.sendLog(e.map(e=>g(I(g({},oB(this.tokenService,this.networkRequestService,this.adData,this.reportingService,this.viewableService,this.sceneContext,this.getAdDuration)),{kind:"event",observability_sequence_id:this.getObservabilitySequenceId(),timestamp:new Date}),e)))}pushError(e,t,n){let i="",r="";if("string"==typeof e)i=e;else{var a,s;r=null!=(a=null==e?void 0:e.stack)?a:"",i=null!=(s=null==e?void 0:e.message)?s:""}this.sendLog(g(I(g({},oB(this.tokenService,this.networkRequestService,this.adData,this.reportingService,this.viewableService,this.sceneContext,this.getAdDuration)),{kind:"error",message:i,observability_sequence_id:this.getObservabilitySequenceId(),stack:r,timestamp:null!=n?n:new Date}),t))}isObserved(){return oF(this.tokenService.get("OBSERVABILITY"))}sendLog(e){this.isObserved()&&this.networkRequestService.post(this.getUrl(),{requestData:e})}constructor(e,t,n,i,r,a,s,o){this.endpoint=e,this.tokenService=t,this.networkRequestService=n,this.adData=i,this.reportingService=r,this.viewableService=a,this.sceneContext=s,this.getAdDuration=o,this.sequenceId=0}},oH=(e,t,n,i,r,a,s)=>new oU("https://logs.ads.vungle.com",e,t,n,i,r,a,s);let oW=()=>({id:r1,initial:"INITIAL",context:{delay:0,openCount:0,appStoreId:void 0},states:{INITIAL:{on:{READY:{target:"PREPARING",actions:["setAppStoreId","prepareStoreView"]}}},PREPARING:{on:{PREPARE_SUCCESS:{target:"HIDDEN"}}},SHOWING:{on:{CLOSE:{target:"INITIAL",actions:["closeStoreView","removeViewabilityHandler"]}}},HIDDEN:{on:{OPEN:{target:"SHOWING",actions:["addViewabilityHandler","updateOpenCount","openStoreView"]}}},FALLBACK:{},DONE:{}}}),oG=(e=tG.get(),t=eh(),n=r6(),i=r3())=>({actions:I(g({},r5(e,t,n,i).actions),{setAppStoreId:K({appStoreId:(e,t)=>t.appStoreId||e.appStoreId}),prepareStoreView:t=>{t.appStoreId&&e.prepareStoreView(t.appStoreId)},openStoreView:t=>{t.appStoreId&&(n.emit({type:"app-store-product-view",event:"appStoreOpen"}),e.presentStoreView(t.appStoreId))}})});class oK extends r8{init(e){this.interpreter.send(g({type:"READY"},e))}close(){this.interpreter.send({type:"CLOSE"}),this.interpreter.send({type:"READY"})}setPrepared(){this.interpreter.send({type:"PREPARE_SUCCESS"})}constructor(e=oW,t=oG,n=j.get()){super(e(),t(),n)}}oK.identifier=rL;var oj=oK;let oY=()=>{let e=r4(),t=e.states.SHOWING;return t.on=I(g({},t.on),{CLOSE:{target:"DONE",actions:["closeStoreView","removeViewabilityHandler"]}}),e},oq=()=>oY();class oz extends ae{constructor(e=oq,t=r5,n=j.get()){super(e,t,n)}}oz.identifier=rL;let o$=()=>{let e=oW(),t=e.states.SHOWING;return t.on=I(g({},t.on),{CLOSE:{target:"DONE",actions:["closeStoreView","removeViewabilityHandler"]}}),e},oX=()=>o$();var oQ=class extends oj{constructor(e=oX,t=oG,n=j.get()){super(e,t,n)}};class oZ extends ae{constructor(e=oY,t=r5,n=j.get()){super(e,t,n)}}oZ.identifier=rL;var oJ=class extends oj{constructor(e=o$,t=oG,n=j.get()){super(e,t,n)}},o0=class{withAppStoreId(e,t){return t&&e.init({appStoreId:t}),e}resolve(){if(this.adData.device.skpv.hasSwipeIssue){if(this.adData.sdk.is.v71xOrAbove&&this.adData.sdk.is.below721)return new oz;if(this.adData.sdk.is.v70x&&this.adData.sdk.is.below71x)return this.withAppStoreId(new oQ,this.adData.advertiser.appStoreId)}return this.adData.device.skpv.hasMaskIssue?this.adData.sdk.is.v71xOrAbove?new oZ:this.withAppStoreId(new oJ,this.adData.advertiser.appStoreId):this.adData.sdk.is.v71xOrAbove?new ae:this.withAppStoreId(new oj,this.adData.advertiser.appStoreId)}constructor(e){this.adData=e}},o1=(e=h.get(),t=eo.getValue())=>!!t.placement.is.mrec||!!t.placement.is.banner||oF(e.get("START_MUTED"))||oF(e.get("REAL_START_MUTED")),o2=(e,t=!0)=>e.split(";").filter(Boolean).map(e=>{let{type:n,value:i}=(e=>{if(e.endsWith("p"))return{type:"percentage",value:Number(e.slice(0,-1))};let[t,n,i]=e.split("_").map(Number);return{type:"absolute",value:3600*t+60*n+i}})(e.split(".")[1]);return{name:e,type:n,value:i,useTpat:t}}),o3=(e,t)=>{if(t)return nE.AAK;switch(e){case"off":return nE.OFF;case"overlay_view":return nE.SKO;default:return nE.PV}},o6=(e,t=t8())=>{if(e)try{return JSON.parse(e)}catch(e){t.emit({type:"error-logging",event:"exception",data:{error:{message:"Failed to parse value of PARTIAL_FSC token"}}})}},o4=class{getFullScreenClickConfig(){let e=()=>this.isAAKSupportedRe?nE.AAK:["banner","mrec"].includes(this.placementType)?nE.PV:o3(this.skFullCtaTokenValue);return{enabled:"fullscreen"!==this.placementType||oF(this.fullCtaTokenValue),id:this.id,target:e(),ctaUrl:this.ctaButtonUrlTokenValue,styleData:o6(this.partialFscTokenValue,this.errorLoggingReportingService)}}constructor({fullCtaTokenValue:e,skFullCtaTokenValue:t,ctaButtonUrlTokenValue:n,isAAKSupportedRe:i,id:r,placementType:a,partialFscTokenValue:s,errorLoggingReportingService:o}){this.fullCtaTokenValue=e,this.skFullCtaTokenValue=t,this.ctaButtonUrlTokenValue=n,this.isAAKSupportedRe=i,this.id=r,this.placementType=a,this.partialFscTokenValue=s,this.errorLoggingReportingService=o}},o7=class{getStoreKitOverlayAutoShowConfig(){let e="adv_pref"===this.fullCtaOptionTokenValue,t=()=>!!this.storeKitOverlayService&&void 0!==this.appStoreId&&0!==this.appStoreId.length&&oF(this.skOverlayAutoTokenValue)&&e,n=()=>{var e;let t=Number.parseInt(null!=(e=this.skOverlayDelaySecondsTokenValue)?e:"0",10);return Number.isNaN(t)?0:1e3*Math.max(t,0)},i=()=>!!this.skOverlayAutoCloseTokenValue&&!["0","-1"].includes(this.skOverlayAutoCloseTokenValue),r=()=>{var e;let t=Number.parseInt(null!=(e=this.skOverlayAutoCloseTokenValue)?e:"0",10);return Number.isNaN(t)?5e3:Math.max(5e3,1e3*t)},a="false"===this.skOverlayDisableAutoMMPTokenValue;return{enabled:t(),autoShowDelay:n(),isAutoClose:i(),autoCloseDelay:r(),openCallback:a?()=>this.callToActionService().fireMMPEvents():()=>{}}}constructor(e,t,n,i,r,a,s=()=>a4.get(),o=t3(rV)){this.appStoreId=e,this.fullCtaOptionTokenValue=t,this.skOverlayAutoTokenValue=n,this.skOverlayDelaySecondsTokenValue=i,this.skOverlayAutoCloseTokenValue=r,this.skOverlayDisableAutoMMPTokenValue=a,this.callToActionService=s,this.storeKitOverlayService=o}},o5=class{getAppStoreOnDelayConfig(){var e;let t=Number(null!=(e=this.appStoreOnVideoAutoDelayTokenValue)?e:"0");return{enabled:(()=>!!this.productViewService&&void 0!==this.appStoreId&&0!==this.appStoreId.length&&!this.isInLinePlacement&&!Number.isNaN(t)&&Number.isFinite(t)&&t>0)(),autoShowDelay:Number.isNaN(t)||!Number.isFinite(t)||t<3e3?3e3:t}}constructor(e,t,n=!1,i=t3(rL)){this.appStoreOnVideoAutoDelayTokenValue=e,this.appStoreId=t,this.isInLinePlacement=n,this.productViewService=i}},o8=class{getDelay(){return oF(this.incentivizedTokenValue)&&this.incentivizedCloseButtonDelaySecondsTokenValue?Number(this.incentivizedCloseButtonDelaySecondsTokenValue):this.closeButtonDelaySecondsTokenValue?Number(this.closeButtonDelaySecondsTokenValue):0}getCountDown(){return void 0===this.showVideoCloseButtonCountDownTokenValue||oF(this.showVideoCloseButtonCountDownTokenValue)}getStyle(){return oF(this.videoCloseButtonAsSkipTokenValue)?nQ.SKIP:nQ.CLOSE}getCloseButtonConfig(){return{delay:this.getDelay(),style:this.getStyle(),countdown:this.getCountDown()}}constructor({closeButtonDelaySecondsTokenValue:e,incentivizedCloseButtonDelaySecondsTokenValue:t,incentivizedTokenValue:n,videoCloseButtonAsSkipTokenValue:i,showVideoCloseButtonCountDownTokenValue:r}){this.closeButtonDelaySecondsTokenValue=e,this.incentivizedCloseButtonDelaySecondsTokenValue=t,this.incentivizedTokenValue=n,this.videoCloseButtonAsSkipTokenValue=i,this.showVideoCloseButtonCountDownTokenValue=r}};let o9=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short"});var le=class{hasAppMetadata(){return!!(this.appIcon&&this.appName)}getAppRatingCount(){var e;let t=Number.parseInt(null!=(e=this.appRatingCount)?e:"",10);return Number.isInteger(t)&&Number.isFinite(t)?o9.format(t):""}getAppContentRatingImg(){var e,t;return null!=(t=({Everyone:"https://cdn-lb.vungle.com/esrb/E.svg","Everyone 10+":"https://cdn-lb.vungle.com/esrb/E10plus.svg",Teen:"https://cdn-lb.vungle.com/esrb/T.svg","Mature 17+":"https://cdn-lb.vungle.com/esrb/M.svg","Adults Only 18+":"https://cdn-lb.vungle.com/esrb/AO.svg"})[null!=(e=this.appContentRating)?e:""])?t:""}getAppDownloadCount(){let{appDownloadCount:e}=this;if(!e)return"";if(/[KMB]/.test(e))return e;e.includes("-")&&([e]=e.split("-"));let t=Number(e=e.replaceAll(/[,+ ]+/g,""));return t?`${new Intl.NumberFormat("en-US",{notation:"compact",maximumFractionDigits:0}).format(t)}+`:""}getAppRating(){var e,t;let n=null!=(t=null!=(e=this.appRating)?e:this.appStoreRating)?t:"4.4",i=n.lastIndexOf("/")+1,r=n.indexOf("-stars.svg"),a=n.substring(i,r);if(a){let e=Number.parseFloat(a);if(!Number.isNaN(e))return e}let s=Number.parseFloat(n);return Number.isNaN(s)?Number.parseFloat("4.4"):s}getAppName(){var e;if(this.appNameEncoded)try{return nm(this.appNameEncoded)}catch(e){}return null!=(e=this.appName)?e:""}getAppDescription(){var e;if(this.appDescriptionEncoded)try{return nm(this.appDescriptionEncoded)}catch(e){}return null!=(e=this.appDescription)?e:""}getAppLongDescription(){var e;if(this.appLongDescriptionEncoded)try{return nm(this.appLongDescriptionEncoded)}catch(e){}return null!=(e=this.appLongDescription)?e:""}getCtaButtonText(){if(this.ctaButtonTextEncoded)try{return nm(this.ctaButtonTextEncoded)}catch(e){}return this.ctaButtonText&&""!==this.ctaButtonText.trim()?this.ctaButtonText:this.hasAppMetadata()&&this.appStoreId?"GET":"Open"}getCtaButtonDelay(){var e;let t=Number.parseInt(null!=(e=this.ctaButtonDelay)?e:"",10);return Number.isInteger(t)&&Number.isFinite(t)?t:0}getCtaButtonUrl(){var e;return null!=(e=this.ctaButtonUrl)?e:""}getAppMetaData(){var e;return{enabled:this.hasAppMetadata(),company:this.getAppDescription(),contentRating:null!=(e=this.appContentRating)?e:"",contentRatingImg:this.getAppContentRatingImg(),description:this.getAppLongDescription(),downloads:this.getAppDownloadCount(),icon:this.appIcon,isRatingGreaterThanMinimum:this.getAppRating()>=4,minimumAppRating:4,name:this.getAppName(),price:"",rating:this.getAppRating(),ratingCount:this.getAppRatingCount(),screenshots:((e,t=t8())=>{if(!e)return[];try{let t=JSON.parse(e);if(!Array.isArray(t))return[];return t.slice(0,4)}catch(e){t.emit({type:"error-logging",event:"resource",data:{error:{message:"Unable to parse app screenshots"}}})}return[]})(this.appScreenShots,this.errorLoggingReportingService)}}constructor({ctaButtonUrl:e,ctaButtonText:t,ctaButtonTextEncoded:n,ctaButtonDelay:i,appName:r,appIcon:a,appDescription:s,appRatingCount:o,appLongDescription:l,appContentRating:c,appScreenShots:d,appDownloadCount:u,appRating:h,appStoreRating:v,appStoreId:p,appNameEncoded:g,appDescriptionEncoded:m,appLongDescriptionEncoded:f,errorLoggingReportingService:S=t8()}){this.ctaButtonUrl=e,this.ctaButtonText=t,this.ctaButtonTextEncoded=n,this.ctaButtonDelay=i,this.appName=r,this.appIcon=a,this.appDescription=s,this.appRatingCount=o,this.appLongDescription=l,this.appContentRating=c,this.appScreenShots=d,this.appDownloadCount=u,this.appRating=h,this.appStoreRating=v,this.appStoreId=p,this.appNameEncoded=g,this.appDescriptionEncoded=m,this.appLongDescriptionEncoded=f,this.errorLoggingReportingService=S}};let lt=(e,t=eo.getValue(),n=h.get())=>({appNameEncoded:n.get("APP_NAME_ENCODED"),appStoreId:n.get("APP_STORE_ID"),ctaButtonDelay:n.get("DOWNLOAD_BUTTON_DELAY_SECONDS"),ctaButtonText:n.get("CTA_BUTTON_TEXT"),ctaButtonTextEncoded:n.get("CTA_BUTTON_ENCODED_TEXT"),ctaButtonUrl:n.get("CTA_BUTTON_URL"),ctaTarget:nE.PV,enabled:!1,endcardCloseButtonDelaySeconds:n.get("EC_CLOSE_BUTTON_DELAY_SECONDS"),fullCtaTokenValue:n.get("FULL_CTA"),hasEndcard:n.has("EC_HTML")||n.has("EC_IMAGE"),hasVideo:n.has("MAIN_VIDEO")||n.has("MAIN_STREAM"),icon:n.get("APP_ICON"),id:e,isFullscreen:t.placement.is.fullscreen,name:n.get("APP_NAME"),partialFscTokenValue:n.get("PARTIAL_FSC"),showECCloseButtonCountDownTokenValue:n.get("SHOW_EC_CLOSE_BUTTON_COUNTDOWN"),skCtaOnlyTokenValue:n.get("SK_CTA_ONLY"),skFscTokenValue:n.get("SK_FSC"),staticEndcardCloseButtonDelaySeconds:n.get("STATIC_EC_CLOSE_BUTTON_DELAY_SECONDS")});var ln=class extends le{getCloseDelay(){let e=this.hasVideo&&!this.hasEndcard,t=3;return e&&this.endcardCloseButtonDelaySeconds?t=Number(this.endcardCloseButtonDelaySeconds):this.staticEndcardCloseButtonDelaySeconds&&(t=Number(this.staticEndcardCloseButtonDelaySeconds)),Math.min(Math.max(t,1),e?6:30)}getCountDown(){return!this.showECCloseButtonCountDownTokenValue||"true"===this.showECCloseButtonCountDownTokenValue}getLastChanceEndcardConfig(){var e;return{enabled:this.isFullscreen&&this.enabled,id:this.id,appMeta:this.getAppMetaData(),cta:{text:this.getCtaButtonText(),url:this.ctaButtonUrl||"",isPersistent:!1,target:o3(this.skCtaOnlyTokenValue),delay:Number.parseInt(null!=(e=this.ctaButtonDelay)?e:"4",10)},fsc:{enabled:oF(this.fullCtaTokenValue),ctaUrl:this.ctaButtonUrl,target:o3(this.skFscTokenValue),styleData:o6(this.partialFscTokenValue,this.errorLoggingReportingService)},close:{delay:this.getCloseDelay(),style:nQ.CLOSE,countdown:this.getCountDown()}}}setLastChanceEndcardConfig(){}constructor({appNameEncoded:e,appStoreId:t,ctaButtonDelay:n,ctaButtonText:i,ctaButtonTextEncoded:r,ctaButtonUrl:a,ctaTarget:s,enabled:o,endcardCloseButtonDelaySeconds:l,fullCtaTokenValue:c,hasEndcard:d,hasVideo:u,icon:h,id:v,isFullscreen:p,name:g,partialFscTokenValue:m,showECCloseButtonCountDownTokenValue:f,skCtaOnlyTokenValue:S,skFscTokenValue:y,staticEndcardCloseButtonDelaySeconds:C},E){super({ctaButtonUrl:a,ctaButtonText:i,ctaButtonTextEncoded:r,ctaButtonDelay:n,appName:g,appIcon:h,appStoreId:t,appNameEncoded:e,errorLoggingReportingService:E}),this.appNameEncoded=e,this.appStoreId=t,this.ctaButtonDelay=n,this.ctaButtonText=i,this.ctaButtonTextEncoded=r,this.ctaButtonUrl=a,this.ctaTarget=null!=s?s:nE.PV,this.enabled=o,this.endcardCloseButtonDelaySeconds=l,this.fullCtaTokenValue=c,this.hasEndcard=!!d,this.hasVideo=!!u,this.icon=h,this.id=v,this.isFullscreen=!!p,this.appName=g,this.partialFscTokenValue=m,this.showECCloseButtonCountDownTokenValue=f,this.skCtaOnlyTokenValue=S,this.skFscTokenValue=y,this.staticEndcardCloseButtonDelaySeconds=C}},li=e=>{var t;return!!e&&(null==e||null==(t=e.trim())?void 0:t.toLowerCase())==="false"},lr=class{getProgressBarConfig(){var e,t;return{show:!this.isBanner&&!li(this.videoProgressBarTokenValue),color:null!=(t=null!=(e=this.videoProgressBarColorTokenValue)?e:this.ctaButtonBackgroundTokenValue)?t:iu}}constructor({videoProgressBarTokenValue:e,videoProgressBarColorTokenValue:t,ctaButtonBackgroundTokenValue:n,isBanner:i}){this.videoProgressBarTokenValue=e,this.videoProgressBarColorTokenValue=t,this.ctaButtonBackgroundTokenValue=n,this.isBanner=i}},la=class{getTrackingEventMapConfig(){return{enabled:this.enabled,events:this.events}}constructor(e,t){this.enabled=e,this.events=t}},ls=(e,t)=>({ctaButtonUrl:e.get("CTA_BUTTON_URL"),ctaButtonText:e.get("CTA_BUTTON_TEXT"),ctaButtonTextEncoded:e.get("CTA_BUTTON_ENCODED_TEXT"),ctaButtonDelay:e.get("DOWNLOAD_BUTTON_DELAY_SECONDS"),appName:e.get("APP_NAME"),appIcon:e.get("APP_ICON"),appDescription:e.get("APP_DESCRIPTION"),appRatingCount:e.get("APP_RATING_COUNT"),appLongDescription:e.get("APP_LONG_DESCRIPTION"),appContentRating:e.get("APP_CONTENT_RATING"),appScreenShots:e.get("APP_SCREENSHOTS"),appDownloadCount:e.get("APP_DOWNLOAD_COUNT"),appRating:e.get("APP_RATING"),appStoreRating:e.get("APP_STORE_RATING"),appStoreId:e.get("APP_STORE_ID"),appNameEncoded:e.get("APP_NAME_ENCODED"),appDescriptionEncoded:e.get("APP_DESCRIPTION_ENCODED"),appLongDescriptionEncoded:e.get("APP_LONG_DESCRIPTION_ENCODED"),errorLoggingReportingService:t}),lo=class extends le{getCallToActionTarget(){return this.isAAKSupportedRe?nE.AAK:this.adData.placement.is.banner||this.adData.placement.is.mrec?nE.PV:o3(this.skCtaOnlyTokenValue)}isPersistentCtaEnabled(){let e=this.adData.placement.is.fullscreen||this.adData.placement.is.mrec||this.adData.placement.is.inLine,t=oF(this.blockPersistentCtaTokenValue);return e&&!t}getCallToActionConfig(){return{isPersistent:this.isPersistentCtaEnabled(),target:this.getCallToActionTarget(),url:super.getCtaButtonUrl(),text:super.getCtaButtonText(),appMeta:super.getAppMetaData(),delay:super.getCtaButtonDelay()}}constructor({appStoreId:e,skCtaOnlyTokenValue:t,blockPersistentCtaTokenValue:n,appMetaProviderParams:i,adData:r,isAAKSupportedRe:a}){super(i),this.appStoreId=e,this.skCtaOnlyTokenValue=t,this.blockPersistentCtaTokenValue=n,this.adData=r,this.isAAKSupportedRe=a}},ll=class{getManifestMetadata(){if(void 0!==this.mainManifestTokenValue&&""!==this.mainManifestTokenValue)return{manifest:nm(this.mainManifestTokenValue),tracks:this.getTracks(),chunks:this.chunkSeriesValues,chunk_init:this.chunkInitTokenValue}}constructor(e,t,n,i,r,a=t8()){this.mainManifestTokenValue=e,this.track0TokenValue=t,this.allTracksTokenValue=n,this.chunkSeriesValues=i,this.chunkInitTokenValue=r,this.errorLoggingReportingService=a,this.getTracks=()=>{if(this.allTracksTokenValue)try{return JSON.parse(nm(this.allTracksTokenValue))}catch(e){this.errorLoggingReportingService.emit({type:"error-logging",event:"exception",data:{error:{message:"Failed to parse HLS tracks"}}})}return this.track0TokenValue?{0:nm(this.track0TokenValue)}:{}}}},lc=class{getIncentivizedConfig(){return{enabled:this.enabled,incentivizedCloseButtonDelaySeconds:this.incentivizedCloseButtonDelaySeconds,isIncentiveTiedToCloseButtonDelay:this.isIncentiveTiedToCloseButtonDelay,shouldNotifySuccessfulViewAd:!0,fireOnlyOnce:!0}}constructor({enabled:e=!1,incentivizedCloseButtonDelaySeconds:t,isIncentiveTiedToCloseButtonDelay:n=!1}){this.enabled=e,this.incentivizedCloseButtonDelaySeconds=t,this.isIncentiveTiedToCloseButtonDelay=n}},ld=class{getOmsdkData(){try{if(this.multiOmsdkDataTokenValue)return this.multiOmsdkDataTokenValue.split("@").map(e=>JSON.parse(atob(e)));if(this.omsdkDataTokenValue)return[JSON.parse(atob(this.omsdkDataTokenValue))]}catch(e){this.errorLoggingReportingService.emit({type:"error-logging",event:"exception",data:{error:{message:"Failed to parse OMSDK data"}}})}return[]}isEnabled(){return oF(this.omsdkEnabledTokenValue)&&this.getOmsdkData().length>0}getOmsdkConfig(){return{enabled:this.isEnabled(),data:this.getOmsdkData()}}constructor(e,t,n,i=t8()){this.omsdkEnabledTokenValue=e,this.omsdkDataTokenValue=t,this.multiOmsdkDataTokenValue=n,this.errorLoggingReportingService=i}},lu=class{createInstances(){var e;if(!(null==(e=this.adData)?void 0:e.advertiser))return[];let t=[];return["MAIN_VIDEO","MAIN_STREAM"].filter(e=>this.tokenService.has(e)).forEach((e,n)=>{var i,r,a,s,o;let l,c=`video_${n}`,d=new ln(lt(c,this.adData,this.tokenService),this.errorLoggingReportingService),u=new lo((a=this.tokenService,s=this.errorLoggingReportingService,o=this.adData,l=ls(a,s),{appStoreId:o.advertiser.appStoreId,skCtaOnlyTokenValue:a.get("SK_CTA_ONLY"),blockPersistentCtaTokenValue:a.get("BLOCK_PERSISTENT_CTA"),isAAKSupportedRe:oF(a.get("AAK_SUPPORTED_RE")),appMetaProviderParams:l,adData:o})).getCallToActionConfig(),h=new o7(this.adData.advertiser.appStoreId,this.tokenService.get("FULL_CTA_OPTION"),this.tokenService.get("SKOVERLAY_AUTO"),this.tokenService.get("SKOVERLAY_DELAY_SECONDS"),this.tokenService.get("SKOVERLAY_AUTO_CLOSE"),this.tokenService.get("SKOVERLAY_DISABLE_AUTO_MMP")).getStoreKitOverlayAutoShowConfig(),v=Number(this.tokenService.get("VIDEO_DURATION")),p={id:c,url:null!=(i=this.tokenService.get(e))?i:"",index:n,isAlternative:!1,videoType:"MAIN_STREAM"===e?"hls":"mp4",streamManifest:new ll(this.tokenService.get("MAIN_MANIFEST"),this.tokenService.get("TRACK_0"),this.tokenService.get("TRACKS"),this.tokenService.getSeriesValues("STREAM_CHUNK_"),this.tokenService.get("INIT_STREAM_CHUNK"),this.errorLoggingReportingService).getManifestMetadata(),audioManifest:new ll(this.tokenService.get("MAIN_MANIFEST"),this.tokenService.get("AUDIO_TRACK_0"),this.tokenService.get("AUDIO_TRACKS"),this.tokenService.getSeriesValues("AUDIO_CHUNK_"),this.tokenService.get("INIT_AUDIO_CHUNK"),this.errorLoggingReportingService).getManifestMetadata(),theatreModeEnabled:oF(this.tokenService.get("THEATRE_MODE")),progressBarConfig:new lr({videoProgressBarTokenValue:this.tokenService.get("VIDEO_PROGRESS_BAR"),videoProgressBarColorTokenValue:this.tokenService.get("VIDEO_PROGRESS_BAR_COLOR"),ctaButtonBackgroundTokenValue:this.tokenService.get("CTA_BUTTON_BACKGROUND"),isBanner:this.adData.placement.is.banner}).getProgressBarConfig(),fullScreenClickConfig:new o4({fullCtaTokenValue:this.tokenService.get("FULL_CTA"),skFullCtaTokenValue:this.tokenService.get("SK_FSC"),partialFscTokenValue:this.tokenService.get("PARTIAL_FSC"),ctaButtonUrlTokenValue:this.tokenService.get("CTA_BUTTON_URL"),isAAKSupportedRe:oF(this.tokenService.get("AAK_SUPPORTED_RE")),id:c,placementType:this.adData.placement.type,errorLoggingReportingService:this.errorLoggingReportingService}).getFullScreenClickConfig(),inlineInstallConfig:{url:this.tokenService.get("INLINE_INSTALL_URL")},storeKitOverlayAutoShowConfig:h,appStoreOnDelayConfig:new o5(this.tokenService.get("APP_STORE_ON_VIDEO_AUTO_DELAY"),this.adData.advertiser.appStoreId,this.adData.placement.is.inLine).getAppStoreOnDelayConfig(),callToActionConfig:u,lastChanceEndcardConfig:d.getLastChanceEndcardConfig(),trackingEventMapConfig:new la(!1).getTrackingEventMapConfig(),closeButtonConfigProvider:new o8({closeButtonDelaySecondsTokenValue:this.tokenService.get("CLOSE_BUTTON_DELAY_SECONDS"),incentivizedCloseButtonDelaySecondsTokenValue:this.tokenService.get("INCENTIVIZED_CLOSE_BUTTON_DELAY_SECONDS"),incentivizedTokenValue:this.tokenService.get("INCENTIVIZED"),videoCloseButtonAsSkipTokenValue:this.tokenService.get("VIDEO_CLOSE_BUTTON_AS_SKIP"),showVideoCloseButtonCountDownTokenValue:this.tokenService.get("SHOW_VIDEO_CLOSE_BUTTON_COUNTDOWN")}),originalVideoUrl:this.tokenService.get("ORIGINAL_VIDEO_URL"),loopVideo:+!!(oF(this.tokenService.get("VIDEO_LOOPING"))||iX.isVideoOnly(this.tokenService)),showDownloadButton:!!this.adData.advertiser.appStoreId&&oF(this.tokenService.get("VIDEO_SHOW_CTA"))&&(!u.isPersistent||h.enabled),isFullscreen:this.adData.placement.is.fullscreen,muted:o1(this.tokenService,this.adData),shouldSplitVideoEndcardClick:oF(this.tokenService.get("VIDEO_ENDCARD_CLICK_SPLIT")),incentivizedConfig:new lc({enabled:oF(this.tokenService.get("INCENTIVIZED")),incentivizedCloseButtonDelaySeconds:this.tokenService.get("INCENTIVIZED_CLOSE_BUTTON_DELAY_SECONDS"),isIncentiveTiedToCloseButtonDelay:oF(this.tokenService.get("IS_INCENTIVE_TIED_TO_CLOSE_BUTTON_DELAY"))}).getIncentivizedConfig(),expectedVideoDuration:Number.isNaN(v)?void 0:v,omsdkConfig:new ld(this.tokenService.get("OM_ENABLED"),this.tokenService.get("OM_SDK_DATA"),this.tokenService.get("MULTI_OM_SDK_DATA"),this.errorLoggingReportingService).getOmsdkConfig(),progressEvents:o2(null!=(r=this.tokenService.get("TPAT_PROGRESS_EVENTS"))?r:"")};t.push(new iX(p))}),t}constructor(e,t,n){this.tokenService=e,this.errorLoggingReportingService=t,this.adData=n}},lh=class{getStoreKitOverlayAutoShowConfig(){let e,t=this.isEndcardOnly?this.skOverlayDelaySecondsTokenValue:this.ecSkOverlayDelaySecondsTokenValue,n=()=>!(!this.storeKitOverlayService||!this.appStoreId||li(this.skOverlayAutoTokenValue))&&!(this.endcardIndex>0)&&("adv_pref"===this.fullCtaOptionTokenValue||this.isEndcardOnly)&&!!t&&Number.parseInt(t,10)>=0,i=()=>!!this.skOverlayAutoCloseTokenValue&&!["0","-1"].includes(this.skOverlayAutoCloseTokenValue),r=()=>{var e;let t=Number.parseInt(null!=(e=this.skOverlayAutoCloseTokenValue)?e:"0",10);return Number.isNaN(t)?5e3:Math.max(5e3,1e3*t)},a="false"===this.ecSkOverlayDisableAutoMMPTokenValue&&0===this.endcardIndex;return{enabled:n(),isAutoClose:i(),autoShowDelay:Number.isNaN(e=Number.parseInt(null!=t?t:"5",10))?3e3:Math.max(3e3,1e3*e),autoCloseDelay:r(),openCallback:a?()=>this.callToActionService().fireMMPEvents():()=>{}}}constructor(e,t,n,i,r,a,s,o,l,c=()=>a4.get(),d=t3(rV)){this.endcardIndex=e,this.isEndcardOnly=t,this.appStoreId=n,this.fullCtaOptionTokenValue=i,this.skOverlayAutoTokenValue=r,this.skOverlayDelaySecondsTokenValue=a,this.ecSkOverlayDelaySecondsTokenValue=s,this.skOverlayAutoCloseTokenValue=o,this.ecSkOverlayDisableAutoMMPTokenValue=l,this.callToActionService=c,this.storeKitOverlayService=d}},lv=class{getAppStoreOnDelayConfig(){var e;let t=Number(null!=(e=this.appStoreOnEndcardAutoDelayTokenValue)?e:"0");return{enabled:(()=>!!this.productViewService&&void 0!==this.appStoreId&&0!==this.appStoreId.length&&0===this.endcardIndex&&!Number.isNaN(t)&&Number.isFinite(t)&&t>0)(),autoShowDelay:Number.isNaN(t)||!Number.isFinite(t)||t<3e3?3e3:t}}constructor(e,t,n,i=t3(rL)){this.endcardIndex=e,this.appStoreId=t,this.appStoreOnEndcardAutoDelayTokenValue=n,this.productViewService=i}},lp=class{getCloseButtonConfig(){return{delay:this.getDelay(),style:this.getStyle(),countdown:this.getCountDown()}}constructor({ecCloseButtonDelaySecondsTokenValue:e,staticEcCloseButtonDelaySecondsTokenValue:t,endcardCloseButtonAsSkipTokenValue:n,showECCloseButtonCountDownTokenValue:i,isSecondEndcard:r}){this.getDelay=()=>{let e=0;return this.isSecondEndcard&&this.staticEcCloseButtonDelaySecondsTokenValue?e=Number(this.staticEcCloseButtonDelaySecondsTokenValue):this.ecCloseButtonDelaySecondsTokenValue&&(e=Number(this.ecCloseButtonDelaySecondsTokenValue)),e},this.getStyle=()=>this.isSecondEndcard?nQ.CLOSE:oF(this.endcardCloseButtonAsSkipTokenValue)?nQ.SKIP:nQ.CLOSE,this.getCountDown=()=>!this.showECCloseButtonCountDownTokenValue||oF(this.showECCloseButtonCountDownTokenValue),this.ecCloseButtonDelaySecondsTokenValue=e,this.staticEcCloseButtonDelaySecondsTokenValue=t,this.endcardCloseButtonAsSkipTokenValue=n,this.showECCloseButtonCountDownTokenValue=i,this.isSecondEndcard=r}},lg=class extends le{getCallToActionConfig(){return{url:super.getCtaButtonUrl(),text:super.getCtaButtonText(),appMeta:super.getAppMetaData(),delay:super.getCtaButtonDelay(),target:o3(this.skEcCtaOnlyTokenValue,this.isAAKSupportedRe)}}constructor({skEcCtaOnlyTokenValue:e,isAAKSupportedRe:t,appMetaProviderParams:n}){super(n),this.skEcCtaOnlyTokenValue=e,this.isAAKSupportedRe=t}},lm=class{createInstances(){let e=[],t={EC_HTML:"endcard",ADM_HTML:"endcard",EC_HTML_2:"secondEndcard"};return["EC_HTML","ADM_HTML","EC_HTML_2"].filter(e=>this.tokenService.has(e)).forEach((n,i)=>{var r;let a=`${t[n]}_${i}`,s=new ln(lt(a,this.adData,this.tokenService),this.errorLoggingReportingService),o={id:a,endcardContent:this.htmlDecoderService.decode(null!=(r=this.tokenService.get(n))?r:""),index:i,isAlternative:!1,isFullscreen:this.adData.placement.is.fullscreen,inlineInstallConfig:{url:this.tokenService.get("INLINE_INSTALL_URL")},storeKitOverlayAutoShowConfig:new lh(i,this.isEndcardOnly(),this.adData.advertiser.appStoreId,this.tokenService.get("FULL_CTA_OPTION"),this.tokenService.get("SKOVERLAY_AUTO"),this.tokenService.get("SKOVERLAY_DELAY_SECONDS"),this.tokenService.get("EC_SKOVERLAY_DELAY_SECONDS"),this.tokenService.get("SKOVERLAY_AUTO_CLOSE"),this.tokenService.get("EC_SKOVERLAY_DISABLE_AUTO_MMP")).getStoreKitOverlayAutoShowConfig(),appStoreOnDelayConfig:new lv(i,this.adData.advertiser.appStoreId,this.tokenService.get("APP_STORE_ON_ENDCARD_AUTO_DELAY")).getAppStoreOnDelayConfig(),lastChanceEndcardConfig:s.getLastChanceEndcardConfig(),omsdkConfig:{enabled:oF(this.tokenService.get("OM_ENABLED"))},closeButtonConfigProvider:new lp({ecCloseButtonDelaySecondsTokenValue:this.tokenService.get("EC_CLOSE_BUTTON_DELAY_SECONDS"),staticEcCloseButtonDelaySecondsTokenValue:this.tokenService.get("STATIC_EC_CLOSE_BUTTON_DELAY_SECONDS"),showECCloseButtonCountDownTokenValue:this.tokenService.get("SHOW_EC_CLOSE_BUTTON_COUNTDOWN"),endcardCloseButtonAsSkipTokenValue:this.tokenService.get("ENDCARD_CLOSE_BUTTON_AS_SKIP"),isSecondEndcard:1===i}),trackingEventMapConfig:new la(!1).getTrackingEventMapConfig(),callToActionConfig:new lg({skEcCtaOnlyTokenValue:this.tokenService.get("SK_EC_CTA_ONLY"),isAAKSupportedRe:oF(this.tokenService.get("AAK_SUPPORTED_RE")),appMetaProviderParams:ls(this.tokenService,this.errorLoggingReportingService)}).getCallToActionConfig(),muted:o1(this.tokenService,this.adData),shouldSplitVideoEndcardClick:oF(this.tokenService.get("VIDEO_ENDCARD_CLICK_SPLIT")),incentivizedConfig:new lc({enabled:oF(this.tokenService.get("INCENTIVIZED")),incentivizedCloseButtonDelaySeconds:this.tokenService.get("INCENTIVIZED_CLOSE_BUTTON_DELAY_SECONDS"),isIncentiveTiedToCloseButtonDelay:oF(this.tokenService.get("IS_INCENTIVE_TIED_TO_CLOSE_BUTTON_DELAY"))}).getIncentivizedConfig(),amplifyEndcardEngagementService:this.amplifyEndcardEngagementService,injectedGetScenes:this.injectedGetScenes};e.push(new aQ(o))}),e}isEndcardOnly(){let e=!this.tokenService.has("MAIN_VIDEO")&&!this.tokenService.has("MAIN_STREAM"),t=1===iq.filter(e=>this.tokenService.has(e)).length;return e&&t}constructor(e,t,n,i,r,a){this.tokenService=e,this.errorLoggingReportingService=t,this.htmlDecoderService=n,this.adData=i,this.amplifyEndcardEngagementService=r,this.injectedGetScenes=a}},lf=class extends aQ{getSceneType(){return"image"}getObservabilityData(){return{scene_id:this.getId(),scene_type:this.getSceneType(),scene_index:this.getSceneIndex()}}getFullScreenClickConfig(){return this.fullScreenClickConfig}getCloseButtonConfig(){let e=this.closeButtonConfigProvider.getCloseButtonConfig();return I(g({},e),{style:this.isLastPage()?nQ.CLOSE:e.style})}getCallToActionConfig(){return this.callToActionConfig}getEventStreams(){return this.eventStreams?this.eventStreams:((e,t=!1,n=t0(),i=H.get())=>{let r=n7(n,"resource","image").pipe(n5()).pipe(n8(n4(n,"sceneEnd"))),a=I(g({},ik(n,t)),{error_count:r});return e.enabled&&(a.has_reward_been_granted=ij("image",e,n,i)),a})(this.incentivizedConfig,this.lastChanceEndcardConfig.enabled)}constructor({id:e,url:t,index:n,inlineInstallConfig:i,isFullscreen:r,fullScreenClickConfig:a,storeKitOverlayAutoShowConfig:s,appStoreOnDelayConfig:o,lastChanceEndcardConfig:l,closeButtonConfigProvider:c,trackingEventMapConfig:d,callToActionConfig:u,shouldSplitVideoEndcardClick:h=!1,eventStreams:v,incentivizedConfig:p,amplifyEndcardEngagementService:g=rW.getIfExists()}){super({id:e,endcardContent:t,index:n,inlineInstallConfig:i,isFullscreen:r,isAlternative:!1,storeKitOverlayAutoShowConfig:s,appStoreOnDelayConfig:o,lastChanceEndcardConfig:l,trackingEventMapConfig:d,callToActionConfig:u,closeButtonConfigProvider:c,shouldSplitVideoEndcardClick:h,eventStreams:v,incentivizedConfig:p,amplifyEndcardEngagementService:g}),this.url=t,this.index=n,this.fullScreenClickConfig=a,this.storeKitOverlayAutoShowConfig=s,this.appStoreOnDelayConfig=o,this.lastChanceEndcardConfig=l,this.trackingEventMapConfig=d,this.callToActionConfig=u,this.closeButtonConfigProvider=c,this.eventStreams=v}},lS=class extends o4{getFullScreenClickConfig(){var e;return{enabled:void 0!==this.ecImageTokenValue||super.getFullScreenClickConfig().enabled,ctaUrl:null!=(e=this.ecCtaUrlTokenValue)?e:"",id:this.id,styleData:super.getFullScreenClickConfig().styleData,target:super.getFullScreenClickConfig().target}}constructor({id:e,ecImageTokenValue:t,ecCtaUrlTokenValue:n,errorLoggingReportingService:i,fullCtaTokenValue:r,partialFscTokenValue:a,placementType:s,skFullCtaTokenValue:o}){super({errorLoggingReportingService:i,fullCtaTokenValue:r,id:e,partialFscTokenValue:a,placementType:s,skFullCtaTokenValue:o}),this.ecImageTokenValue=t,this.ecCtaUrlTokenValue=n}},ly=class{createInstances(){let e=[],t=this.tokenService.has("EC_HTML");return["EC_IMAGE","EC_IMAGE_2"].filter(e=>this.tokenService.has(e)).forEach((n,i)=>{var r;let a=`image_${i}`,s=t?i+1:i,o=new ln(lt(a,this.adData,this.tokenService),this.errorLoggingReportingService),l={id:a,url:null!=(r=this.tokenService.get(n))?r:"",index:s,isFullscreen:this.adData.placement.is.fullscreen,fullScreenClickConfig:new lS({id:a,ecImageTokenValue:this.tokenService.get("EC_IMAGE"),ecCtaUrlTokenValue:this.tokenService.get("EC_CTA_URL"),fullCtaTokenValue:this.tokenService.get("FULL_CTA"),partialFscTokenValue:this.tokenService.get("PARTIAL_FSC"),skFullCtaTokenValue:this.tokenService.get("SK_FSC"),placementType:this.adData.placement.type,errorLoggingReportingService:this.errorLoggingReportingService}).getFullScreenClickConfig(),inlineInstallConfig:{url:this.tokenService.get("INLINE_INSTALL_URL")},storeKitOverlayAutoShowConfig:new lh(s,this.isEndcardOnly(),this.adData.advertiser.appStoreId,this.tokenService.get("FULL_CTA_OPTION"),this.tokenService.get("SKOVERLAY_AUTO"),this.tokenService.get("SKOVERLAY_DELAY_SECONDS"),this.tokenService.get("EC_SKOVERLAY_DELAY_SECONDS"),this.tokenService.get("SKOVERLAY_AUTO_CLOSE"),this.tokenService.get("EC_SKOVERLAY_DISABLE_AUTO_MMP")).getStoreKitOverlayAutoShowConfig(),appStoreOnDelayConfig:new lv(s,this.adData.advertiser.appStoreId,this.tokenService.get("APP_STORE_ON_ENDCARD_AUTO_DELAY")).getAppStoreOnDelayConfig(),lastChanceEndcardConfig:o.getLastChanceEndcardConfig(),trackingEventMapConfig:new la(!1).getTrackingEventMapConfig(),closeButtonConfigProvider:new lp({ecCloseButtonDelaySecondsTokenValue:this.tokenService.get("EC_CLOSE_BUTTON_DELAY_SECONDS"),staticEcCloseButtonDelaySecondsTokenValue:this.tokenService.get("STATIC_EC_CLOSE_BUTTON_DELAY_SECONDS"),showECCloseButtonCountDownTokenValue:this.tokenService.get("SHOW_EC_CLOSE_BUTTON_COUNTDOWN"),endcardCloseButtonAsSkipTokenValue:this.tokenService.get("ENDCARD_CLOSE_BUTTON_AS_SKIP"),isSecondEndcard:1===s}),callToActionConfig:new lg({skEcCtaOnlyTokenValue:this.tokenService.get("SK_EC_CTA_ONLY"),isAAKSupportedRe:oF(this.tokenService.get("AAK_SUPPORTED_RE")),appMetaProviderParams:ls(this.tokenService,this.errorLoggingReportingService)}).getCallToActionConfig(),shouldSplitVideoEndcardClick:oF(this.tokenService.get("VIDEO_ENDCARD_CLICK_SPLIT")),incentivizedConfig:new lc({enabled:oF(this.tokenService.get("INCENTIVIZED")),incentivizedCloseButtonDelaySeconds:this.tokenService.get("INCENTIVIZED_CLOSE_BUTTON_DELAY_SECONDS"),isIncentiveTiedToCloseButtonDelay:oF(this.tokenService.get("IS_INCENTIVE_TIED_TO_CLOSE_BUTTON_DELAY"))}).getIncentivizedConfig(),amplifyEndcardEngagementService:this.amplifyEndcardEngagementService};e.push(new lf(l))}),e}isEndcardOnly(){return!(this.tokenService.has("MAIN_VIDEO")||this.tokenService.has("MAIN_STREAM"))}constructor(e,t,n,i){this.tokenService=e,this.errorLoggingReportingService=t,this.adData=n,this.amplifyEndcardEngagementService=i}},lC=class{createInstances(){return this.adData.placement.is.banner||this.adData.placement.is.mrec||this.adData.placement.is.inLine?[]:[new az]}constructor(e){this.adData=e}},lE=class{addTransformer(e){return this.transformers.push(e),this}build(){let e=[];for(let t of Object.values(this.sceneFactories))e.push(...t.createInstances());for(let t of this.transformers)t.transform(e);return e}constructor(e){this.transformers=[],this.tokenService=h.get(),this.sceneFactories=null!=e?e:((e,t=t8(),n=nS.get(),i=eo.getValue(),r=rW.getIfExists(),a=i$)=>({video:new lu(e,t,i),endcard:new lm(e,t,n,i,r,a),image:new ly(e,t,i,r),closed:new lC(i)}))(this.tokenService)}},l_=class{transform(e){return e.length&&this.insertionHelper(e[0],this.index),e}insertionHelper(e,t){var n;if(0===t)return;let i=null==(n=e.getTransitions())?void 0:n.find(e=>"NEXT"===e.name&&e.scene),r=null==i?void 0:i.scene;if(i&&r){if(this.ineligibleSceneTypes.includes(e.getSceneType()))return void this.insertionHelper(r,t);if(1===t){i.actions.some(e=>"showProductView"===e.name)||i.actions.push({name:"showProductView"});return}this.insertionHelper(r,t-1)}}constructor(e){this.index=e,this.ineligibleSceneTypes=["gdpr"]}},lb=class{transform(e){return this.addCloseAdAction(e,0),e}addCloseAdAction(e,t){var n;if(void 0===e[t+1])return;let i=null==(n=e[t].getTransitions())?void 0:n.filter(e=>{var t;let n=(null==(t=e.scene)?void 0:t.getSceneType())==="closed",i=e.actions.find(e=>"showProductView"===e.name);return n&&i});if(0!==i.length)for(let e of i){e.actions.push({name:"endAdOnProductViewClose"});let t=e.scene,n=t.getEntryActions().findIndex(e=>"closeAd"===e.name);-1!==n&&t.getEntryActions().splice(n,1)}this.addCloseAdAction(e,t+1)}},lw=class{transform(e){if(0===e.length)return[];if(1===e.length)return e[0].prev=void 0,e[0].next=void 0,e;for(let t=0;t<e.length;t+=1)e[t].prev=0===t?void 0:e[t-1],e[t].next=t===e.length-1?void 0:e[t+1];return e}},lT=class{transform(e){for(let t of e.filter(e=>{var t;return(null==(t=e.next)?void 0:t.getSceneType())==="closed"}))nj(t)&&this.processLastChanceEndcardScene(t);return e}processLastChanceEndcardScene(e){this.enableLastChanceEndcard(e),this.addLastChanceEndcardTransition(e),e.addExitAction({name:"closeLastChanceEndcard"});let t=e.getTransitions().find(e=>"NEXT"===e.name);t&&(this.updateNextTransition(e,t),this.handleProductViewAction(e,t),this.handlePictureInPictureAction(e,t))}enableLastChanceEndcard(e){e.setLastChanceEndcardConfig(I(g({},e.getLastChanceEndcardConfig()),{enabled:!0}))}addLastChanceEndcardTransition(e){e.addTransition({name:"LAST_CHANCE_ENDCARD",actions:[{name:"closeOverlayView"},{name:"showLastChanceEndcard"},{name:"closeVideoCurrentScene"},{name:"setTheatreModeInactive"},{name:"disableTheatreMode"}]})}updateNextTransition(e,t){var n;e.addOrUpdateTransition({name:"NEXT",actions:[...null!=(n=null==t?void 0:t.actions)?n:[]],scene:null==t?void 0:t.scene})}handleProductViewAction(e,t){let n=null==t?void 0:t.actions.find(e=>"showProductView"===e.name);n&&(e.addOrUpdateTransition({name:"LAST_CHANCE_ENDCARD",actions:[n]}),t.actions=t.actions.filter(e=>"showProductView"!==e.name))}handlePictureInPictureAction(e,t){if(!t.actions.some(e=>"showPictureInPicture"===e.name))return;let n=e.getTransitions().find(e=>"LAST_CHANCE_ENDCARD"===e.name);n&&(this.addPictureInPictureToLastChance(e,n),this.removePictureInPictureFromNext(t))}addPictureInPictureToLastChance(e,t){e.addOrUpdateTransition({name:"LAST_CHANCE_ENDCARD",actions:[{name:"showPictureInPicture"},{name:"setPictureInPictureVideoContext"}]}),t.actions=t.actions.filter(e=>"closeVideoCurrentScene"!==e.name)}removePictureInPictureFromNext(e){let t=new Set(["showPictureInPicture","setPictureInPictureVideoContext"]);e.actions=e.actions.filter(e=>!t.has(e.name))}},lA=class{transform(e){let t=e[0];if(!t||!iQ(t))return e;let n=t.getTransitions().find(e=>"NEXT"===e.name);return n&&(n.actions=n.actions.filter(e=>"closeVideo"!==e.name),n.actions.push({name:"showPictureInPicture"},{name:"setPictureInPictureVideoContext"}),t.isPictureInPictureEnabled=!0),e}},lI=class{transform(e){for(let t of e){if(!aZ(t))continue;let e=t.getTransitions(),n=e.find(e=>"NEXT"===e.name);if(n){let i=n.actions,r=e.find(e=>"LAST_CHANCE_ENDCARD"===e.name),a={name:"IMAGE_FAILURE",scene:r?void 0:n.scene,actions:r?[...r.actions]:[...i]};a.actions.some(e=>"showProductView"===e.name)||a.actions.push({name:"showProductView"}),t.addTransition(a)}}return e}},lk=class{transform(e){let t=this.adContext.getValue();if(t.gdpr.requiresConsent&&!t.placement.is.banner&&e.length>0){let t=e.find(e=>!e.prev);null==t||t.addEntryAction({name:"showGdpr"})}return e}constructor(e=eo){this.adContext=e}},lO=()=>{let e=new lE;e.addTransformer(new o_),e.addTransformer(new lw),e.addTransformer(new lk),((e=t3(rL),t=eo.getValue())=>!!e&&t.publisher.supports.appStoreOnFirstTransition)()&&e.addTransformer(new l_(1)),((e=t3(rL),t=eo.getValue())=>!!e&&t.publisher.supports.appStoreOnSecondTransition)()&&e.addTransformer(new l_(2)),((e=h.get())=>oF(e.get("PICTURE_IN_PICTURE")))()&&e.addTransformer(new lA),((e=h.get())=>oF(e.get("VX_ENDCARD")))()&&e.addTransformer(new lT),e.addTransformer(new oE),e.addTransformer(new ob);let t=e.build();return t=new lI().transform(t),t=new lb().transform(t),c.getInstance().bind(iz,t),t},lD=e=>{let t={enabled:!1,isAutoClose:!1};if(!e)return t;let{overlay:n}=e,i=(null==n?void 0:n.autoShowDelay)?1e3*n.autoShowDelay:0,r=!!((null==n?void 0:n.autoCloseDelay)&&n.autoCloseDelay>0),a=(null==n?void 0:n.autoCloseDelay)?1e3*n.autoCloseDelay:0;return g(I(g({},t),{autoShowDelay:i,isAutoClose:r}),r&&{autoCloseDelay:a})},lV=(e,t=h.get())=>void 0===e?"":"string"==typeof e?e:t.get(e.token),lL=(e,t=h.get())=>{let n=lV(null==e?void 0:e.icon,t),i=null==e||null==(r=e.screenshots)?void 0:r.map(e=>lV(e,t)).filter(e=>void 0!==e);var r,a={enabled:!!((null==e?void 0:e.name)&&n),downloads:null==e?void 0:e.downloads,icon:n,name:null==e?void 0:e.name,price:null==e?void 0:e.price,ratingCount:null==e?void 0:e.rating,screenshots:i};for(let e of Object.keys(a)){let t=a[e];(void 0===t||""===t||Array.isArray(t)&&0===t.length)&&delete a[e]}return a},lN=(e,t,n,i=h.get())=>{var r,a,s,o,l,c,d,u,v,p,m,f,S,y,C,E,_,b;let w=!1,T={id:e,enabled:!1};if(!t||0===Object.keys(t).length)return T;let A=null!=(u=null==t?void 0:t.fsc)&&u,k=null!=(v=null==t||null==(r=t.cta)?void 0:r.text)?v:"Open";Object.keys(null!=(p=null==n?void 0:n.on)?p:{}).includes("LAST_CHANCE_ENDCARD")&&(w=!0);let O=lL(t.appMeta,i),D=I(g({},O),{enabled:!!(O.name&&O.icon)}),V=4e3;return(null==t||null==(a=t.cta)?void 0:a.delay)&&(V=1e3*t.cta.delay),I(g({},T),{enabled:w,fsc:{enabled:A,ctaUrl:null!=(m=null==t||null==(s=t.cta)?void 0:s.url)?m:"",target:null==t||null==(o=t.storeKit)?void 0:o.fscTarget},appMeta:D,close:{delay:null!=(E=null==(y=null==t?void 0:t.close)||null==(C=y.delay)?void 0:C.value)?E:0,countdown:null==(_=null==y?void 0:y.countdown)||_,style:null!=(b=null==y?void 0:y.style)?b:nQ.CLOSE},cta:{text:k,url:null!=(f=null==t||null==(l=t.cta)?void 0:l.url)?f:"",isPersistent:null!=(S=null==t||null==(c=t.cta)?void 0:c.isPersistent)&&S,delay:V,appMeta:D,target:null==t||null==(d=t.storeKit)?void 0:d.ctaTarget}})},lx=(e,t,n=h.get())=>{var i,r;return{url:null==e?void 0:e.url,text:null==e?void 0:e.text,isPersistent:null==e?void 0:e.isPersistent,delay:null!=(i=null==e?void 0:e.delay)?i:0,background:null==e?void 0:e.background,appMeta:(null==e?void 0:e.appMeta)?lL(e.appMeta,n):void 0,target:null!=(r=null==t?void 0:t.ctaTarget)?r:nE.PV,position:null==e?void 0:e.position}},lP=e=>{let t=null==e?void 0:e.events;return t?{enabled:!0,events:t}:{enabled:!1}},lR=(e,t=!0,n=!1)=>({enabled:oF(e.get("INCENTIVIZED")),incentivizedCloseButtonDelaySeconds:e.get("INCENTIVIZED_CLOSE_BUTTON_DELAY_SECONDS"),isIncentiveTiedToCloseButtonDelay:oF(e.get("IS_INCENTIVE_TIED_TO_CLOSE_BUTTON_DELAY")),shouldNotifySuccessfulViewAd:t,fireOnlyOnce:!n}),lM=class{get cachedConfig(){return this.closeButtonService.cachedConfig}getDefaultConfig(){return{delay:0,style:nQ.CLOSE,countdown:!0}}updateTotalDelay(e){void 0!==this.closeButtonService.totalDelaySeconds&&(this.closeButtonService.totalDelaySeconds=Math.max(0,this.closeButtonService.totalDelaySeconds-e))}calculateActualDelay(e,t){return e&&t?"%"===e.unit?Math.floor(t*e.value/100):Math.min(e.value,t):0}constructor(e,t,n,i=rd.get()){this.id=e,this.config=t,this.closeButtonService=i,void 0===this.closeButtonService.totalDelaySeconds&&void 0!==n&&(this.closeButtonService.totalDelaySeconds=n)}},lB=class extends lM{getCloseButtonConfig(e){if(this.cachedConfig.has(this.id))return this.cachedConfig.get(this.id);let t=this.config;if(!t)return this.getDefaultConfig();let n=this.calculateActualDelay(t.delay,this.closeButtonService.totalDelaySeconds);(null==e?void 0:e.videoDuration)&&e.videoDuration<n&&(n=Math.floor(e.videoDuration));let i={delay:n,style:t.style,countdown:t.countdown};return this.cachedConfig.set(this.id,i),this.updateTotalDelay(n),i}},lF=(e,t)=>{var n;return{manifest:null==e?void 0:e.manifest,tracks:null==e?void 0:e.tracks,chunks:null==e||null==(n=e.chunks)?void 0:n.map(e=>lV(e,t)).filter(e=>""!==e),chunk_init:lV(null==e?void 0:e.chunk_init,t)}},lU=class extends lM{getCloseButtonConfig(e){var t,n,i;return{delay:this.calculateActualDelay(null==(t=this.config)?void 0:t.delay,null==e?void 0:e.videoDuration),style:null==(n=this.config)?void 0:n.style,countdown:null==(i=this.config)?void 0:i.countdown}}},lH=class extends lM{getCloseButtonConfig(){if(this.cachedConfig.has(this.id))return this.cachedConfig.get(this.id);let e=this.config;if(!e)return this.getDefaultConfig();let t=this.calculateActualDelay(e.delay,this.closeButtonService.totalDelaySeconds),n={delay:t,style:e.style,countdown:e.countdown};return this.cachedConfig.set(this.id,n),this.updateTotalDelay(t),n}},lW=class extends lM{getCloseButtonConfig(e){if(this.cachedConfig.has(this.id)){let t=this.cachedConfig.get(this.id);return void 0!==e&&(t.delay=e),t}let t=this.config;if(!t)return this.getDefaultConfig();let n=this.calculateActualDelay(t.delay,this.closeButtonService.totalDelaySeconds),i={delay:n,style:t.style,countdown:t.countdown};return this.cachedConfig.set(this.id,i),this.updateTotalDelay(n),i}};let lG={composite:(e,t,n,i,r=h.get(),a=nS.get(),s=rd.get(),o=eo.getValue())=>new i5({id:e.id,html:e.html,children:e.children,closeButtonConfigProvider:new lH(e.id,e.close,null==n?void 0:n.globalTimer,s),lastChanceEndcardConfig:lN(e.id,e.lastChanceEndcard,i,r),htmlDecoderService:a,adData:o}),endcard:(e,t,n,i,r=h.get(),a=nS.get(),s=rd.get(),o=eo.getValue())=>{var l;return new aQ({id:e.id,endcardContent:a.decode(e.html),index:t,inlineInstallConfig:{url:null==(l=e.inlineInstall)?void 0:l.url},isFullscreen:o.placement.is.fullscreen,isAlternative:!1,storeKitOverlayAutoShowConfig:lD(e.storeKit),appStoreOnDelayConfig:{enabled:!1,autoShowDelay:0},lastChanceEndcardConfig:lN(e.id,e.lastChanceEndcard,i,r),trackingEventMapConfig:lP(e),callToActionConfig:lx(e.cta,e.storeKit,r),closeButtonConfigProvider:new lH(e.id,e.close,null==n?void 0:n.globalTimer,s),incentivizedConfig:lR(r)})},image:(e,t,n,i,r=h.get(),a=rd.get(),s=eo.getValue())=>{var o,l,c;return new lf({id:e.id,url:lV(e.url,r),index:t,inlineInstallConfig:{url:null==(o=e.inlineInstall)?void 0:o.url},isFullscreen:s.placement.is.fullscreen,fullScreenClickConfig:{enabled:e.fsc,ctaUrl:null==(l=e.cta)?void 0:l.url,target:null==(c=e.storeKit)?void 0:c.fscTarget,styleData:e.cta.partial_fsc},storeKitOverlayAutoShowConfig:lD(e.storeKit),appStoreOnDelayConfig:{enabled:!1,autoShowDelay:0},lastChanceEndcardConfig:lN(e.id,e.lastChanceEndcard,i,r),trackingEventMapConfig:lP(e),closeButtonConfigProvider:new lH(e.id,e.close,null==n?void 0:n.globalTimer,a),callToActionConfig:lx(e.cta,e.storeKit,r),incentivizedConfig:lR(r)})},video:(e,t,n,i,r=h.get(),a=rd.get(),s=eo.getValue())=>{var o,l,c,d,u,v,p,m,f,S,y;let C,E=lV(e.url,r).endsWith(".m3u8")?"hls":"mp4",_={enabled:e.fsc,target:null==(o=e.storeKit)?void 0:o.fscTarget,ctaUrl:null==(l=e.cta)?void 0:l.url,styleData:e.cta.partial_fsc},b=lF(e.streamManifest,r),w=lF(I(g({},e.audioManifest),{tracks:null!=(p=null==(c=e.audioManifest)?void 0:c.tracks)?p:{},manifest:null==(d=e.streamManifest)?void 0:d.manifest}),r),T=(null==n?void 0:n.globalTimer)===void 0?new lU(e.id,e.close,void 0,a):new lB(e.id,e.close,n.globalTimer,a);return new iX({id:e.id,url:lV(e.url,r),isAlternative:!1,showDownloadButton:null!=(m=e.cta.showDownloadButton)&&m,theatreModeEnabled:!1,index:t,videoType:E,inlineInstallConfig:{url:null==(u=e.inlineInstall)?void 0:u.url},streamManifest:b,audioManifest:w,progressBarConfig:{show:C=null!=(y=null==e||null==(f=e.progressBar)?void 0:f.show)&&y,color:C&&(null==(S=e.progressBar)?void 0:S.color)?e.progressBar.color:iu},fullScreenClickConfig:_,storeKitOverlayAutoShowConfig:lD(e.storeKit),appStoreOnDelayConfig:{enabled:!1,autoShowDelay:0},callToActionConfig:lx(e.cta,e.storeKit,r),lastChanceEndcardConfig:lN(e.id,e.lastChanceEndcard,i,r),closeButtonConfigProvider:T,originalVideoUrl:(e=>{if("string"==typeof e)return;let{originalUrl:t}=e;return t&&""!==t.trim()?t:void 0})(e.url),loopVideo:+!!e.looping,muted:e.muted,trackingEventMapConfig:lP(e),isFullscreen:s.placement.is.fullscreen,incentivizedConfig:lR(r,e.rewardGranted,s.advertiser.creative.is.adPodding),privacyUrl:e.privacyUrl,omsdkConfig:e.omsdk,progressEvents:(e=>{if(e)return o2(Object.keys(e).filter(e=>e.startsWith("progress.")).join(";"),!1)})(e.events),shouldFireTpat:e.shouldFireTPAT,appStoreId:null==(v=e.storeKit)?void 0:v.appStoreId})},modular:(e,t,n,i,r=h.get(),a=rd.get(),s=eo.getValue())=>new sv({id:e.id,children:e.children,isFullscreen:s.placement.is.fullscreen,closeButtonConfigProvider:new lW(e.id,e.close,null==n?void 0:n.globalTimer,a),lastChanceEndcardConfig:lN(e.id,e.lastChanceEndcard,i,r)})};var lK=class{buildSceneInfoMap(e,t){let n=new Map;for(let t of e)n.has(t.type)||n.set(t.type,[]),n.get(t.type).push(t);for(let[e,i]of n)this.convertMetaToScenes(e,i,t)}convertMetaToScenes(e,t,n){let i=this.converters[e];if(i)for(let e=0;e<t.length;e++){let r=t[e],a=i(r,e,null==n?void 0:n.context,n.states[r.id]);this.scenes.push(a),this.scenesMap.set(r.id,a)}}addClosedScene(){let e=new az;this.scenesMap.set(e.getId(),e),this.scenes.push(e)}buildTransitions(e){for(let t of this.scenes){let n=e.states[t.getId()];if(null==n?void 0:n.on)for(let e of Object.keys(n.on))this.addTransitionToScene(t,e,n.on[e])}}addTransitionToScene(e,t,n){let i={name:t,actions:n.actions?n.actions.map(e=>({name:e})):[],scene:n.target?this.scenesMap.get(n.target):void 0};e.addOrUpdateTransition(i)}addTransformer(e){return this.transformers.push(e),this}build(){for(let e of this.transformers)this.scenes=e.transform(this.scenes);return this.scenes}constructor(e=new rz,t=lG){this.converters=t,this.transformers=[],this.scenes=[],this.scenesMap=new Map;let n=e.getSceneData(),i=e.getAdMachineConfig();this.buildSceneInfoMap(n,i),this.addClosedScene(),this.buildTransitions(i)}},lj=class{transform(e){for(let i of e.filter(e=>!!nj(e)&&e.getLastChanceEndcardConfig().enabled)){var t,n;i.addOrUpdateTransition({name:"NEXT",actions:[{name:"closeLastChanceEndcard"}]});let e=[{name:"closeOverlayView"},{name:"setTheatreModeInactive"},{name:"disableTheatreMode"}];(null==(t=i.getTransitions().find(e=>"LAST_CHANCE_ENDCARD"===e.name))?void 0:t.actions.some(e=>"showOverlayView"===e.name))&&e.splice(e.findIndex(e=>"closeOverlayView"===e.name),1);let r=null==(n=i.getTransitions().find(e=>"LAST_CHANCE_ENDCARD"===e.name))?void 0:n.actions.some(e=>"showPictureInPicture"===e.name);"video"===i.getSceneType()&&(r?e.push({name:"setPictureInPictureVideoContext"}):e.push({name:"closeVideoCurrentScene"})),i.addOrUpdateTransition({name:"LAST_CHANCE_ENDCARD",actions:e})}return e}},lY=class{transform(e){var t;let n=(null==(t=e[0])?void 0:t.getSceneType())==="video"?e[0]:null,i=null==n?void 0:n.getTransitions().find(e=>"NEXT"===e.name);return(null==i?void 0:i.actions.some(e=>"showPictureInPicture"===e.name))&&(i.actions=i.actions.filter(e=>"closeVideo"!==e.name).concat({name:"setPictureInPictureVideoContext"})),e}},lq=function(e){return(e instanceof i5||e instanceof sv)&&Array.isArray(e.children)},lz=class{transform(e,t=new rz){let n=t.getSceneData(),i=[];return this.processParentScenes(e,n,i),this.processRemainingScenes(e,i),i}processParentScenes(e,t,n){for(let i of e){if(!lq(i))continue;let r=t.find(e=>e.id===i.getId());if(!r)continue;let a=r.children,s=this.findChildScenes(e,a);i.addChildScenes(s),n.push(i)}}findChildScenes(e,t){let n=[];for(let i of t){let t=e.find(e=>e.getId()===i);t&&(t.child=!0,n.push(t))}return n}processRemainingScenes(e,t){for(let n of e)!lq(n)&&(this.isChildOfExistingScene(n,t)||t.push(n))}isChildOfExistingScene(e,t){return t.some(t=>!!lq(t)&&t.getChildScenes().includes(e))}},l$=class{transform(e,t=eo.getValue()){var n;if(!t.advertiser.creative.is.adPodding)return e;for(let t of e)iQ(t)&&(null==(n=t.next)?void 0:n.getSceneType())==="closed"&&0===t.loopVideo&&(t.loopVideo=2);return e}};let lX=[new oS,new lk,new lj,new lY,new l$,new oE,new ob,new oy,new lz];var lQ=(e=new rz,t=lX)=>{let n=new lK(e);for(let e of t)n.addTransformer(e);let i=n.build();return c.getInstance().bind(iz,i),i},lZ=class extends d{close(){this.interpreter.send({type:"CLOSE"})}fallback(){"off"!==this.interpreter.state.context.fallback&&(this.interpreter.send({type:"SET_FALLBACK"}),this.open())}finish(){this.interpreter.send({type:"FINISH"})}getState(){return this.interpreter.state}init(){}interrupt(){this.interpreter.send({type:"INTERRUPT"})}isIdle(){var e;return null!=(e=this.interpreter.state.matches("IDLE"))&&e}isInterrupted(){return["CLOSING","INTERRUPTED"].some(e=>this.interpreter.state.matches(e))}isOpen(){return["SHOWING","VISIBLE"].some(e=>this.interpreter.state.matches(e))}open(e){return!!["IDLE","FALLBACK"].some(e=>this.interpreter.state.matches(e))&&(this.interpreter.send({type:"OPEN",fallback:null==e?void 0:e.fallback}),!0)}resume(){this.interpreter.send({type:"RESUME"})}setDisplayOptions(e){this.interpreter.send({type:"SET_DISPLAY_OPTIONS",displayOptions:e})}setVisible(){this.interpreter.send({type:"SET_VISIBLE"})}setError(){}setPrepared(){}subscribe(e){return this.interpreter.subscribe(e)}constructor(e,t={},n=j.get()){super(),this.machineConfig=e,this.machineOptions=t,this.stateMachineService=n;let i=this.stateMachineService.createMachine(this.machineConfig,this.machineOptions);this.interpreter=this.stateMachineService.interpret(i),this.interpreter.start()}},lJ=(e=h.get())=>{var t,n;return{position:"bottom-raised"===e.get("SKOVERLAY_POSITION")?"bottom-raised":"bottom",dismissible:(null==(n=e.get("SKOVERLAY_DISMISSIBLE"))||null==(t=n.trim())?void 0:t.toLowerCase())!=="false"}};let l0=(e,t="appStore")=>({id:"store-kit-overlay",initial:"IDLE",context:{displayOptions:e,fallback:t},states:{IDLE:{on:{OPEN:{target:"SHOWING",actions:["assignFallback","openAppStore"]},SET_DISPLAY_OPTIONS:{actions:"assignDisplayOptions"}}},SHOWING:{on:{SET_VISIBLE:{target:"VISIBLE",actions:"emitVisibleEvent"},INTERRUPT:{target:"CLOSING",actions:"closeAppStore"},CLOSE:{target:"CLOSING",actions:"closeAppStore"},SET_FALLBACK:{target:"FALLBACK"}}},VISIBLE:{on:{CLOSE:{target:"CLOSING",actions:"closeAppStore"},FINISH:{target:"IDLE"},INTERRUPT:{target:"INTERRUPTED",actions:"closeAppStore"}}},INTERRUPTED:{on:{RESUME:{target:"SHOWING",actions:"openAppStore"}}},FALLBACK:{on:{OPEN:{actions:"showFallback"}}},CLOSING:{on:{FINISH:{target:"IDLE"}}},ERROR:{},INITIAL:{},PREPARING:{}}}),l1=(e,t,n)=>({actions:{emitVisibleEvent:()=>{n.emit("skoVisible"),t.emit("store-kit-overlay")},openAppStore:t=>{e.openAppStore(1,t.displayOptions)},closeAppStore:()=>{e.dismissStoreOverlayView()},assignFallback:K((e,t)=>{var n;return I(g({},e),{fallback:null!=(n=t.fallback)?n:e.fallback})}),assignDisplayOptions:K((e,t)=>{var n;return I(g({},e),{displayOptions:null!=(n=t.displayOptions)?n:e.displayOptions})}),showFallback:e=>{switch(e.fallback){case"skpv":n.emit("skoFallbackToSkpv");break;case"appStore":n.emit("appStoreFallbackToMraid")}}}}),l2=(e,t="appStore")=>{let n=l0(e,t);return I(g({},n),{initial:"INITIAL",context:{appStoreId:void 0,displayOptions:e,fallback:t},states:I(g({},n.states),{INITIAL:{on:{READY:{target:"PREPARING",actions:["setAppStoreId","prepareOverlay"]}}},PREPARING:{on:{SET_PREPARED:{target:"IDLE"},SET_ERROR:{target:"ERROR",actions:"emitPrepareError"}}},CLOSING:{on:{FINISH:{target:"INITIAL"}}}})})},l3=(e=tG.get(),t=tU(),n=r3())=>({actions:I(g({},l1(e,t,n).actions),{prepareOverlay:t=>{t.appStoreId&&e.prepareStoreOverlayView(t.appStoreId,t.displayOptions)},setAppStoreId:K({appStoreId:(e,t)=>t.appStoreId||e.appStoreId}),emitPrepareError:()=>{t.emit("store-kit-overlay-prepare-error")},openAppStore:t=>{t.appStoreId&&e.presentStoreOverlayView(t.appStoreId,t.displayOptions)},closeAppStore:t=>{t.appStoreId&&e.dismissStoreOverlayView(t.appStoreId)}})});var l6=e=>{let t="appStore";return e&&(t="skpv"),t};class l4 extends lZ{init(e){this.interpreter.send(g({type:"READY"},e))}close(){super.close(),this.interpreter.send({type:"READY"})}finish(){super.finish(),this.interpreter.send({type:"READY"})}setError(){this.interpreter.send({type:"SET_ERROR"})}setPrepared(){this.interpreter.send({type:"SET_PREPARED"})}constructor(e=l2,t=l3,n=j.get(),i=h.get(),r=tG.get(),a=t3(rL)){super(e(lJ(i),l6(a)),t(r),n),this.stateMachineService=n,this.tokenService=i,this.mraidService=r,this.productViewService=a}}l4.identifier=rV;class l7 extends lZ{constructor(e=l0,t=l1,n=j.get(),i=h.get(),r=tG.get(),a=tU(),s=r3()){super(e(lJ(i),l6()),t(r,a,s),n)}}l7.identifier=rV;var l5=class{withAppStoreId(e,t){return t&&e.init({appStoreId:t}),e}resolve(){return this.adData.sdk.is.v71xOrAbove?new l7:this.withAppStoreId(new l4,this.adData.advertiser.appStoreId)}constructor(e){this.adData=e}},l8=e=>new Promise((t,n)=>{let i=document.createElement("script");i.src=e,document.head.appendChild(i),i.onload=t,i.onerror=()=>n(Error(`Failed to load script url ${e}`))});let l9=async(e=h.get(),t=eo.getValue(),n=l8,i=ed(),r=ry)=>{if(oF(e.get("OM_ENABLED"))&&t.sdk.supports.omSdk)try{await n("omsdk.js"),await n("omsdk-session.js"),r()}catch(e){i.emit({type:"error-logging",event:"exception",data:{error:{message:"Load OMSDK files failed"}}})}},ce=-1,ct=e=>{addEventListener("pageshow",t=>{t.persisted&&(ce=t.timeStamp,e(t))},!0)},cn=(e,t,n,i)=>{let r,a;return s=>{let o;t.value>=0&&(s||i)&&((a=t.value-(null!=r?r:0))||void 0===r)&&(r=t.value,t.delta=a,o=t.value,t.rating=o>n[1]?"poor":o>n[0]?"needs-improvement":"good",e(t))}},ci=e=>{requestAnimationFrame(()=>requestAnimationFrame(()=>e()))},cr=()=>{let e=performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},ca=()=>{var e;let t=cr();return null!=(e=null==t?void 0:t.activationStart)?e:0},cs=(e,t=-1)=>{let n=cr(),i="navigate";return ce>=0?i="back-forward-cache":n&&(document.prerendering||ca()>0?i="prerender":document.wasDiscarded?i="restore":n.type&&(i=n.type.replace(/_/g,"-"))),{name:e,value:t,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(0x82f79cd8fff*Math.random())+1e12}`,navigationType:i}},co=new WeakMap;function cl(e,t){return co.get(e)||co.set(e,new t),co.get(e)}let cc=(e,t,n={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){let i=new PerformanceObserver(e=>{Promise.resolve().then(()=>{t(e.getEntries())})});return i.observe(g({type:e,buffered:!0},n)),i}}catch(e){}},cd=e=>{let t=!1;return()=>{t||(e(),t=!0)}},cu=-1,ch=new Set,cv=()=>"hidden"!==document.visibilityState||document.prerendering?1/0:0,cp=e=>{if("hidden"===document.visibilityState){if("visibilitychange"===e.type)for(let e of ch)e();isFinite(cu)||(cu="visibilitychange"===e.type?e.timeStamp:0,removeEventListener("prerenderingchange",cp,!0))}},cg=()=>{if(cu<0){var e;let t=ca(),n=document.prerendering||null==(e=globalThis.performance.getEntriesByType("visibility-state").filter(e=>"hidden"===e.name&&e.startTime>t)[0])?void 0:e.startTime;cu=null!=n?n:cv(),addEventListener("visibilitychange",cp,!0),addEventListener("prerenderingchange",cp,!0),ct(()=>{setTimeout(()=>{cu=cv()})})}return{get firstHiddenTime(){return cu},onHidden(e){ch.add(e)}}},cm=e=>{document.prerendering?addEventListener("prerenderingchange",()=>e(),!0):e()},cf=[1800,3e3],cS=(e,t={})=>{cm(()=>{let n=cg(),i,r=cs("FCP"),a=cc("paint",e=>{for(let t of e)"first-contentful-paint"===t.name&&(a.disconnect(),t.startTime<n.firstHiddenTime&&(r.value=Math.max(t.startTime-ca(),0),r.entries.push(t),i(!0)))});a&&(i=cn(e,r,cf,t.reportAllChanges),ct(n=>{i=cn(e,r=cs("FCP"),cf,t.reportAllChanges),ci(()=>{r.value=performance.now()-n.timeStamp,i(!0)})}))})},cy=0,cC=1/0,cE=0,c_=e=>{for(let t of e)t.interactionId&&(cC=Math.min(cC,t.interactionId),cy=(cE=Math.max(cE,t.interactionId))?(cE-cC)/7+1:0)},cb=()=>{var t;return e?cy:null!=(t=performance.interactionCount)?t:0},cw=0;class cT{v(){cw=cb(),this.u.length=0,this.l.clear()}L(){let e=Math.min(this.u.length-1,Math.floor((cb()-cw)/50));return this.u[e]}h(e){var t,n;if(null==(t=this.m)||t.call(this,e),!e.interactionId&&"first-input"!==e.entryType)return;let i=this.u.at(-1),r=this.l.get(e.interactionId);if(r||this.u.length<10||e.duration>i.P){if(r?e.duration>r.P?(r.entries=[e],r.P=e.duration):e.duration===r.P&&e.startTime===r.entries[0].startTime&&r.entries.push(e):(r={id:e.interactionId,entries:[e],P:e.duration},this.l.set(r.id,r),this.u.push(r)),this.u.sort((e,t)=>t.P-e.P),this.u.length>10)for(let e of this.u.splice(10))this.l.delete(e.id);null==(n=this.p)||n.call(this,r)}}constructor(){p(this,"u",[]),p(this,"l",new Map),p(this,"m",void 0),p(this,"p",void 0)}}let cA=e=>{let t=globalThis.requestIdleCallback||setTimeout;"hidden"===document.visibilityState?e():(addEventListener("visibilitychange",e=cd(e),{once:!0,capture:!0}),t(()=>{e(),removeEventListener("visibilitychange",e,{capture:!0})}))},cI=[200,500],ck=(t,n={})=>{if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;let i=cg();cm(()=>{var r;"interactionCount"in performance||e||(e=cc("event",c_,{type:"event",buffered:!0,durationThreshold:0}));let a,s=cs("INP"),o=cl(n,cT),l=e=>{cA(()=>{for(let t of e)o.h(t);let t=o.L();t&&t.P!==s.value&&(s.value=t.P,s.entries=t.entries,a())})},c=cc("event",l,{durationThreshold:null!=(r=n.durationThreshold)?r:40});a=cn(t,s,cI,n.reportAllChanges),c&&(c.observe({type:"first-input",buffered:!0}),i.onHidden(()=>{l(c.takeRecords()),a(!0)}),ct(()=>{o.v(),a=cn(t,s=cs("INP"),cI,n.reportAllChanges)}))})};class cO{h(e){var t;null==(t=this.m)||t.call(this,e)}constructor(){p(this,"m",void 0)}}let cD=[2500,4e3],cV=(e,t={})=>{cm(()=>{let n=cg(),i,r=cs("LCP"),a=cl(t,cO),s=e=>{for(let s of(t.reportAllChanges||(e=e.slice(-1)),e))a.h(s),s.startTime<n.firstHiddenTime&&(r.value=Math.max(s.startTime-ca(),0),r.entries=[s],i())},o=cc("largest-contentful-paint",s);if(o){i=cn(e,r,cD,t.reportAllChanges);let n=cd(()=>{s(o.takeRecords()),o.disconnect(),i(!0)}),a=e=>{e.isTrusted&&(cA(n),removeEventListener(e.type,a,{capture:!0}))};for(let e of["keydown","click","visibilitychange"])addEventListener(e,a,{capture:!0});ct(n=>{i=cn(e,r=cs("LCP"),cD,t.reportAllChanges),ci(()=>{r.value=performance.now()-n.timeStamp,i(!0)})})}})},cL=[800,1800],cN=e=>{document.prerendering?cm(()=>cN(e)):"complete"!==document.readyState?addEventListener("load",()=>cN(e),!0):setTimeout(e)},cx=(e,t={})=>{let n=cs("TTFB"),i=cn(e,n,cL,t.reportAllChanges);cN(()=>{let r=cr();r&&(n.value=Math.max(r.responseStart-ca(),0),n.entries=[r],i(!0),ct(()=>{(i=cn(e,n=cs("TTFB",0),cL,t.reportAllChanges))(!0)}))})};var cP=class extends d{};class cR extends cP{get(e){e.length>0&&(new Image().src=e)}post(e,t){if(!navigator.sendBeacon)return;let n="";(null==t?void 0:t.requestData)&&(n=JSON.stringify(t.requestData)),navigator.sendBeacon(e,n)}}cR.identifier=t4;class cM extends cP{get(e,t){this.pingUrl("Get",e,null==t?void 0:t.retry,void 0,null==t?void 0:t.headers)}post(e,t){this.pingUrl("Post",e,null==t?void 0:t.retry,null==t?void 0:t.requestData,null==t?void 0:t.headers)}pingUrl(e,t,n,i,r){let a=i?JSON.stringify(i):void 0,s=r?JSON.stringify(r):void 0;this.mraidService.pingUrl(e,t,null==n||n,a,s)}constructor(e){super(),this.mraidService=e}}cM.identifier=t4;let cB=(e,t)=>Object.keys(e).reduce((n,i)=>{let r=e[i],a=t[i];return null==a||"object"!=typeof a||Array.isArray(a)?void 0!==a&&(n[i]=a):n[i]=cB(r,a),n},g({},e));var cF=(e,t,n=t5.get(),i=iP(),r=r$,{scene:a}=t2.getValue())=>{var s,o,l,c;let d=()=>r().send({type:"VIDEO_FAILURE"}),u=e=>{iQ(a)&&rF(e,a.getId(),a.getTrackingEventMapConfig())};switch(t.event){case"progress":if((null==(s=t.data)?void 0:s.current_time)!=null&&null!=t.data.duration){let{current_time:n,duration:i}=t.data;if(iM(n,i,Math.round(n)),((e,t,n,i)=>{var r;if(!iQ(i))return;let a=Math.floor(t/n*100),s=Math.floor(t);null==(r=i.getProgressEvents())||r.forEach(t=>{("percentage"===t.type&&a>=t.value||"absolute"===t.type&&t.value<=n&&s>=t.value)&&(t.useTpat?e.emit({type:"tpat",event:t.name,fireOnlyOnce:!0}):rF(t.name,i.getId(),i.getTrackingEventMapConfig(),!0))})})(e,n,i,a),iQ(a)&&i>0){let e=a.getTrackingEventMapConfig(),t=null==(c=e.events)?void 0:c["video.length"];t&&(t[0]=t[0].replace("{{{vlen}}}",Math.floor(1e3*i).toString()),rF("video.length",a.getId(),e,!0))}}break;case"mute":case"unmute":case"close":{let e=`video.${t.event}`;i.emit(e),u(e);break}case"pause":case"play":u("pause"===t.event?"pause":"resume");break;case"error":(null==(o=t.data)?void 0:o.error)&&n.pushError(t.data.error,{resource_url:t.data.video_url,error_source:"resource"});break;case"hlsVideoStalled":n.pushEvent(g({name:"hls-video-stalled",metric:"hls-video-stalled"},t.data)),e.hasExistingEvent({type:"video",event:"hlsFragLoadError"})&&d();break;case"hlsLevelSwitched":n.pushEvent(g({name:"hls-level-switched",metric:"hls-level-switched"},t.data));break;case"hlsFatalError":d();break;case"hlsFragLoadError":(null==(l=t.data)?void 0:l.is_first_segment)&&d()}},cU=e=>!iQ(e)||e.shouldFireTpat,cH=(e,t,n=tG.get(),i=eo.getValue(),{scene:r}=t2.getValue())=>{((e,t)=>{switch(e){case"rewardGranted":return t.sdk.supports.rewardGranted;case"video.length":return t.sdk.supports.videoLength;default:return!0}})(t.event,i)&&cU(r)&&n.notifyTPAT(t.event)},cW=(e,t,n=H.get(),i=tY.get(),r=re,a=tR.get())=>{if(a.isViewable()){var s;null!=(s=r()[0])&&s.state.matches("AUTO_PLAY_FAIL")||(n.wake(),i.startAll())}else n.standby(),i.pauseAll()},cG=(e,t)=>{var n,i,r,a,s,o,l;let c=null!=(i=null==(n=t.data)?void 0:n.mode)?i:0;switch(t.event){case"visible":let d=t3(rV);switch(c){case 0:(null==d?void 0:d.isOpen())&&d.close();break;case 1:null==d||d.setVisible()}break;case"finished":switch(c){case 0:null==(r=t3(rL))||r.close();break;case 1:null==(a=t3(rV))||a.finish()}break;case"failed":switch(c){case 0:null==(s=t3(rL))||s.fallback();break;case 1:null==(o=t3(rV))||o.fallback();break;case 2:null==(l=a3.getIfExists())||l.fallback()}}},cK=(e,t,n=eo.getValue(),i=ne.get())=>{t.data.is_fatal&&(n.sdk.is.below7?rT():i.notifyFatalError(t))},cj=(e,t,n=t3(rL))=>{if(n)switch(t.event){case"skpv6-success":n.setPrepared();break;case"skpv6-finished":n.close()}},cY=(e,t,n=t3(rV))=>{if(n)switch(t.event){case"sko6-success":n.setPrepared();break;case"sko6-finished":n.finish();break;case"sko6-failed":n.getState().matches("PREPARING")?n.setError():n.fallback();break;case"sko6-visible":n.setVisible()}},cq={downloadButtonCta:"download_button_cta",endcardCta:"endcard_cta",lastChanceEndcardCta:"last_chance_endcard_cta",persistentCta:"persistent_cta",fsc:"fsc"},cz=(e,t)=>{var n;let i=t5.get();if("error-logging"===t.type&&(null==(n=t.data)?void 0:n.error)){let n=t.data;if(n.error&&!(e.findAll({where:{type:"error-logging",data:{error:{message:n.error.message},error_source:n.error_source}}}).length>1)){let{error:e}=n,t=function(e,t){if(null==e)return{};var n,i,r,a={};if("u">typeof Reflect&&Reflect.ownKeys){for(r=0,n=Reflect.ownKeys(e);r<n.length;r++)i=n[r],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(a[i]=e[i]);return a}if(a=function(e,t){if(null==e)return{};var n,i,r={},a=Object.getOwnPropertyNames(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n]);return r}(e,t),Object.getOwnPropertySymbols)for(r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)i=n[r],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(a[i]=e[i]);return a}(n,["error"]);i.pushError(e,t)}}else if("cta"===t.type||"fsc"===t.type){let e=t2.getValue().scene,n=null==e?void 0:e.getSceneType(),r={name:"cta",metric:cq[t.event],scene_type:n};"modular"===n&&(r.modular_video_id=t.data.scene_id),i.pushEvent(r)}},c$=(e,t)=>{let n=t5.get();"event"===t.event?n.pushEvent(t.data):"error"===t.event&&t.data.error&&n.pushError(t.data.error)},cX=(e,t,n=tG.get())=>{"decodingError"===t.event&&n.close()},cQ=(e,t,n=tG.get(),i=tU(),r=nN.get(),a=nl.get())=>void nr(()=>a.haveAllCompleted(),nl.MAX_WAIT_TIME+100,Error("error waiting for all event streams to finish")).catch(()=>{}).finally(()=>{i.emit("ad-close","ad-close"),null==r||r.addRecord(),n.close()});let cZ={composite:"composite-scene-end",endcard:"endcard-scene-end",image:"image-scene-end",video:"video-scene-end"};var cJ=(e,t,n=a8,i=nl.get(),r=tU())=>{let a=n(t.data.scene_id);a&&"sceneEnd"===t.event&&i.subscribeAll(a).then(e=>{var n;Object.keys(e).length>0&&r.emit({type:"observability",event:"event",data:g({name:"scene-end",metric:null!=(n=cZ[t.data.scene_type])?n:"scene-end"},a.getObservabilityData(),e)})})},c0=(e,t,n=tG.get(),i=iP(),r=tU(),a=t2)=>{if("grantReward"===t.event){var s;let{scene:e}=a.getValue();cU(e)?i.emit("rewardGranted"):e&&"function"==typeof e.getTrackingEventMapConfig&&rF("rewardGranted",e.getId(),e.getTrackingEventMapConfig(),!0),r.emit("grant-reward","grant-reward"),(null==(s=t.data)?void 0:s.shouldNotifySuccessfulViewAd)!==!1&&n.notifySuccessfulViewAd()}},c1=(e,t,n=a4.get(),i=t3(rV),r=t3(rL))=>{if("aakFallbackToSkpv"!==t.event||(null==r?void 0:r.open(!0))||null==i||i.open({fallback:"appStore"}),"skpvFallbackToSko"===t.event){var a;let t=null!=(a=null==i?void 0:i.getState().matches("FALLBACK"))&&a;if(i&&!t){null==i||i.open({fallback:"appStore"});return}e.emit({type:"app-store-orchestration",event:"appStoreFallbackToMraid"})}"skoFallbackToSkpv"===t.event&&(null==r||r.open()),"appStoreFallbackToMraid"===t.event&&n.invoke({url:void 0,target:nE.OFF,shouldFireMMP:!1})},c2=(e,t,n=tU())=>{if("appStoreClose"===t.event){let t=e.findAllActivityEventPairs("app-store-product-view","appStoreOpen","appStoreClose");if(n.getEventCount("app-store-duration")<t.length){let e={name:"app-store-duration",metric:"app-store-duration",elapsed:Date.now()-t.at(-1)[0].timestamp};n.emit(e)}}},c3=(e,t,n=nI.get(),i=r$)=>{i().state.context.shouldRenderPictureInPicture&&(n.closeVideo(),i().send({type:"CLOSE_PICTURE_IN_PICTURE"}))},c6=(e,t,n=tU())=>{"checkpoint.0"===t.event&&n.emit("impression","impression")},c4=(e,t,n=tU(),i=t2,r=i$)=>{if("inactivity"===t.event){let e=i.getValue().scene,t=r().findIndex(t=>t.getId()===(null==e?void 0:e.getId()));n.emit({name:"inactivity-observed",metric:"inactivity-observed",scene_id:null==e?void 0:e.getId(),scene_type:null==e?void 0:e.getSceneType(),scene_index:t,last_chance_endcard_visible:rr.getValue().isLastChanceEndcardOverlayShowing})}},c7=(e,t,n={})=>{let{injectedAdMachineInterpreter:i=r$,injectedIncentivizedDialogService:r=()=>sh.getIfExists(),injectedSceneEventReportingService:a=ns,injectedCreateIncentivizedSendEvent:s=sF,adData:o=eo.getValue(),sceneContext:l=t2}=n;if("custom-close"!==t.event||i().state.context.isPrivacyDrawerOpen||0===a().getEventCount("closeButtonShow"))return;let c=r();if(null==c?void 0:c.isOpen())return void c.close();let d=l.getValue().scene;if(o.placement.is.rewarded&&iQ(d))return void s(i().send,c,e)({type:"NEXT"});if(oC(d)){if(!rr.getValue().isLastChanceEndcardOverlayShowing)return void i().send({type:"LAST_CHANCE_ENDCARD"});if(2>a().getEventCount("closeButtonShow"))return}i().send({type:"NEXT"})};let c5=async()=>{let e,t,n;((e=h.get(),t=tU(),n=t8(),{gdpr:i,sdk:r}=eo.getValue())=>{let a,s=((e,t,n=t8(),i)=>{var r,a,s,o,l,c,d,u,h,v,p,g,m,f,S,y,C,E,_,b,w,T,A,I,k,O,D,V;let L,N=e.get("USER_AGENT");if(N)try{L=JSON.parse(nm(N))}catch(e){n.emit({type:"error-logging",event:"exception",data:{error:{message:"Failed to parse USER_AGENT token"}}})}let x=null!=(s=e.get("SDK_VERSION"))?s:"0.0.0",P=new Y(x),R=null!=(o=e.get("PLATFORM"))?o:"unknown",M=null!=(l=e.get("OS_VERSION"))?l:"0.0.0",B=new Y(M),F=P.isGreaterThanOrEqualTo(new Y("7.4.0")),U=null!=(c=e.get("PLACEMENT_TYPE"))?c:"unknown",H=oF(e.get("AD_PODDING"));return{advertiser:{appStoreId:e.get("APP_STORE_ID"),creative:{format:null!=(d=e.get("CREATIVE_FORMAT"))?d:"",formatVersion:null!=(u=e.get("CREATIVE_FORMAT_VERSION"))?u:"",id:null!=(h=e.get("CREATIVE_ID"))?h:"",is:{freeForm:e.has("AD_EXPERIENCE"),adPodding:H},type:null!=(v=e.get("CREATIVE_TYPE"))?v:""},domain:null!=(p=e.get("ADVERTISER_DOMAIN"))?p:"",rtb:{id:null!=(g=e.get("RTB_ID"))?g:"",name:"accelerate"===e.get("AD_SOURCE")?"accelerate":"others"},headerBidding:oF(e.get("HEADER_BIDDING")),mediation:null!=(m=e.get("MEDIATION_NAME"))?m:"",disableEndcardCache:oF(e.get("DISABLE_ENDCARD_CACHE"))},device:{ado:oF(e.get("ADO_ENABLED")),countryCode:null!=(f=e.get("COUNTRY_CODE"))?f:"",model:null!=(S=null==L||null==(r=L.device)?void 0:r.model)?S:"",os:{name:R,version:M,is:{iOS:"iOS"===R,android:"android"===R.toLowerCase(),amazon:"amazon"===R.toLowerCase(),unknown:"iOS"!==R&&!["android","amazon"].includes(R.toLowerCase())}},skpv:{hasMaskIssue:"iOS"===R&&B.isGreaterThanOrEqualTo(new Y("17"))&&B.isLessThan(new Y("17.1.1")),hasSwipeIssue:"iOS"===R&&B.isGreaterThanOrEqualTo(new Y("17.2"))&&P.isGreaterThanOrEqualTo(new Y("7.0.0"))&&P.isLessThanOrEqualTo(new Y("7.2.0"))},type:null!=(y=null==L||null==(a=L.device)?void 0:a.type)?y:""},gdpr:t,incentivized:{body:null!=(C=e.get("INCENTIVIZED_BODY_TEXT"))?C:"Are you sure you want to skip this ad? Finish watching to claim your reward.",close:null!=(E=e.get("INCENTIVIZED_CLOSE_TEXT"))?E:"Close Ad",continue:null!=(_=e.get("INCENTIVIZED_CONTINUE_TEXT"))?_:"Continue",title:null!=(b=e.get("INCENTIVIZED_TITLE_TEXT"))?b:"Close this ad?"},placement:{type:U,id:null!=(w=e.get("PLACEMENT_ID"))?w:"",referenceId:null!=(T=e.get("PLACEMENT_REFERENCE_ID"))?T:"",is:{banner:"banner"===U,fullscreen:"fullscreen"===U,inLine:"in_line"===U,mrec:"mrec"===U,rewarded:oF(e.get("INCENTIVIZED"))}},platform:{accTests:e.has("ACC_TESTS")?nm(null!=(A=e.get("ACC_TESTS"))?A:""):void 0,nautilusVersion:null!=(I=e.get("NAUTILUS_VERSION"))?I:"0.0.0",observability:oF(e.get("OBSERVABILITY")),observedExperiments:null!=(k=e.get("OBSERVED_EXPERIMENTS"))?k:"",sessionId:null!=(O=e.get("SESSION_ID"))?O:"",privacyUrl:null!=(D=e.get("VUNGLE_PRIVACY_URL"))?D:""},publisher:{id:null!=(V=e.get("PUB_ID"))?V:"",supports:{appStoreOnFirstTransition:oF(e.get("APP_STORE_ON_FIRST_TRANSITION")),appStoreOnSecondTransition:oF(e.get("APP_STORE_ON_SECOND_TRANSITION"))}},sdk:{timeLoaded:i,loadTimeout:e.has("LOAD_TIMEOUT")?Number(e.get("LOAD_TIMEOUT")):-1,version:x,is:{v70x:P.isGreaterThanOrEqualTo(new Y("7.0.0"))&&P.isLessThan(new Y("7.1.0")),v740:P.isEqualTo(new Y("7.4.0")),v71xOrAbove:P.isGreaterThanOrEqualTo(new Y("7.1")),v741OrAbove:P.isGreaterThanOrEqualTo(new Y("7.4.1")),v744OrAbove:P.isGreaterThanOrEqualTo(new Y("7.4.4")),v760OrAbove:P.isGreaterThanOrEqualTo(new Y("7.6.0")),v763OrAbove:P.isGreaterThanOrEqualTo(new Y("7.6.3")),below721:P.isLessThan(new Y("7.2.1")),below71x:P.isLessThan(new Y("7.1.0")),below7:P.isLessThan(new Y("7"))},supports:{hlsCustomPlayer:"iOS"!==R||P.isGreaterThanOrEqualTo(new Y("7")),omSdk:P.isGreaterThanOrEqualTo(new Y("6.9.1")),openPrivacy:"android"===R||"iOS"===R&&P.isGreaterThanOrEqualTo(new Y("7.1.0")),orientationProperties:"fullscreen"===U&&("iOS"===R||P.isGreaterThanOrEqualTo(new Y("6.12.1"))),pingUrl:"iOS"===R&&P.isGreaterThanOrEqualTo(new Y("7.4.4"))||"android"===R&&P.isGreaterThanOrEqualTo(new Y("7.4.3")),rewardGranted:"iOS"===R||P.isGreaterThanOrEqualTo(new Y("6.12.0")),silent:F,sko:"iOS"===R&&B.isGreaterThanOrEqualTo(new Y("14"))&&P.isGreaterThanOrEqualTo(new Y("6.8.1"))&&!P.isEqualTo(new Y("7.4.2"))&&!P.isEqualTo(new Y("7.4.4"))&&"fullscreen"===U,skpv:"iOS"===R&&B.isGreaterThanOrEqualTo(new Y("6"))&&P.isGreaterThanOrEqualTo(new Y("6.4")),aak:"iOS"===R&&P.isGreaterThanOrEqualTo(new Y("7.6.0"))&&B.isGreaterThanOrEqualTo(new Y("18.0")),apv:"android"===R&&P.isGreaterThanOrEqualTo(new Y("7.6.2")),videoLength:"iOS"===R&&P.isGreaterThanOrEqualTo(new Y("7.4.1"))||P.isGreaterThanOrEqualTo(new Y("7.4.4")),hapticFeedback:"iOS"===R&&P.isGreaterThanOrEqualTo(new Y("7.6.3")),skAdImpression:H&&"iOS"===R&&P.isGreaterThanOrEqualTo(new Y("7.6.3"))}}}})(e,i,n,r.timeLoaded);if(e.has("AD_DATA"))try{var o;(a=JSON.parse(decodeURIComponent(null!=(o=e.get("AD_DATA"))?o:"{}"))).gdpr=i,a.sdk.timeLoaded=r.timeLoaded,t.emit({type:"observability",event:"event",data:{name:"ad-data-diff",equals:C(a,s)}})}catch(t){let e=t instanceof Error?t:Error("Error parsing AD_DATA token");n.emit({type:"error-logging",event:"exception",data:{error:e,is_fatal:!0}})}eo.setValue(cB($,s))})(),(e=t0()).addEventHandler("*",cz),e.addEventHandler("close",cQ),e.addEventHandler("observability",c$),e.addEventHandler("app-store-mraid",cG),e.addEventHandler("app-store-mraid",cj),e.addEventHandler("app-store-mraid",cY),e.addEventHandler("tpat",cH),e.addEventHandler("tpat",c6),e.addEventHandler("video",cF),e.addEventHandler("video",sH),e.addEventHandler("viewability",cW),e.addEventHandler("error-logging",cK),e.addEventHandler("videoViewed",iB),e.addEventHandler("free-form",cX),e.addEventHandler("scene-event",cJ),e.addEventHandler("incentivized-event",c0),e.addEventHandler("app-store-product-view",c2),e.addEventHandler("app-store-orchestration",c1),e.addEventHandler("picture-in-picture",c3),e.addEventHandler("inactivity",c4),e.addEventHandler("mraid-event",c7),e.addEventHandler("tracking-event",rM),((e=eo.getValue(),t=tG.get())=>{let n=c.getInstance();e.sdk.supports.pingUrl?n.bindService(cM,new cM(t)):n.bindService(cR,new cR)})(),((e=t5.get())=>{e.init(oH)})();let i=tU();i.emit("ad-load","ad-load"),((e=ne.get())=>{e.init()})(),((e=eo.getValue(),t=j.get(),n=tG.get(),i=tR.get(),r=eh())=>{if(e.gdpr.requiresConsent&&!e.placement.is.banner){let e=new rD(t,n,i,r);return c.getInstance().bindService(rD,e)}})(),((e=eo.getValue(),t=j.get(),n=tR.get(),i=eh(),r=ed(),a=tU())=>{if(sU(e)){let e=new sh(t,n,i,r,a);return c.getInstance().bindService(sh,e)}})(),((e=eo.getValue())=>{let t,n=c.getInstance();return e.sdk.supports.skpv?t=new o0(e).resolve():e.sdk.supports.apv&&(t=new ae),t&&n.bindService(ae,t)})(),((e=eo.getValue())=>{if(!e.sdk.supports.sko)return;let t=new l5(e).resolve();return c.getInstance().bindService(l7,t)})(),((e=eo.getValue())=>{if(!e.sdk.supports.aak)return;let t=new a3;return c.getInstance().bindService(a3,t)})(),((e=h.get(),t=lQ,n=lO)=>{e.has("AD_EXPERIENCE")?t():n()})(),((e=i$())=>{let t=e.filter(e=>"endcard"===e.getSceneType());if(!t.length)return;let n=new os;t.forEach(e=>{e.initIframeContentData(n)})})(),((e=eo.getValue(),t=i$(),n=nC.get())=>{e.advertiser.disableEndcardCache||t.filter(e=>"image"===e.getSceneType()).forEach(e=>{let{url:t}=e;/^https?:/i.test(t)&&n.add(t,e.getId())})})(),((e=oM(),t=tx.get(),n=eo.getValue())=>{t.setInitialMutedValue(e);let i=((e,t,n)=>{if(n.sdk.supports.silent){let i=((e,t)=>{let n=e.isSilent(),{device:i,sdk:r,placement:a}=t;return!!i.os.is.iOS&&void 0===n&&(!!r.is.v740&&!!a.is.inLine||!!r.is.v741OrAbove)||n})(t,n);if(void 0!==i)return i||e}return e})(e,t,n);t.setMutedSignal(i)})(),await l9(),((e=tU(),t=cS,n=ck,i=cV,r=cx)=>{let a=t=>{e.emit({name:{FCP:"web-vitals-first-contentful-paint",INP:"web-vitals-interaction-to-next-paint",LCP:"web-vitals-largest-contentful-paint",TTFB:"web-vitals-time-to-first-byte"}[t.name],value:Math.round(t.value)})};t(a),n(a),i(a),r(a)})(),((e=eo.getValue(),t=i$(),n=h.get(),i=nN.get())=>{if(oF(n.get("DYNAMIC_AD_OPTIMIZATION"))&&e.placement.is.fullscreen&&!e.placement.is.rewarded&&!n.has("AD_EXPERIENCE")&&iQ(t[0])&&oc(t[1])){var r;let e=c.getInstance(),t=new rW(null!=(r=n.get("SESSION_ID"))?r:"",i);e.bindService(rW,t)}})(),t=c.getInstance(),n=new a4,t.bindService(a4,n),i.emit("ad-load-complete","ad-load-complete")};c.getInstance().bindService(v,new v).bindService(h,new h).bindService(H,new H).bindService(tY,new tY).bindService(tR,new tR).bindService(tx,new tx).bindService(rd,new rd).bindService(j,new j).bindService(nl,new nl).bindService(tG,new tG).bindService(i7,new i7).bindService(ne,new ne).bindService(t5,new t5).bindService(ng,new ng).bindService(nN,new nN).bindService(nS,new nS).bindService(nI,new nI).bindService(rl,new rl).bindService(nC,new nC),window.omidBridge=new Proxy({},{get:(e,t)=>(...e)=>{rS[t]=e}}),((e=eu())=>new Promise(t=>{ru("ready",e).pipe(ie(1)).subscribe({next:()=>{t(!0)}})}))().then(c5).then(()=>((e=tR.get(),t=t5.get(),n=eh())=>new Promise(i=>{let r=c.getInstance().startTimestamp;if(e.isViewable())rp(r,t);else{n.emit({type:"viewability",event:"minimized"});let e=Date.now();t.pushEvent({name:"awaiting-viewable",metric:"awaiting-viewable",elapsed:e-r}),i1(n,"maximized").pipe(ie(1)).subscribe({next:()=>{rp(e,t)}})}((e=eu(),t=tG.get(),n=H.get(),i=eo.getValue())=>{let{sdk:r}=i;if(r.is.v760OrAbove){let i=ru("readyToPlay",e).pipe(ie(1)),{timeLoaded:a,loadTimeout:s}=r;iI(i,((e,t,n)=>{if(void 0===e||-1===t)return rv(null);let i=1e3*t-e;return i<=500?rv(null):iG(i,n,null)})(a,s,n)).subscribe({next:()=>{t.notifyReadyToPlay()}})}})(),i(!0)}))()).then(()=>{var e,t,n,i,r;oR(),((e=r$(),t=nl.get(),n=r0,i=rZ)=>{let r=i(e.state);t2.setValue({scene:r}),t.start(r),n(r),e.start()})(),e=rm(oL,{}),(t=document.getElementById("dynamic"))==document&&(t=document.documentElement),Q.__&&Q.__(e,t),n=t.__k,i=[],r=[],eD(t,e=t.__k=ey(eE,null,[e]),n||ev,ev,t.namespaceURI,n?null:t.firstChild?X.call(t.childNodes):null,i,n?n.__e:t.firstChild,!1,r),eL(i,e,r)}),((e=tG.get())=>{e.notifyReadyEventForSdk6()})();</script>
    

